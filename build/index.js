import './sourcemap-register.cjs';import{createRequire as __WEBPACK_EXTERNAL_createRequire}from"module";var __webpack_modules__={4235:(e,t,r)=>{var n=r(3495);e.exports=function create(e){return function adapter(t){try{return n(t,e())}catch(e){}return false}}},1009:(e,t,r)=>{var n=r(4235);e.exports=n((function processenv(){return process.env.DEBUG||process.env.DIAGNOSTICS}))},3201:e=>{var t=[];var r=[];var n=function devnull(){};function use(e){if(~t.indexOf(e))return false;t.push(e);return true}function set(e){n=e}function enabled(e){var r=[];for(var n=0;n<t.length;n++){if(t[n].async){r.push(t[n]);continue}if(t[n](e))return true}if(!r.length)return false;return new Promise((function pinky(t){Promise.all(r.map((function prebind(t){return t(e)}))).then((function resolved(e){t(e.some(Boolean))}))}))}function modify(e){if(~r.indexOf(e))return false;r.push(e);return true}function write(){n.apply(n,arguments)}function process(e){for(var t=0;t<r.length;t++){e=r[t].apply(r[t],arguments)}return e}function introduce(e,t){var r=Object.prototype.hasOwnProperty;for(var n in t){if(r.call(t,n)){e[n]=t[n]}}return e}function nope(e){e.enabled=false;e.modify=modify;e.set=set;e.use=use;return introduce((function diagnopes(){return false}),e)}function yep(e){function diagnostics(){var t=Array.prototype.slice.call(arguments,0);write.call(write,e,process(t,e));return true}e.enabled=true;e.modify=modify;e.set=set;e.use=use;return introduce(diagnostics,e)}e.exports=function create(e){e.introduce=introduce;e.enabled=enabled;e.process=process;e.modify=modify;e.write=write;e.nope=nope;e.yep=yep;e.set=set;e.use=use;return e}},1238:e=>{e.exports=function(e,t){try{Function.prototype.apply.call(console.log,console,t)}catch(e){}}},5037:(e,t,r)=>{var n=r(5917);var i=r(6287);e.exports=function ansiModifier(e,t){var r=t.namespace;var s=t.colors!==false?i(r+":",n(r)):r+":";e[0]=s+" "+e[0];return e}},611:(e,t,r)=>{var n=r(3201);var i=r(6224).isatty(1);var s=n((function dev(e,t){t=t||{};t.colors="colors"in t?t.colors:i;t.namespace=e;t.prod=false;t.dev=true;if(!dev.enabled(e)&&!(t.force||dev.force)){return dev.nope(t)}return dev.yep(t)}));s.modify(r(5037));s.use(r(1009));s.set(r(1238));e.exports=s},3170:(e,t,r)=>{if(process.env.NODE_ENV==="production"){e.exports=r(9827)}else{e.exports=r(611)}},9827:(e,t,r)=>{var n=r(3201);var i=n((function prod(e,t){t=t||{};t.namespace=e;t.prod=true;t.dev=false;if(!(t.force||prod.force))return prod.nope(t);return prod.yep(t)}));e.exports=i},8258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.addAdminServicesToServer=t.registerAdminService=void 0;const r=[];function registerAdminService(e,t){r.push({getServiceDefinition:e,getHandlers:t})}t.registerAdminService=registerAdminService;function addAdminServicesToServer(e){for(const{getServiceDefinition:t,getHandlers:n}of r){e.addService(t(),n())}}t.addAdminServicesToServer=addAdminServicesToServer},4186:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.BackoffTimeout=void 0;const r=1e3;const n=1.6;const i=12e4;const s=.2;function uniformRandom(e,t){return Math.random()*(t-e)+e}class BackoffTimeout{constructor(e,t){this.callback=e;this.initialDelay=r;this.multiplier=n;this.maxDelay=i;this.jitter=s;this.running=false;this.hasRef=true;this.startTime=new Date;this.endTime=new Date;if(t){if(t.initialDelay){this.initialDelay=t.initialDelay}if(t.multiplier){this.multiplier=t.multiplier}if(t.jitter){this.jitter=t.jitter}if(t.maxDelay){this.maxDelay=t.maxDelay}}this.nextDelay=this.initialDelay;this.timerId=setTimeout((()=>{}),0);clearTimeout(this.timerId)}runTimer(e){var t,r;this.endTime=this.startTime;this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay);clearTimeout(this.timerId);this.timerId=setTimeout((()=>{this.callback();this.running=false}),e);if(!this.hasRef){(r=(t=this.timerId).unref)===null||r===void 0?void 0:r.call(t)}}runOnce(){this.running=true;this.startTime=new Date;this.runTimer(this.nextDelay);const e=Math.min(this.nextDelay*this.multiplier,this.maxDelay);const t=e*this.jitter;this.nextDelay=e+uniformRandom(-t,t)}stop(){clearTimeout(this.timerId);this.running=false}reset(){this.nextDelay=this.initialDelay;if(this.running){const e=new Date;const t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay);clearTimeout(this.timerId);if(e<t){this.runTimer(t.getTime()-e.getTime())}else{this.running=false}}}isRunning(){return this.running}ref(){var e,t;this.hasRef=true;(t=(e=this.timerId).ref)===null||t===void 0?void 0:t.call(e)}unref(){var e,t;this.hasRef=false;(t=(e=this.timerId).unref)===null||t===void 0?void 0:t.call(e)}getEndTime(){return this.endTime}}t.BackoffTimeout=BackoffTimeout},1426:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.CallCredentials=void 0;const n=r(3665);function isCurrentOauth2Client(e){return"getRequestHeaders"in e&&typeof e.getRequestHeaders==="function"}class CallCredentials{static createFromMetadataGenerator(e){return new SingleCallCredentials(e)}static createFromGoogleCredential(e){return CallCredentials.createFromMetadataGenerator(((t,r)=>{let i;if(isCurrentOauth2Client(e)){i=e.getRequestHeaders(t.service_url)}else{i=new Promise(((r,n)=>{e.getRequestMetadata(t.service_url,((e,t)=>{if(e){n(e);return}if(!t){n(new Error("Headers not set by metadata plugin"));return}r(t)}))}))}i.then((e=>{const t=new n.Metadata;for(const r of Object.keys(e)){t.add(r,e[r])}r(null,t)}),(e=>{r(e)}))}))}static createEmpty(){return new EmptyCallCredentials}}t.CallCredentials=CallCredentials;class ComposedCallCredentials extends CallCredentials{constructor(e){super();this.creds=e}async generateMetadata(e){const t=new n.Metadata;const r=await Promise.all(this.creds.map((t=>t.generateMetadata(e))));for(const e of r){t.merge(e)}return t}compose(e){return new ComposedCallCredentials(this.creds.concat([e]))}_equals(e){if(this===e){return true}if(e instanceof ComposedCallCredentials){return this.creds.every(((t,r)=>t._equals(e.creds[r])))}else{return false}}}class SingleCallCredentials extends CallCredentials{constructor(e){super();this.metadataGenerator=e}generateMetadata(e){return new Promise(((t,r)=>{this.metadataGenerator(e,((e,n)=>{if(n!==undefined){t(n)}else{r(e)}}))}))}compose(e){return new ComposedCallCredentials([this,e])}_equals(e){if(this===e){return true}if(e instanceof SingleCallCredentials){return this.metadataGenerator===e.metadataGenerator}else{return false}}}class EmptyCallCredentials extends CallCredentials{generateMetadata(e){return Promise.resolve(new n.Metadata)}compose(e){return e}_equals(e){return e instanceof EmptyCallCredentials}}},8710:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.InterceptingListenerImpl=t.isInterceptingListener=void 0;function isInterceptingListener(e){return e.onReceiveMetadata!==undefined&&e.onReceiveMetadata.length===1}t.isInterceptingListener=isInterceptingListener;class InterceptingListenerImpl{constructor(e,t){this.listener=e;this.nextListener=t;this.processingMetadata=false;this.hasPendingMessage=false;this.processingMessage=false;this.pendingStatus=null}processPendingMessage(){if(this.hasPendingMessage){this.nextListener.onReceiveMessage(this.pendingMessage);this.pendingMessage=null;this.hasPendingMessage=false}}processPendingStatus(){if(this.pendingStatus){this.nextListener.onReceiveStatus(this.pendingStatus)}}onReceiveMetadata(e){this.processingMetadata=true;this.listener.onReceiveMetadata(e,(e=>{this.processingMetadata=false;this.nextListener.onReceiveMetadata(e);this.processPendingMessage();this.processPendingStatus()}))}onReceiveMessage(e){this.processingMessage=true;this.listener.onReceiveMessage(e,(e=>{this.processingMessage=false;if(this.processingMetadata){this.pendingMessage=e;this.hasPendingMessage=true}else{this.nextListener.onReceiveMessage(e);this.processPendingStatus()}}))}onReceiveStatus(e){this.listener.onReceiveStatus(e,(e=>{if(this.processingMetadata||this.processingMessage){this.pendingStatus=e}else{this.nextListener.onReceiveStatus(e)}}))}}t.InterceptingListenerImpl=InterceptingListenerImpl},380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.getNextCallNumber=void 0;let r=0;function getNextCallNumber(){return r++}t.getNextCallNumber=getNextCallNumber},7453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ClientDuplexStreamImpl=t.ClientWritableStreamImpl=t.ClientReadableStreamImpl=t.ClientUnaryCallImpl=t.callErrorFromStatus=void 0;const n=r(2361);const i=r(2781);const s=r(634);function callErrorFromStatus(e,t){const r=`${e.code} ${s.Status[e.code]}: ${e.details}`;const n=new Error(r);const i=`${n.stack}\nfor call at\n${t}`;return Object.assign(new Error(r),e,{stack:i})}t.callErrorFromStatus=callErrorFromStatus;class ClientUnaryCallImpl extends n.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}}t.ClientUnaryCallImpl=ClientUnaryCallImpl;class ClientReadableStreamImpl extends i.Readable{constructor(e){super({objectMode:true});this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0?void 0:t.startRead()}}t.ClientReadableStreamImpl=ClientReadableStreamImpl;class ClientWritableStreamImpl extends i.Writable{constructor(e){super({objectMode:true});this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,r){var n;const i={callback:r};const s=Number(t);if(!Number.isNaN(s)){i.flags=s}(n=this.call)===null||n===void 0?void 0:n.sendMessageWithContext(i,e)}_final(e){var t;(t=this.call)===null||t===void 0?void 0:t.halfClose();e()}}t.ClientWritableStreamImpl=ClientWritableStreamImpl;class ClientDuplexStreamImpl extends i.Duplex{constructor(e,t){super({objectMode:true});this.serialize=e;this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0?void 0:t.startRead()}_write(e,t,r){var n;const i={callback:r};const s=Number(t);if(!Number.isNaN(s)){i.flags=s}(n=this.call)===null||n===void 0?void 0:n.sendMessageWithContext(i,e)}_final(e){var t;(t=this.call)===null||t===void 0?void 0:t.halfClose();e()}}t.ClientDuplexStreamImpl=ClientDuplexStreamImpl},4030:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ChannelCredentials=void 0;const n=r(4404);const i=r(1426);const s=r(6581);function verifyIsBufferOrNull(e,t){if(e&&!(e instanceof Buffer)){throw new TypeError(`${t}, if provided, must be a Buffer.`)}}class ChannelCredentials{constructor(e){this.callCredentials=e||i.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,i){var a;verifyIsBufferOrNull(e,"Root certificate");verifyIsBufferOrNull(t,"Private key");verifyIsBufferOrNull(r,"Certificate chain");if(t&&!r){throw new Error("Private key must be given with accompanying certificate chain")}if(!t&&r){throw new Error("Certificate chain must be given with accompanying private key")}const o=(0,n.createSecureContext)({ca:(a=e!==null&&e!==void 0?e:(0,s.getDefaultRootsData)())!==null&&a!==void 0?a:undefined,key:t!==null&&t!==void 0?t:undefined,cert:r!==null&&r!==void 0?r:undefined,ciphers:s.CIPHER_SUITES});return new SecureChannelCredentialsImpl(o,i!==null&&i!==void 0?i:{})}static createFromSecureContext(e,t){return new SecureChannelCredentialsImpl(e,t!==null&&t!==void 0?t:{})}static createInsecure(){return new InsecureChannelCredentialsImpl}}t.ChannelCredentials=ChannelCredentials;class InsecureChannelCredentialsImpl extends ChannelCredentials{constructor(){super()}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return false}_equals(e){return e instanceof InsecureChannelCredentialsImpl}}class SecureChannelCredentialsImpl extends ChannelCredentials{constructor(e,t){super();this.secureContext=e;this.verifyOptions=t;this.connectionOptions={secureContext:e};if(t===null||t===void 0?void 0:t.checkServerIdentity){this.connectionOptions.checkServerIdentity=t.checkServerIdentity}}compose(e){const t=this.callCredentials.compose(e);return new ComposedChannelCredentialsImpl(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return true}_equals(e){if(this===e){return true}if(e instanceof SecureChannelCredentialsImpl){return this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity}else{return false}}}class ComposedChannelCredentialsImpl extends ChannelCredentials{constructor(e,t){super(t);this.channelCredentials=e}compose(e){const t=this.callCredentials.compose(e);return new ComposedChannelCredentialsImpl(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return true}_equals(e){if(this===e){return true}if(e instanceof ComposedChannelCredentialsImpl){return this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials)}else{return false}}}},9810:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.channelOptionsEqual=t.recognizedOptions=void 0;t.recognizedOptions={"grpc.ssl_target_name_override":true,"grpc.primary_user_agent":true,"grpc.secondary_user_agent":true,"grpc.default_authority":true,"grpc.keepalive_time_ms":true,"grpc.keepalive_timeout_ms":true,"grpc.keepalive_permit_without_calls":true,"grpc.service_config":true,"grpc.max_concurrent_streams":true,"grpc.initial_reconnect_backoff_ms":true,"grpc.max_reconnect_backoff_ms":true,"grpc.use_local_subchannel_pool":true,"grpc.max_send_message_length":true,"grpc.max_receive_message_length":true,"grpc.enable_http_proxy":true,"grpc.enable_channelz":true,"grpc.dns_min_time_between_resolutions_ms":true,"grpc.enable_retries":true,"grpc.per_rpc_retry_buffer_size":true,"grpc.retry_buffer_size":true,"grpc.max_connection_age_ms":true,"grpc.max_connection_age_grace_ms":true,"grpc-node.max_session_memory":true,"grpc.service_config_disable_resolution":true,"grpc.client_idle_timeout_ms":true,"grpc-node.tls_enable_trace":true,"grpc.lb.ring_hash.ring_size_cap":true};function channelOptionsEqual(e,t){const r=Object.keys(e).sort();const n=Object.keys(t).sort();if(r.length!==n.length){return false}for(let i=0;i<r.length;i+=1){if(r[i]!==n[i]){return false}if(e[r[i]]!==t[n[i]]){return false}}return true}t.channelOptionsEqual=channelOptionsEqual},3860:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ChannelImplementation=void 0;const n=r(4030);const i=r(9672);class ChannelImplementation{constructor(e,t,r){if(typeof e!=="string"){throw new TypeError("Channel target must be a string")}if(!(t instanceof n.ChannelCredentials)){throw new TypeError("Channel credentials must be a ChannelCredentials object")}if(r){if(typeof r!=="object"){throw new TypeError("Channel options must be an object")}}this.internalChannel=new i.InternalChannel(e,t,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,r){this.internalChannel.watchConnectivityState(e,t,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,r,n,i){if(typeof e!=="string"){throw new TypeError("Channel#createCall: method must be a string")}if(!(typeof t==="number"||t instanceof Date)){throw new TypeError("Channel#createCall: deadline must be a number or Date")}return this.internalChannel.createCall(e,t,r,n,i)}}t.ChannelImplementation=ChannelImplementation},9975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.setup=t.getChannelzServiceDefinition=t.getChannelzHandlers=t.unregisterChannelzRef=t.registerChannelzSocket=t.registerChannelzServer=t.registerChannelzSubchannel=t.registerChannelzChannel=t.ChannelzCallTracker=t.ChannelzChildrenTracker=t.ChannelzTrace=void 0;const n=r(1808);const i=r(878);const s=r(634);const a=r(9905);const o=r(8258);const l=r(8541);function channelRefToMessage(e){return{channel_id:e.id,name:e.name}}function subchannelRefToMessage(e){return{subchannel_id:e.id,name:e.name}}function serverRefToMessage(e){return{server_id:e.id}}function socketRefToMessage(e){return{socket_id:e.id,name:e.name}}const c=32;class ChannelzTrace{constructor(){this.events=[];this.eventsLogged=0;this.creationTimestamp=new Date}addTrace(e,t,r){const n=new Date;this.events.push({description:t,severity:e,timestamp:n,childChannel:(r===null||r===void 0?void 0:r.kind)==="channel"?r:undefined,childSubchannel:(r===null||r===void 0?void 0:r.kind)==="subchannel"?r:undefined});if(this.events.length>=c*2){this.events=this.events.slice(c)}this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:dateToProtoTimestamp(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map((e=>({description:e.description,severity:e.severity,timestamp:dateToProtoTimestamp(e.timestamp),channel_ref:e.childChannel?channelRefToMessage(e.childChannel):null,subchannel_ref:e.childSubchannel?subchannelRefToMessage(e.childSubchannel):null})))}}}t.ChannelzTrace=ChannelzTrace;class ChannelzChildrenTracker{constructor(){this.channelChildren=new Map;this.subchannelChildren=new Map;this.socketChildren=new Map}refChild(e){var t,r,n;switch(e.kind){case"channel":{const r=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};r.count+=1;this.channelChildren.set(e.id,r);break}case"subchannel":{const t=(r=this.subchannelChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};t.count+=1;this.subchannelChildren.set(e.id,t);break}case"socket":{const t=(n=this.socketChildren.get(e.id))!==null&&n!==void 0?n:{ref:e,count:0};t.count+=1;this.socketChildren.set(e.id,t);break}}}unrefChild(e){switch(e.kind){case"channel":{const t=this.channelChildren.get(e.id);if(t!==undefined){t.count-=1;if(t.count===0){this.channelChildren.delete(e.id)}else{this.channelChildren.set(e.id,t)}}break}case"subchannel":{const t=this.subchannelChildren.get(e.id);if(t!==undefined){t.count-=1;if(t.count===0){this.subchannelChildren.delete(e.id)}else{this.subchannelChildren.set(e.id,t)}}break}case"socket":{const t=this.socketChildren.get(e.id);if(t!==undefined){t.count-=1;if(t.count===0){this.socketChildren.delete(e.id)}else{this.socketChildren.set(e.id,t)}}break}}}getChildLists(){const e=[];for(const{ref:t}of this.channelChildren.values()){e.push(t)}const t=[];for(const{ref:e}of this.subchannelChildren.values()){t.push(e)}const r=[];for(const{ref:e}of this.socketChildren.values()){r.push(e)}return{channels:e,subchannels:t,sockets:r}}}t.ChannelzChildrenTracker=ChannelzChildrenTracker;class ChannelzCallTracker{constructor(){this.callsStarted=0;this.callsSucceeded=0;this.callsFailed=0;this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1;this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}t.ChannelzCallTracker=ChannelzCallTracker;let u=1;function getNextId(){return u++}const d=[];const f=[];const h=[];const p=[];function registerChannelzChannel(e,t,r){const n=getNextId();const i={id:n,name:e,kind:"channel"};if(r){d[n]={ref:i,getInfo:t}}return i}t.registerChannelzChannel=registerChannelzChannel;function registerChannelzSubchannel(e,t,r){const n=getNextId();const i={id:n,name:e,kind:"subchannel"};if(r){f[n]={ref:i,getInfo:t}}return i}t.registerChannelzSubchannel=registerChannelzSubchannel;function registerChannelzServer(e,t){const r=getNextId();const n={id:r,kind:"server"};if(t){h[r]={ref:n,getInfo:e}}return n}t.registerChannelzServer=registerChannelzServer;function registerChannelzSocket(e,t,r){const n=getNextId();const i={id:n,name:e,kind:"socket"};if(r){p[n]={ref:i,getInfo:t}}return i}t.registerChannelzSocket=registerChannelzSocket;function unregisterChannelzRef(e){switch(e.kind){case"channel":delete d[e.id];return;case"subchannel":delete f[e.id];return;case"server":delete h[e.id];return;case"socket":delete p[e.id];return}}t.unregisterChannelzRef=unregisterChannelzRef;function parseIPv6Section(e){const t=Number.parseInt(e,16);return[t/256|0,t%256]}function parseIPv6Chunk(e){if(e===""){return[]}const t=e.split(":").map((e=>parseIPv6Section(e)));const r=[];return r.concat(...t)}function ipAddressStringToBuffer(e){if((0,n.isIPv4)(e)){return Buffer.from(Uint8Array.from(e.split(".").map((e=>Number.parseInt(e)))))}else if((0,n.isIPv6)(e)){let t;let r;const n=e.indexOf("::");if(n===-1){t=e;r=""}else{t=e.substring(0,n);r=e.substring(n+2)}const i=Buffer.from(parseIPv6Chunk(t));const s=Buffer.from(parseIPv6Chunk(r));const a=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,a,s])}else{return null}}function connectivityStateToMessage(e){switch(e){case i.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case i.ConnectivityState.IDLE:return{state:"IDLE"};case i.ConnectivityState.READY:return{state:"READY"};case i.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case i.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function dateToProtoTimestamp(e){if(!e){return null}const t=e.getTime();return{seconds:t/1e3|0,nanos:t%1e3*1e6}}function getChannelMessage(e){const t=e.getInfo();return{ref:channelRefToMessage(e.ref),data:{target:t.target,state:connectivityStateToMessage(t.state),calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:dateToProtoTimestamp(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},channel_ref:t.children.channels.map((e=>channelRefToMessage(e))),subchannel_ref:t.children.subchannels.map((e=>subchannelRefToMessage(e)))}}function GetChannel(e,t){const r=Number.parseInt(e.request.channel_id);const n=d[r];if(n===undefined){t({code:s.Status.NOT_FOUND,details:"No channel data found for id "+r});return}t(null,{channel:getChannelMessage(n)})}function GetTopChannels(e,t){const r=Number.parseInt(e.request.max_results);const n=[];let i=Number.parseInt(e.request.start_channel_id);for(;i<d.length;i++){const e=d[i];if(e===undefined){continue}n.push(getChannelMessage(e));if(n.length>=r){break}}t(null,{channel:n,end:i>=h.length})}function getServerMessage(e){const t=e.getInfo();return{ref:serverRefToMessage(e.ref),data:{calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:dateToProtoTimestamp(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},listen_socket:t.listenerChildren.sockets.map((e=>socketRefToMessage(e)))}}function GetServer(e,t){const r=Number.parseInt(e.request.server_id);const n=h[r];if(n===undefined){t({code:s.Status.NOT_FOUND,details:"No server data found for id "+r});return}t(null,{server:getServerMessage(n)})}function GetServers(e,t){const r=Number.parseInt(e.request.max_results);const n=[];let i=Number.parseInt(e.request.start_server_id);for(;i<h.length;i++){const e=h[i];if(e===undefined){continue}n.push(getServerMessage(e));if(n.length>=r){break}}t(null,{server:n,end:i>=h.length})}function GetSubchannel(e,t){const r=Number.parseInt(e.request.subchannel_id);const n=f[r];if(n===undefined){t({code:s.Status.NOT_FOUND,details:"No subchannel data found for id "+r});return}const i=n.getInfo();const a={ref:subchannelRefToMessage(n.ref),data:{target:i.target,state:connectivityStateToMessage(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:dateToProtoTimestamp(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map((e=>socketRefToMessage(e)))};t(null,{subchannel:a})}function subchannelAddressToAddressMessage(e){var t;if((0,a.isTcpSubchannelAddress)(e)){return{address:"tcpip_address",tcpip_address:{ip_address:(t=ipAddressStringToBuffer(e.host))!==null&&t!==void 0?t:undefined,port:e.port}}}else{return{address:"uds_address",uds_address:{filename:e.path}}}}function GetSocket(e,t){var r,n,i,a,o;const l=Number.parseInt(e.request.socket_id);const c=p[l];if(c===undefined){t({code:s.Status.NOT_FOUND,details:"No socket data found for id "+l});return}const u=c.getInfo();const d=u.security?{model:"tls",tls:{cipher_suite:u.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(r=u.security.cipherSuiteStandardName)!==null&&r!==void 0?r:undefined,other_name:(n=u.security.cipherSuiteOtherName)!==null&&n!==void 0?n:undefined,local_certificate:(i=u.security.localCertificate)!==null&&i!==void 0?i:undefined,remote_certificate:(a=u.security.remoteCertificate)!==null&&a!==void 0?a:undefined}}:null;const f={ref:socketRefToMessage(c.ref),local:u.localAddress?subchannelAddressToAddressMessage(u.localAddress):null,remote:u.remoteAddress?subchannelAddressToAddressMessage(u.remoteAddress):null,remote_name:(o=u.remoteName)!==null&&o!==void 0?o:undefined,security:d,data:{keep_alives_sent:u.keepAlivesSent,streams_started:u.streamsStarted,streams_succeeded:u.streamsSucceeded,streams_failed:u.streamsFailed,last_local_stream_created_timestamp:dateToProtoTimestamp(u.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:dateToProtoTimestamp(u.lastRemoteStreamCreatedTimestamp),messages_received:u.messagesReceived,messages_sent:u.messagesSent,last_message_received_timestamp:dateToProtoTimestamp(u.lastMessageReceivedTimestamp),last_message_sent_timestamp:dateToProtoTimestamp(u.lastMessageSentTimestamp),local_flow_control_window:u.localFlowControlWindow?{value:u.localFlowControlWindow}:null,remote_flow_control_window:u.remoteFlowControlWindow?{value:u.remoteFlowControlWindow}:null}};t(null,{socket:f})}function GetServerSockets(e,t){const r=Number.parseInt(e.request.server_id);const n=h[r];if(n===undefined){t({code:s.Status.NOT_FOUND,details:"No server data found for id "+r});return}const i=Number.parseInt(e.request.start_socket_id);const a=Number.parseInt(e.request.max_results);const o=n.getInfo();const l=o.sessionChildren.sockets.sort(((e,t)=>e.id-t.id));const c=[];let u=0;for(;u<l.length;u++){if(l[u].id>=i){c.push(socketRefToMessage(l[u]));if(c.length>=a){break}}}t(null,{socket_ref:c,end:u>=l.length})}function getChannelzHandlers(){return{GetChannel:GetChannel,GetTopChannels:GetTopChannels,GetServer:GetServer,GetServers:GetServers,GetSubchannel:GetSubchannel,GetSocket:GetSocket,GetServerSockets:GetServerSockets}}t.getChannelzHandlers=getChannelzHandlers;let g=null;function getChannelzServiceDefinition(){if(g){return g}const e=r(8171).J_;const t=e("channelz.proto",{keepCase:true,longs:String,enums:String,defaults:true,oneofs:true,includeDirs:[r.ab+"proto"]});const n=(0,l.loadPackageDefinition)(t);g=n.grpc.channelz.v1.Channelz.service;return g}t.getChannelzServiceDefinition=getChannelzServiceDefinition;function setup(){(0,o.registerAdminService)(getChannelzServiceDefinition,getChannelzHandlers)}t.setup=setup},2127:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.getInterceptingCall=t.InterceptingCall=t.RequesterBuilder=t.ListenerBuilder=t.InterceptorConfigurationError=void 0;const n=r(3665);const i=r(8710);const s=r(634);const a=r(2336);class InterceptorConfigurationError extends Error{constructor(e){super(e);this.name="InterceptorConfigurationError";Error.captureStackTrace(this,InterceptorConfigurationError)}}t.InterceptorConfigurationError=InterceptorConfigurationError;class ListenerBuilder{constructor(){this.metadata=undefined;this.message=undefined;this.status=undefined}withOnReceiveMetadata(e){this.metadata=e;return this}withOnReceiveMessage(e){this.message=e;return this}withOnReceiveStatus(e){this.status=e;return this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}t.ListenerBuilder=ListenerBuilder;class RequesterBuilder{constructor(){this.start=undefined;this.message=undefined;this.halfClose=undefined;this.cancel=undefined}withStart(e){this.start=e;return this}withSendMessage(e){this.message=e;return this}withHalfClose(e){this.halfClose=e;return this}withCancel(e){this.cancel=e;return this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}t.RequesterBuilder=RequesterBuilder;const o={onReceiveMetadata:(e,t)=>{t(e)},onReceiveMessage:(e,t)=>{t(e)},onReceiveStatus:(e,t)=>{t(e)}};const l={start:(e,t,r)=>{r(e,t)},sendMessage:(e,t)=>{t(e)},halfClose:e=>{e()},cancel:e=>{e()}};class InterceptingCall{constructor(e,t){var r,n,i,s;this.nextCall=e;this.processingMetadata=false;this.pendingMessageContext=null;this.processingMessage=false;this.pendingHalfClose=false;if(t){this.requester={start:(r=t.start)!==null&&r!==void 0?r:l.start,sendMessage:(n=t.sendMessage)!==null&&n!==void 0?n:l.sendMessage,halfClose:(i=t.halfClose)!==null&&i!==void 0?i:l.halfClose,cancel:(s=t.cancel)!==null&&s!==void 0?s:l.cancel}}else{this.requester=l}}cancelWithStatus(e,t){this.requester.cancel((()=>{this.nextCall.cancelWithStatus(e,t)}))}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){if(this.pendingMessageContext){this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage);this.pendingMessageContext=null;this.pendingMessage=null}}processPendingHalfClose(){if(this.pendingHalfClose){this.nextCall.halfClose()}}start(e,t){var r,n,s,a,l,c;const u={onReceiveMetadata:(n=(r=t===null||t===void 0?void 0:t.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&n!==void 0?n:e=>{},onReceiveMessage:(a=(s=t===null||t===void 0?void 0:t.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&a!==void 0?a:e=>{},onReceiveStatus:(c=(l=t===null||t===void 0?void 0:t.onReceiveStatus)===null||l===void 0?void 0:l.bind(t))!==null&&c!==void 0?c:e=>{}};this.processingMetadata=true;this.requester.start(e,u,((e,t)=>{var r,n,s;this.processingMetadata=false;let a;if((0,i.isInterceptingListener)(t)){a=t}else{const e={onReceiveMetadata:(r=t.onReceiveMetadata)!==null&&r!==void 0?r:o.onReceiveMetadata,onReceiveMessage:(n=t.onReceiveMessage)!==null&&n!==void 0?n:o.onReceiveMessage,onReceiveStatus:(s=t.onReceiveStatus)!==null&&s!==void 0?s:o.onReceiveStatus};a=new i.InterceptingListenerImpl(e,u)}this.nextCall.start(e,a);this.processPendingMessage();this.processPendingHalfClose()}))}sendMessageWithContext(e,t){this.processingMessage=true;this.requester.sendMessage(t,(r=>{this.processingMessage=false;if(this.processingMetadata){this.pendingMessageContext=e;this.pendingMessage=t}else{this.nextCall.sendMessageWithContext(e,r);this.processPendingHalfClose()}}))}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose((()=>{if(this.processingMetadata||this.processingMessage){this.pendingHalfClose=true}else{this.nextCall.halfClose()}}))}}t.InterceptingCall=InterceptingCall;function getCall(e,t,r){var n,i;const s=(n=r.deadline)!==null&&n!==void 0?n:Infinity;const a=r.host;const o=(i=r.parent)!==null&&i!==void 0?i:null;const l=r.propagate_flags;const c=r.credentials;const u=e.createCall(t,s,a,o,l);if(c){u.setCredentials(c)}return u}class BaseInterceptingCall{constructor(e,t){this.call=e;this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let r;try{r=this.methodDefinition.requestSerialize(t)}catch(e){this.call.cancelWithStatus(s.Status.INTERNAL,`Request message serialization failure: ${(0,a.getErrorMessage)(e)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let r=null;this.call.start(e,{onReceiveMetadata:e=>{var r;(r=t===null||t===void 0?void 0:t.onReceiveMetadata)===null||r===void 0?void 0:r.call(t,e)},onReceiveMessage:e=>{var i;let o;try{o=this.methodDefinition.responseDeserialize(e)}catch(e){r={code:s.Status.INTERNAL,details:`Response message parsing error: ${(0,a.getErrorMessage)(e)}`,metadata:new n.Metadata};this.call.cancelWithStatus(r.code,r.details);return}(i=t===null||t===void 0?void 0:t.onReceiveMessage)===null||i===void 0?void 0:i.call(t,o)},onReceiveStatus:e=>{var n,i;if(r){(n=t===null||t===void 0?void 0:t.onReceiveStatus)===null||n===void 0?void 0:n.call(t,r)}else{(i=t===null||t===void 0?void 0:t.onReceiveStatus)===null||i===void 0?void 0:i.call(t,e)}}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class BaseUnaryInterceptingCall extends BaseInterceptingCall{constructor(e,t){super(e,t)}start(e,t){var r,n;let i=false;const s={onReceiveMetadata:(n=(r=t===null||t===void 0?void 0:t.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&n!==void 0?n:e=>{},onReceiveMessage:e=>{var r;i=true;(r=t===null||t===void 0?void 0:t.onReceiveMessage)===null||r===void 0?void 0:r.call(t,e)},onReceiveStatus:e=>{var r,n;if(!i){(r=t===null||t===void 0?void 0:t.onReceiveMessage)===null||r===void 0?void 0:r.call(t,null)}(n=t===null||t===void 0?void 0:t.onReceiveStatus)===null||n===void 0?void 0:n.call(t,e)}};super.start(e,s);this.call.startRead()}}class BaseStreamingInterceptingCall extends BaseInterceptingCall{}function getBottomInterceptingCall(e,t,r){const n=getCall(e,r.path,t);if(r.responseStream){return new BaseStreamingInterceptingCall(n,r)}else{return new BaseUnaryInterceptingCall(n,r)}}function getInterceptingCall(e,t,r,n){if(e.clientInterceptors.length>0&&e.clientInterceptorProviders.length>0){throw new InterceptorConfigurationError("Both interceptors and interceptor_providers were passed as options "+"to the client constructor. Only one of these is allowed.")}if(e.callInterceptors.length>0&&e.callInterceptorProviders.length>0){throw new InterceptorConfigurationError("Both interceptors and interceptor_providers were passed as call "+"options. Only one of these is allowed.")}let i=[];if(e.callInterceptors.length>0||e.callInterceptorProviders.length>0){i=[].concat(e.callInterceptors,e.callInterceptorProviders.map((e=>e(t)))).filter((e=>e))}else{i=[].concat(e.clientInterceptors,e.clientInterceptorProviders.map((e=>e(t)))).filter((e=>e))}const s=Object.assign({},r,{method_definition:t});const a=i.reduceRight(((e,t)=>r=>t(r,e)),(e=>getBottomInterceptingCall(n,e,t)));return a(s)}t.getInterceptingCall=getInterceptingCall},7172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.Client=void 0;const n=r(7453);const i=r(3860);const s=r(878);const a=r(634);const o=r(3665);const l=r(2127);const c=Symbol();const u=Symbol();const d=Symbol();const f=Symbol();function isFunction(e){return typeof e==="function"}function getErrorStackString(e){return e.stack.split("\n").slice(1).join("\n")}class Client{constructor(e,t,r={}){var n,s;r=Object.assign({},r);this[u]=(n=r.interceptors)!==null&&n!==void 0?n:[];delete r.interceptors;this[d]=(s=r.interceptor_providers)!==null&&s!==void 0?s:[];delete r.interceptor_providers;if(this[u].length>0&&this[d].length>0){throw new Error("Both interceptors and interceptor_providers were passed as options "+"to the client constructor. Only one of these is allowed.")}this[f]=r.callInvocationTransformer;delete r.callInvocationTransformer;if(r.channelOverride){this[c]=r.channelOverride}else if(r.channelFactoryOverride){const n=r.channelFactoryOverride;delete r.channelFactoryOverride;this[c]=n(e,t,r)}else{this[c]=new i.ChannelImplementation(e,t,r)}}close(){this[c].close()}getChannel(){return this[c]}waitForReady(e,t){const checkState=r=>{if(r){t(new Error("Failed to connect before the deadline"));return}let n;try{n=this[c].getConnectivityState(true)}catch(e){t(new Error("The channel has been closed"));return}if(n===s.ConnectivityState.READY){t()}else{try{this[c].watchConnectivityState(n,e,checkState)}catch(e){t(new Error("The channel has been closed"))}}};setImmediate(checkState)}checkOptionalUnaryResponseArguments(e,t,r){if(isFunction(e)){return{metadata:new o.Metadata,options:{},callback:e}}else if(isFunction(t)){if(e instanceof o.Metadata){return{metadata:e,options:{},callback:t}}else{return{metadata:new o.Metadata,options:e,callback:t}}}else{if(!(e instanceof o.Metadata&&t instanceof Object&&isFunction(r))){throw new Error("Incorrect arguments passed")}return{metadata:e,options:t,callback:r}}}makeUnaryRequest(e,t,r,i,s,o,h){var p,g;const m=this.checkOptionalUnaryResponseArguments(s,o,h);const v={path:e,requestStream:false,responseStream:false,requestSerialize:t,responseDeserialize:r};let y={argument:i,metadata:m.metadata,call:new n.ClientUnaryCallImpl,channel:this[c],methodDefinition:v,callOptions:m.options,callback:m.callback};if(this[f]){y=this[f](y)}const b=y.call;const S={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(p=y.callOptions.interceptors)!==null&&p!==void 0?p:[],callInterceptorProviders:(g=y.callOptions.interceptor_providers)!==null&&g!==void 0?g:[]};const _=(0,l.getInterceptingCall)(S,y.methodDefinition,y.callOptions,y.channel);b.call=_;let w=null;let C=false;let E=new Error;_.start(y.metadata,{onReceiveMetadata:e=>{b.emit("metadata",e)},onReceiveMessage(e){if(w!==null){_.cancelWithStatus(a.Status.INTERNAL,"Too many responses received")}w=e},onReceiveStatus(e){if(C){return}C=true;if(e.code===a.Status.OK){if(w===null){const t=getErrorStackString(E);y.callback((0,n.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else{y.callback(null,w)}}else{const t=getErrorStackString(E);y.callback((0,n.callErrorFromStatus)(e,t))}E=null;b.emit("status",e)}});_.sendMessage(i);_.halfClose();return b}makeClientStreamRequest(e,t,r,i,s,o){var h,p;const g=this.checkOptionalUnaryResponseArguments(i,s,o);const m={path:e,requestStream:true,responseStream:false,requestSerialize:t,responseDeserialize:r};let v={metadata:g.metadata,call:new n.ClientWritableStreamImpl(t),channel:this[c],methodDefinition:m,callOptions:g.options,callback:g.callback};if(this[f]){v=this[f](v)}const y=v.call;const b={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(h=v.callOptions.interceptors)!==null&&h!==void 0?h:[],callInterceptorProviders:(p=v.callOptions.interceptor_providers)!==null&&p!==void 0?p:[]};const S=(0,l.getInterceptingCall)(b,v.methodDefinition,v.callOptions,v.channel);y.call=S;let _=null;let w=false;let C=new Error;S.start(v.metadata,{onReceiveMetadata:e=>{y.emit("metadata",e)},onReceiveMessage(e){if(_!==null){S.cancelWithStatus(a.Status.INTERNAL,"Too many responses received")}_=e},onReceiveStatus(e){if(w){return}w=true;if(e.code===a.Status.OK){if(_===null){const t=getErrorStackString(C);v.callback((0,n.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else{v.callback(null,_)}}else{const t=getErrorStackString(C);v.callback((0,n.callErrorFromStatus)(e,t))}C=null;y.emit("status",e)}});return y}checkMetadataAndOptions(e,t){let r;let n;if(e instanceof o.Metadata){r=e;if(t){n=t}else{n={}}}else{if(e){n=e}else{n={}}r=new o.Metadata}return{metadata:r,options:n}}makeServerStreamRequest(e,t,r,i,s,o){var h,p;const g=this.checkMetadataAndOptions(s,o);const m={path:e,requestStream:false,responseStream:true,requestSerialize:t,responseDeserialize:r};let v={argument:i,metadata:g.metadata,call:new n.ClientReadableStreamImpl(r),channel:this[c],methodDefinition:m,callOptions:g.options};if(this[f]){v=this[f](v)}const y=v.call;const b={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(h=v.callOptions.interceptors)!==null&&h!==void 0?h:[],callInterceptorProviders:(p=v.callOptions.interceptor_providers)!==null&&p!==void 0?p:[]};const S=(0,l.getInterceptingCall)(b,v.methodDefinition,v.callOptions,v.channel);y.call=S;let _=false;let w=new Error;S.start(v.metadata,{onReceiveMetadata(e){y.emit("metadata",e)},onReceiveMessage(e){y.push(e)},onReceiveStatus(e){if(_){return}_=true;y.push(null);if(e.code!==a.Status.OK){const t=getErrorStackString(w);y.emit("error",(0,n.callErrorFromStatus)(e,t))}w=null;y.emit("status",e)}});S.sendMessage(i);S.halfClose();return y}makeBidiStreamRequest(e,t,r,i,s){var o,h;const p=this.checkMetadataAndOptions(i,s);const g={path:e,requestStream:true,responseStream:true,requestSerialize:t,responseDeserialize:r};let m={metadata:p.metadata,call:new n.ClientDuplexStreamImpl(t,r),channel:this[c],methodDefinition:g,callOptions:p.options};if(this[f]){m=this[f](m)}const v=m.call;const y={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(o=m.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(h=m.callOptions.interceptor_providers)!==null&&h!==void 0?h:[]};const b=(0,l.getInterceptingCall)(y,m.methodDefinition,m.callOptions,m.channel);v.call=b;let S=false;let _=new Error;b.start(m.metadata,{onReceiveMetadata(e){v.emit("metadata",e)},onReceiveMessage(e){v.push(e)},onReceiveStatus(e){if(S){return}S=true;v.push(null);if(e.code!==a.Status.OK){const t=getErrorStackString(_);v.emit("error",(0,n.callErrorFromStatus)(e,t))}_=null;v.emit("status",e)}});return v}}t.Client=Client},4789:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.CompressionAlgorithms=void 0;var r;(function(e){e[e["identity"]=0]="identity";e[e["deflate"]=1]="deflate";e[e["gzip"]=2]="gzip"})(r||(t.CompressionAlgorithms=r={}))},7616:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.CompressionFilterFactory=t.CompressionFilter=void 0;const n=r(9796);const i=r(4789);const s=r(634);const a=r(3392);const o=r(5993);const isCompressionAlgorithmKey=e=>typeof e==="number"&&typeof i.CompressionAlgorithms[e]==="string";class CompressionHandler{async writeMessage(e,t){let r=e;if(t){r=await this.compressMessage(r)}const n=Buffer.allocUnsafe(r.length+5);n.writeUInt8(t?1:0,0);n.writeUInt32BE(r.length,1);r.copy(n,5);return n}async readMessage(e){const t=e.readUInt8(0)===1;let r=e.slice(5);if(t){r=await this.decompressMessage(r)}return r}}class IdentityHandler extends CompressionHandler{async compressMessage(e){return e}async writeMessage(e,t){const r=Buffer.allocUnsafe(e.length+5);r.writeUInt8(0,0);r.writeUInt32BE(e.length,1);e.copy(r,5);return r}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}}class DeflateHandler extends CompressionHandler{compressMessage(e){return new Promise(((t,r)=>{n.deflate(e,((e,n)=>{if(e){r(e)}else{t(n)}}))}))}decompressMessage(e){return new Promise(((t,r)=>{n.inflate(e,((e,n)=>{if(e){r(e)}else{t(n)}}))}))}}class GzipHandler extends CompressionHandler{compressMessage(e){return new Promise(((t,r)=>{n.gzip(e,((e,n)=>{if(e){r(e)}else{t(n)}}))}))}decompressMessage(e){return new Promise(((t,r)=>{n.unzip(e,((e,n)=>{if(e){r(e)}else{t(n)}}))}))}}class UnknownHandler extends CompressionHandler{constructor(e){super();this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}}function getCompressionHandler(e){switch(e){case"identity":return new IdentityHandler;case"deflate":return new DeflateHandler;case"gzip":return new GzipHandler;default:return new UnknownHandler(e)}}class CompressionFilter extends a.BaseFilter{constructor(e,t){var r;super();this.sharedFilterConfig=t;this.sendCompression=new IdentityHandler;this.receiveCompression=new IdentityHandler;this.currentCompressionAlgorithm="identity";const n=e["grpc.default_compression_algorithm"];if(n!==undefined){if(isCompressionAlgorithmKey(n)){const e=i.CompressionAlgorithms[n];const s=(r=t.serverSupportedEncodingHeader)===null||r===void 0?void 0:r.split(",");if(!s||s.includes(e)){this.currentCompressionAlgorithm=e;this.sendCompression=getCompressionHandler(this.currentCompressionAlgorithm)}}else{o.log(s.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${n}`)}}}async sendMetadata(e){const t=await e;t.set("grpc-accept-encoding","identity,deflate,gzip");t.set("accept-encoding","identity");if(this.currentCompressionAlgorithm==="identity"){t.remove("grpc-encoding")}else{t.set("grpc-encoding",this.currentCompressionAlgorithm)}return t}receiveMetadata(e){const t=e.get("grpc-encoding");if(t.length>0){const e=t[0];if(typeof e==="string"){this.receiveCompression=getCompressionHandler(e)}}e.remove("grpc-encoding");const r=e.get("grpc-accept-encoding")[0];if(r){this.sharedFilterConfig.serverSupportedEncodingHeader=r;const e=r.split(",");if(!e.includes(this.currentCompressionAlgorithm)){this.sendCompression=new IdentityHandler;this.currentCompressionAlgorithm="identity"}}e.remove("grpc-accept-encoding");return e}async sendMessage(e){var t;const r=await e;let n;if(this.sendCompression instanceof IdentityHandler){n=false}else{n=(((t=r.flags)!==null&&t!==void 0?t:0)&2)===0}return{message:await this.sendCompression.writeMessage(r.message,n),flags:r.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}}t.CompressionFilter=CompressionFilter;class CompressionFilterFactory{constructor(e,t){this.options=t;this.sharedFilterConfig={}}createFilter(){return new CompressionFilter(this.options,this.sharedFilterConfig)}}t.CompressionFilterFactory=CompressionFilterFactory},878:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.ConnectivityState=void 0;var r;(function(e){e[e["IDLE"]=0]="IDLE";e[e["CONNECTING"]=1]="CONNECTING";e[e["READY"]=2]="READY";e[e["TRANSIENT_FAILURE"]=3]="TRANSIENT_FAILURE";e[e["SHUTDOWN"]=4]="SHUTDOWN"})(r||(t.ConnectivityState=r={}))},634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=t.Propagate=t.LogVerbosity=t.Status=void 0;var r;(function(e){e[e["OK"]=0]="OK";e[e["CANCELLED"]=1]="CANCELLED";e[e["UNKNOWN"]=2]="UNKNOWN";e[e["INVALID_ARGUMENT"]=3]="INVALID_ARGUMENT";e[e["DEADLINE_EXCEEDED"]=4]="DEADLINE_EXCEEDED";e[e["NOT_FOUND"]=5]="NOT_FOUND";e[e["ALREADY_EXISTS"]=6]="ALREADY_EXISTS";e[e["PERMISSION_DENIED"]=7]="PERMISSION_DENIED";e[e["RESOURCE_EXHAUSTED"]=8]="RESOURCE_EXHAUSTED";e[e["FAILED_PRECONDITION"]=9]="FAILED_PRECONDITION";e[e["ABORTED"]=10]="ABORTED";e[e["OUT_OF_RANGE"]=11]="OUT_OF_RANGE";e[e["UNIMPLEMENTED"]=12]="UNIMPLEMENTED";e[e["INTERNAL"]=13]="INTERNAL";e[e["UNAVAILABLE"]=14]="UNAVAILABLE";e[e["DATA_LOSS"]=15]="DATA_LOSS";e[e["UNAUTHENTICATED"]=16]="UNAUTHENTICATED"})(r||(t.Status=r={}));var n;(function(e){e[e["DEBUG"]=0]="DEBUG";e[e["INFO"]=1]="INFO";e[e["ERROR"]=2]="ERROR";e[e["NONE"]=3]="NONE"})(n||(t.LogVerbosity=n={}));var i;(function(e){e[e["DEADLINE"]=1]="DEADLINE";e[e["CENSUS_STATS_CONTEXT"]=2]="CENSUS_STATS_CONTEXT";e[e["CENSUS_TRACING_CONTEXT"]=4]="CENSUS_TRACING_CONTEXT";e[e["CANCELLATION"]=8]="CANCELLATION";e[e["DEFAULTS"]=65535]="DEFAULTS"})(i||(t.Propagate=i={}));t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024},9129:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.restrictControlPlaneStatusCode=void 0;const n=r(634);const i=[n.Status.OK,n.Status.INVALID_ARGUMENT,n.Status.NOT_FOUND,n.Status.ALREADY_EXISTS,n.Status.FAILED_PRECONDITION,n.Status.ABORTED,n.Status.OUT_OF_RANGE,n.Status.DATA_LOSS];function restrictControlPlaneStatusCode(e,t){if(i.includes(e)){return{code:n.Status.INTERNAL,details:`Invalid status from control plane: ${e} ${n.Status[e]} ${t}`}}else{return{code:e,details:t}}}t.restrictControlPlaneStatusCode=restrictControlPlaneStatusCode},511:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.deadlineToString=t.getRelativeTimeout=t.getDeadlineTimeoutString=t.minDeadline=void 0;function minDeadline(...e){let t=Infinity;for(const r of e){const e=r instanceof Date?r.getTime():r;if(e<t){t=e}}return t}t.minDeadline=minDeadline;const r=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function getDeadlineTimeoutString(e){const t=(new Date).getTime();if(e instanceof Date){e=e.getTime()}const n=Math.max(e-t,0);for(const[e,t]of r){const r=n/t;if(r<1e8){return String(Math.ceil(r))+e}}throw new Error("Deadline is too far in the future")}t.getDeadlineTimeoutString=getDeadlineTimeoutString;const n=2147483647;function getRelativeTimeout(e){const t=e instanceof Date?e.getTime():e;const r=(new Date).getTime();const i=t-r;if(i<0){return 0}else if(i>n){return Infinity}else{return i}}t.getRelativeTimeout=getRelativeTimeout;function deadlineToString(e){if(e instanceof Date){return e.toISOString()}else{const t=new Date(e);if(Number.isNaN(t.getTime())){return""+e}else{return t.toISOString()}}}t.deadlineToString=deadlineToString},2668:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.isDuration=t.durationToMs=t.msToDuration=void 0;function msToDuration(e){return{seconds:e/1e3|0,nanos:e%1e3*1e6|0}}t.msToDuration=msToDuration;function durationToMs(e){return e.seconds*1e3+e.nanos/1e6|0}t.durationToMs=durationToMs;function isDuration(e){return typeof e.seconds==="number"&&typeof e.nanos==="number"}t.isDuration=isDuration},2336:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.getErrorCode=t.getErrorMessage=void 0;function getErrorMessage(e){if(e instanceof Error){return e.message}else{return String(e)}}t.getErrorMessage=getErrorMessage;function getErrorCode(e){if(typeof e==="object"&&e!==null&&"code"in e&&typeof e.code==="number"){return e.code}else{return null}}t.getErrorCode=getErrorCode},7626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.BaseSubchannelWrapper=t.registerAdminService=t.FilterStackFactory=t.BaseFilter=t.PickResultType=t.QueuePicker=t.UnavailablePicker=t.ChildLoadBalancerHandler=t.EndpointMap=t.endpointHasAddress=t.endpointToString=t.subchannelAddressToString=t.LeafLoadBalancer=t.isLoadBalancerNameRegistered=t.parseLoadBalancingConfig=t.selectLbConfigFromList=t.registerLoadBalancerType=t.createChildChannelControlHelper=t.BackoffTimeout=t.durationToMs=t.uriToString=t.createResolver=t.registerResolver=t.log=t.trace=void 0;var n=r(5993);Object.defineProperty(t,"trace",{enumerable:true,get:function(){return n.trace}});Object.defineProperty(t,"log",{enumerable:true,get:function(){return n.log}});var i=r(1594);Object.defineProperty(t,"registerResolver",{enumerable:true,get:function(){return i.registerResolver}});Object.defineProperty(t,"createResolver",{enumerable:true,get:function(){return i.createResolver}});var s=r(5974);Object.defineProperty(t,"uriToString",{enumerable:true,get:function(){return s.uriToString}});var a=r(2668);Object.defineProperty(t,"durationToMs",{enumerable:true,get:function(){return a.durationToMs}});var o=r(4186);Object.defineProperty(t,"BackoffTimeout",{enumerable:true,get:function(){return o.BackoffTimeout}});var l=r(2680);Object.defineProperty(t,"createChildChannelControlHelper",{enumerable:true,get:function(){return l.createChildChannelControlHelper}});Object.defineProperty(t,"registerLoadBalancerType",{enumerable:true,get:function(){return l.registerLoadBalancerType}});Object.defineProperty(t,"selectLbConfigFromList",{enumerable:true,get:function(){return l.selectLbConfigFromList}});Object.defineProperty(t,"parseLoadBalancingConfig",{enumerable:true,get:function(){return l.parseLoadBalancingConfig}});Object.defineProperty(t,"isLoadBalancerNameRegistered",{enumerable:true,get:function(){return l.isLoadBalancerNameRegistered}});var c=r(8977);Object.defineProperty(t,"LeafLoadBalancer",{enumerable:true,get:function(){return c.LeafLoadBalancer}});var u=r(9905);Object.defineProperty(t,"subchannelAddressToString",{enumerable:true,get:function(){return u.subchannelAddressToString}});Object.defineProperty(t,"endpointToString",{enumerable:true,get:function(){return u.endpointToString}});Object.defineProperty(t,"endpointHasAddress",{enumerable:true,get:function(){return u.endpointHasAddress}});Object.defineProperty(t,"EndpointMap",{enumerable:true,get:function(){return u.EndpointMap}});var d=r(7559);Object.defineProperty(t,"ChildLoadBalancerHandler",{enumerable:true,get:function(){return d.ChildLoadBalancerHandler}});var f=r(1611);Object.defineProperty(t,"UnavailablePicker",{enumerable:true,get:function(){return f.UnavailablePicker}});Object.defineProperty(t,"QueuePicker",{enumerable:true,get:function(){return f.QueuePicker}});Object.defineProperty(t,"PickResultType",{enumerable:true,get:function(){return f.PickResultType}});var h=r(3392);Object.defineProperty(t,"BaseFilter",{enumerable:true,get:function(){return h.BaseFilter}});var p=r(6450);Object.defineProperty(t,"FilterStackFactory",{enumerable:true,get:function(){return p.FilterStackFactory}});var g=r(8258);Object.defineProperty(t,"registerAdminService",{enumerable:true,get:function(){return g.registerAdminService}});var m=r(2258);Object.defineProperty(t,"BaseSubchannelWrapper",{enumerable:true,get:function(){return m.BaseSubchannelWrapper}})},6450:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.FilterStackFactory=t.FilterStack=void 0;class FilterStack{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let e=0;e<this.filters.length;e++){t=this.filters[e].sendMetadata(t)}return t}receiveMetadata(e){let t=e;for(let e=this.filters.length-1;e>=0;e--){t=this.filters[e].receiveMetadata(t)}return t}sendMessage(e){let t=e;for(let e=0;e<this.filters.length;e++){t=this.filters[e].sendMessage(t)}return t}receiveMessage(e){let t=e;for(let e=this.filters.length-1;e>=0;e--){t=this.filters[e].receiveMessage(t)}return t}receiveTrailers(e){let t=e;for(let e=this.filters.length-1;e>=0;e--){t=this.filters[e].receiveTrailers(t)}return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}}t.FilterStack=FilterStack;class FilterStackFactory{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new FilterStackFactory([...this.factories])}createFilter(){return new FilterStack(this.factories.map((e=>e.createFilter())))}}t.FilterStackFactory=FilterStackFactory},3392:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.BaseFilter=void 0;class BaseFilter{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}}t.BaseFilter=BaseFilter},4e3:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.getProxiedConnection=t.mapProxyName=void 0;const n=r(5993);const i=r(634);const s=r(1594);const a=r(3685);const o=r(4404);const l=r(5993);const c=r(9905);const u=r(5974);const d=r(7310);const f=r(4886);const h="proxy";function trace(e){l.trace(i.LogVerbosity.DEBUG,h,e)}function getProxyInfo(){let e="";let t="";if(process.env.grpc_proxy){t="grpc_proxy";e=process.env.grpc_proxy}else if(process.env.https_proxy){t="https_proxy";e=process.env.https_proxy}else if(process.env.http_proxy){t="http_proxy";e=process.env.http_proxy}else{return{}}let r;try{r=new d.URL(e)}catch(e){(0,n.log)(i.LogVerbosity.ERROR,`cannot parse value of "${t}" env var`);return{}}if(r.protocol!=="http:"){(0,n.log)(i.LogVerbosity.ERROR,`"${r.protocol}" scheme not supported in proxy URI`);return{}}let s=null;if(r.username){if(r.password){(0,n.log)(i.LogVerbosity.INFO,"userinfo found in proxy URI");s=`${r.username}:${r.password}`}else{s=r.username}}const a=r.hostname;let o=r.port;if(o===""){o="80"}const l={address:`${a}:${o}`};if(s){l.creds=s}trace("Proxy server "+l.address+" set by environment variable "+t);return l}function getNoProxyHostList(){let e=process.env.no_grpc_proxy;let t="no_grpc_proxy";if(!e){e=process.env.no_proxy;t="no_proxy"}if(e){trace("No proxy server list set by environment variable "+t);return e.split(",")}else{return[]}}function mapProxyName(e,t){var r;const n={target:e,extraOptions:{}};if(((r=t["grpc.enable_http_proxy"])!==null&&r!==void 0?r:1)===0){return n}if(e.scheme==="unix"){return n}const i=getProxyInfo();if(!i.address){return n}const s=(0,u.splitHostPort)(e.path);if(!s){return n}const a=s.host;for(const t of getNoProxyHostList()){if(t===a){trace("Not using proxy for target in no_proxy list: "+(0,u.uriToString)(e));return n}}const o={"grpc.http_connect_target":(0,u.uriToString)(e)};if(i.creds){o["grpc.http_connect_creds"]=i.creds}return{target:{scheme:"dns",path:i.address},extraOptions:o}}t.mapProxyName=mapProxyName;function getProxiedConnection(e,t,r){var l;if(!("grpc.http_connect_target"in t)){return Promise.resolve({})}const d=t["grpc.http_connect_target"];const h=(0,u.parseUri)(d);if(h===null){return Promise.resolve({})}const p=(0,u.splitHostPort)(h.path);if(p===null){return Promise.resolve({})}const g=`${p.host}:${(l=p.port)!==null&&l!==void 0?l:f.DEFAULT_PORT}`;const m={method:"CONNECT",path:g};const v={Host:g};if((0,c.isTcpSubchannelAddress)(e)){m.host=e.host;m.port=e.port}else{m.socketPath=e.path}if("grpc.http_connect_creds"in t){v["Proxy-Authorization"]="Basic "+Buffer.from(t["grpc.http_connect_creds"]).toString("base64")}m.headers=v;const y=(0,c.subchannelAddressToString)(e);trace("Using proxy "+y+" to connect to "+m.path);return new Promise(((e,t)=>{const l=a.request(m);l.once("connect",((a,c,d)=>{var f;l.removeAllListeners();c.removeAllListeners();if(a.statusCode===200){trace("Successfully connected to "+m.path+" through proxy "+y);if("secureContext"in r){const n=(0,s.getDefaultAuthority)(h);const i=(0,u.splitHostPort)(n);const a=(f=i===null||i===void 0?void 0:i.host)!==null&&f!==void 0?f:n;const l=o.connect(Object.assign({host:a,servername:a,socket:c},r),(()=>{trace("Successfully established a TLS connection to "+m.path+" through proxy "+y);e({socket:l,realTarget:h})}));l.on("error",(e=>{trace("Failed to establish a TLS connection to "+m.path+" through proxy "+y+" with error "+e.message);t()}))}else{trace("Successfully established a plaintext connection to "+m.path+" through proxy "+y);e({socket:c,realTarget:h})}}else{(0,n.log)(i.LogVerbosity.ERROR,"Failed to connect to "+m.path+" through proxy "+y+" with status "+a.statusCode);t()}}));l.once("error",(e=>{l.removeAllListeners();(0,n.log)(i.LogVerbosity.ERROR,"Failed to connect to proxy "+y+" with error "+e.message);t()}));l.end()}))}t.getProxiedConnection=getProxiedConnection},7025:(e,t,r)=>{var n;n={value:true};n=t.wg=n=t.e1=n=n=n=n=t.fl=t.u8=n=t.yi=n=n=n=n=n=n=n=n=n=n=n=n=n=n=n=n=n=n=n=t.i7=n=t.SF=n=void 0;const i=r(1426);n={enumerable:true,get:function(){return i.CallCredentials}};const s=r(3860);n={enumerable:true,get:function(){return s.ChannelImplementation}};const a=r(4789);n={enumerable:true,get:function(){return a.CompressionAlgorithms}};const o=r(878);n={enumerable:true,get:function(){return o.ConnectivityState}};const l=r(4030);n={enumerable:true,get:function(){return l.ChannelCredentials}};const c=r(7172);n={enumerable:true,get:function(){return c.Client}};const u=r(634);n={enumerable:true,get:function(){return u.LogVerbosity}};Object.defineProperty(t,"i7",{enumerable:true,get:function(){return u.Status}});n={enumerable:true,get:function(){return u.Propagate}};const d=r(5993);const f=r(8541);n={enumerable:true,get:function(){return f.loadPackageDefinition}};n={enumerable:true,get:function(){return f.makeClientConstructor}};n={enumerable:true,get:function(){return f.makeClientConstructor}};const h=r(3665);Object.defineProperty(t,"SF",{enumerable:true,get:function(){return h.Metadata}});const p=r(3389);n={enumerable:true,get:function(){return p.Server}};const g=r(3828);n={enumerable:true,get:function(){return g.ServerCredentials}};const m=r(3155);Object.defineProperty(t,"yi",{enumerable:true,get:function(){return m.StatusBuilder}});n={combineChannelCredentials:(e,...t)=>t.reduce(((e,t)=>e.compose(t)),e),combineCallCredentials:(e,...t)=>t.reduce(((e,t)=>e.compose(t)),e),createInsecure:l.ChannelCredentials.createInsecure,createSsl:l.ChannelCredentials.createSsl,createFromSecureContext:l.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:i.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:i.CallCredentials.createFromGoogleCredential,createEmpty:i.CallCredentials.createEmpty};const closeClient=e=>e.close();n=closeClient;const waitForClientReady=(e,t,r)=>e.waitForReady(t,r);n=waitForClientReady;const loadObject=(e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};n=loadObject;const load=(e,t,r)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};n=load;const setLogger=e=>{d.setLogger(e)};n=setLogger;const setLogVerbosity=e=>{d.setLoggerVerbosity(e)};n=setLogVerbosity;const getClientChannel=e=>c.Client.prototype.getChannel.call(e);n=getClientChannel;var v=r(2127);n={enumerable:true,get:function(){return v.ListenerBuilder}};Object.defineProperty(t,"u8",{enumerable:true,get:function(){return v.RequesterBuilder}});Object.defineProperty(t,"fl",{enumerable:true,get:function(){return v.InterceptingCall}});n={enumerable:true,get:function(){return v.InterceptorConfigurationError}};var y=r(9975);n={enumerable:true,get:function(){return y.getChannelzServiceDefinition}};n={enumerable:true,get:function(){return y.getChannelzHandlers}};var b=r(8258);n={enumerable:true,get:function(){return b.addAdminServicesToServer}};var S=r(998);Object.defineProperty(t,"e1",{enumerable:true,get:function(){return S.ServerListenerBuilder}});n={enumerable:true,get:function(){return S.ResponderBuilder}};Object.defineProperty(t,"wg",{enumerable:true,get:function(){return S.ServerInterceptingCall}});const _=r(7626);n=_;const w=r(4886);const C=r(5252);const E=r(7902);const T=r(8977);const R=r(2787);const k=r(6828);const O=r(9975);(()=>{w.setup();C.setup();E.setup();T.setup();R.setup();k.setup();O.setup()})()},9672:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.InternalChannel=void 0;const n=r(4030);const i=r(9192);const s=r(9780);const a=r(1611);const o=r(634);const l=r(6450);const c=r(7616);const u=r(1594);const d=r(5993);const f=r(659);const h=r(4e3);const p=r(5974);const g=r(878);const m=r(9975);const v=r(776);const y=r(511);const b=r(9909);const S=r(380);const _=r(9129);const w=r(8159);const C=r(2258);const E=2147483647;const T=1e3;const R=30*60*1e3;const k=new Map;const O=1<<24;const M=1<<20;class ChannelSubchannelWrapper extends C.BaseSubchannelWrapper{constructor(e,t){super(e);this.channel=t;this.refCount=0;this.subchannelStateListener=(e,r,n,i)=>{t.throttleKeepalive(i)};e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref();this.refCount+=1}unref(){this.child.unref();this.refCount-=1;if(this.refCount<=0){this.child.removeConnectivityStateListener(this.subchannelStateListener);this.channel.removeWrappedSubchannel(this)}}}class InternalChannel{constructor(e,t,r){var v,y,b,S,C,x,A,P;this.credentials=t;this.options=r;this.connectivityState=g.ConnectivityState.IDLE;this.currentPicker=new a.UnavailablePicker;this.configSelectionQueue=[];this.pickQueue=[];this.connectivityStateWatchers=[];this.configSelector=null;this.currentResolutionError=null;this.wrappedSubchannels=new Set;this.callCount=0;this.idleTimer=null;this.channelzEnabled=true;this.callTracker=new m.ChannelzCallTracker;this.childrenTracker=new m.ChannelzChildrenTracker;this.randomChannelId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);if(typeof e!=="string"){throw new TypeError("Channel target must be a string")}if(!(t instanceof n.ChannelCredentials)){throw new TypeError("Channel credentials must be a ChannelCredentials object")}if(r){if(typeof r!=="object"){throw new TypeError("Channel options must be an object")}}this.originalTarget=e;const N=(0,p.parseUri)(e);if(N===null){throw new Error(`Could not parse target name "${e}"`)}const I=(0,u.mapUriDefaultScheme)(N);if(I===null){throw new Error(`Could not find a default scheme for target name "${e}"`)}this.callRefTimer=setInterval((()=>{}),E);(y=(v=this.callRefTimer).unref)===null||y===void 0?void 0:y.call(v);if(this.options["grpc.enable_channelz"]===0){this.channelzEnabled=false}this.channelzTrace=new m.ChannelzTrace;this.channelzRef=(0,m.registerChannelzChannel)(e,(()=>this.getChannelzInfo()),this.channelzEnabled);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Channel created")}if(this.options["grpc.default_authority"]){this.defaultAuthority=this.options["grpc.default_authority"]}else{this.defaultAuthority=(0,u.getDefaultAuthority)(I)}const D=(0,h.mapProxyName)(I,r);this.target=D.target;this.options=Object.assign({},this.options,D.extraOptions);this.subchannelPool=(0,s.getSubchannelPool)(((b=r["grpc.use_local_subchannel_pool"])!==null&&b!==void 0?b:0)===0);this.retryBufferTracker=new w.MessageBufferTracker((S=r["grpc.retry_buffer_size"])!==null&&S!==void 0?S:O,(C=r["grpc.per_rpc_retry_buffer_size"])!==null&&C!==void 0?C:M);this.keepaliveTime=(x=r["grpc.keepalive_time_ms"])!==null&&x!==void 0?x:-1;this.idleTimeoutMs=Math.max((A=r["grpc.client_idle_timeout_ms"])!==null&&A!==void 0?A:R,T);const L={createSubchannel:(e,t)=>{const r=this.subchannelPool.getOrCreateSubchannel(this.target,e,Object.assign({},this.options,t),this.credentials);r.throttleKeepalive(this.keepaliveTime);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",r.getChannelzRef())}const n=new ChannelSubchannelWrapper(r,this);this.wrappedSubchannels.add(n);return n},updateState:(e,t)=>{this.currentPicker=t;const r=this.pickQueue.slice();this.pickQueue=[];if(r.length>0){this.callRefTimerUnref()}for(const e of r){e.doPick()}this.updateState(e)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:e=>{if(this.channelzEnabled){this.childrenTracker.refChild(e)}},removeChannelzChild:e=>{if(this.channelzEnabled){this.childrenTracker.unrefChild(e)}}};this.resolvingLoadBalancer=new i.ResolvingLoadBalancer(this.target,L,r,((e,t)=>{if(e.retryThrottling){k.set(this.getTarget(),new w.RetryThrottler(e.retryThrottling.maxTokens,e.retryThrottling.tokenRatio,k.get(this.getTarget())))}else{k.delete(this.getTarget())}if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded")}this.configSelector=t;this.currentResolutionError=null;process.nextTick((()=>{const e=this.configSelectionQueue;this.configSelectionQueue=[];if(e.length>0){this.callRefTimerUnref()}for(const t of e){t.getConfig()}}))}),(e=>{if(this.channelzEnabled){this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+e.code+' and details "'+e.details+'"')}if(this.configSelectionQueue.length>0){this.trace("Name resolution failed with calls queued for config selection")}if(this.configSelector===null){this.currentResolutionError=Object.assign(Object.assign({},(0,_.restrictControlPlaneStatusCode)(e.code,e.details)),{metadata:e.metadata})}const t=this.configSelectionQueue;this.configSelectionQueue=[];if(t.length>0){this.callRefTimerUnref()}for(const r of t){r.reportResolverError(e)}}));this.filterStackFactory=new l.FilterStackFactory([new f.MaxMessageSizeFilterFactory(this.options),new c.CompressionFilterFactory(this,this.options)]);this.trace("Channel constructed with options "+JSON.stringify(r,undefined,2));const j=new Error;(0,d.trace)(o.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") "+"Channel constructed \n"+((P=j.stack)===null||P===void 0?void 0:P.substring(j.stack.indexOf("\n")+1)));this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,d.trace)(t!==null&&t!==void 0?t:o.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,p.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,r,n;if(!((t=(e=this.callRefTimer).hasRef)===null||t===void 0?void 0:t.call(e))){this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length);(n=(r=this.callRefTimer).ref)===null||n===void 0?void 0:n.call(r)}}callRefTimerUnref(){var e,t;if(!this.callRefTimer.hasRef||this.callRefTimer.hasRef()){this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length);(t=(e=this.callRefTimer).unref)===null||t===void 0?void 0:t.call(e)}}removeConnectivityStateWatcher(e){const t=this.connectivityStateWatchers.findIndex((t=>t===e));if(t>=0){this.connectivityStateWatchers.splice(t,1)}}updateState(e){(0,d.trace)(o.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,p.uriToString)(this.target)+" "+g.ConnectivityState[this.connectivityState]+" -> "+g.ConnectivityState[e]);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+g.ConnectivityState[e])}this.connectivityState=e;const t=this.connectivityStateWatchers.slice();for(const r of t){if(e!==r.currentState){if(r.timer){clearTimeout(r.timer)}this.removeConnectivityStateWatcher(r);r.callback()}}if(e!==g.ConnectivityState.TRANSIENT_FAILURE){this.currentResolutionError=null}}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(const t of this.wrappedSubchannels){t.throttleKeepalive(e)}}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e);this.callRefTimerRef()}getConfig(e,t){this.resolvingLoadBalancer.exitIdle();if(this.configSelector){return{type:"SUCCESS",config:this.configSelector(e,t,this.randomChannelId)}}else{if(this.currentResolutionError){return{type:"ERROR",error:this.currentResolutionError}}else{return{type:"NONE"}}}}queueCallForConfig(e){this.configSelectionQueue.push(e);this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy();this.updateState(g.ConnectivityState.IDLE);this.currentPicker=new a.QueuePicker(this.resolvingLoadBalancer);if(this.idleTimer){clearTimeout(this.idleTimer);this.idleTimer=null}}startIdleTimeout(e){var t,r;this.idleTimer=setTimeout((()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}const e=new Date;const t=e.valueOf()-this.lastActivityTimestamp.valueOf();if(t>=this.idleTimeoutMs){this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity");this.enterIdle()}else{this.startIdleTimeout(this.idleTimeoutMs-t)}}),e);(r=(t=this.idleTimer).unref)===null||r===void 0?void 0:r.call(t)}maybeStartIdleTimer(){if(this.connectivityState!==g.ConnectivityState.SHUTDOWN&&!this.idleTimer){this.startIdleTimeout(this.idleTimeoutMs)}}onCallStart(){if(this.channelzEnabled){this.callTracker.addCallStarted()}this.callCount+=1}onCallEnd(e){if(this.channelzEnabled){if(e.code===o.Status.OK){this.callTracker.addCallSucceeded()}else{this.callTracker.addCallFailed()}}this.callCount-=1;this.lastActivityTimestamp=new Date;this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,r,n,i){const s=(0,S.getNextCallNumber)();this.trace("createLoadBalancingCall ["+s+'] method="'+t+'"');return new v.LoadBalancingCall(this,e,t,r,n,i,s)}createRetryingCall(e,t,r,n,i){const s=(0,S.getNextCallNumber)();this.trace("createRetryingCall ["+s+'] method="'+t+'"');return new w.RetryingCall(this,e,t,r,n,i,s,this.retryBufferTracker,k.get(this.getTarget()))}createInnerCall(e,t,r,n,i){if(this.options["grpc.enable_retries"]===0){return this.createLoadBalancingCall(e,t,r,n,i)}else{return this.createRetryingCall(e,t,r,n,i)}}createResolvingCall(e,t,r,n,i){const s=(0,S.getNextCallNumber)();this.trace("createResolvingCall ["+s+'] method="'+e+'", deadline='+(0,y.deadlineToString)(t));const a={deadline:t,flags:i!==null&&i!==void 0?i:o.Propagate.DEFAULTS,host:r!==null&&r!==void 0?r:this.defaultAuthority,parentCall:n};const l=new b.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),s);this.onCallStart();l.addStatusWatcher((e=>{this.onCallEnd(e)}));return l}close(){this.resolvingLoadBalancer.destroy();this.updateState(g.ConnectivityState.SHUTDOWN);clearInterval(this.callRefTimer);if(this.idleTimer){clearTimeout(this.idleTimer)}if(this.channelzEnabled){(0,m.unregisterChannelzRef)(this.channelzRef)}this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,p.uriToString)(this.target)}getConnectivityState(e){const t=this.connectivityState;if(e){this.resolvingLoadBalancer.exitIdle();this.lastActivityTimestamp=new Date;this.maybeStartIdleTimer()}return t}watchConnectivityState(e,t,r){if(this.connectivityState===g.ConnectivityState.SHUTDOWN){throw new Error("Channel has been shut down")}let n=null;if(t!==Infinity){const e=t instanceof Date?t:new Date(t);const s=new Date;if(t===-Infinity||e<=s){process.nextTick(r,new Error("Deadline passed without connectivity state change"));return}n=setTimeout((()=>{this.removeConnectivityStateWatcher(i);r(new Error("Deadline passed without connectivity state change"))}),e.getTime()-s.getTime())}const i={currentState:e,callback:r,timer:n};this.connectivityStateWatchers.push(i)}getChannelzRef(){return this.channelzRef}createCall(e,t,r,n,i){if(typeof e!=="string"){throw new TypeError("Channel#createCall: method must be a string")}if(!(typeof t==="number"||t instanceof Date)){throw new TypeError("Channel#createCall: deadline must be a number or Date")}if(this.connectivityState===g.ConnectivityState.SHUTDOWN){throw new Error("Channel has been shut down")}return this.createResolvingCall(e,t,r,n,i)}}t.InternalChannel=InternalChannel},7559:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ChildLoadBalancerHandler=void 0;const n=r(2680);const i=r(878);const s="child_load_balancer_helper";class ChildLoadBalancerHandler{constructor(e,t){this.channelControlHelper=e;this.options=t;this.currentChild=null;this.pendingChild=null;this.latestConfig=null;this.ChildPolicyHelper=class{constructor(e){this.parent=e;this.child=null}createSubchannel(e,t){return this.parent.channelControlHelper.createSubchannel(e,t)}updateState(e,t){var r;if(this.calledByPendingChild()){if(e===i.ConnectivityState.CONNECTING){return}(r=this.parent.currentChild)===null||r===void 0?void 0:r.destroy();this.parent.currentChild=this.parent.pendingChild;this.parent.pendingChild=null}else if(!this.calledByCurrentChild()){return}this.parent.channelControlHelper.updateState(e,t)}requestReresolution(){var e;const t=(e=this.parent.pendingChild)!==null&&e!==void 0?e:this.parent.currentChild;if(this.child===t){this.parent.channelControlHelper.requestReresolution()}}setChild(e){this.child=e}addChannelzChild(e){this.parent.channelControlHelper.addChannelzChild(e)}removeChannelzChild(e){this.parent.channelControlHelper.removeChannelzChild(e)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,r){let i;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){const e=new this.ChildPolicyHelper(this);const r=(0,n.createLoadBalancer)(t,e,this.options);e.setChild(r);if(this.currentChild===null){this.currentChild=r;i=this.currentChild}else{if(this.pendingChild){this.pendingChild.destroy()}this.pendingChild=r;i=this.pendingChild}}else{if(this.pendingChild===null){i=this.currentChild}else{i=this.pendingChild}}this.latestConfig=t;i.updateAddressList(e,t,r)}exitIdle(){if(this.currentChild){this.currentChild.exitIdle();if(this.pendingChild){this.pendingChild.exitIdle()}}}resetBackoff(){if(this.currentChild){this.currentChild.resetBackoff();if(this.pendingChild){this.pendingChild.resetBackoff()}}}destroy(){if(this.currentChild){this.currentChild.destroy();this.currentChild=null}if(this.pendingChild){this.pendingChild.destroy();this.pendingChild=null}}getTypeName(){return s}}t.ChildLoadBalancerHandler=ChildLoadBalancerHandler},6828:(e,t,r)=>{var n;Object.defineProperty(t,"__esModule",{value:true});t.setup=t.OutlierDetectionLoadBalancer=t.OutlierDetectionLoadBalancingConfig=void 0;const i=r(878);const s=r(634);const a=r(2668);const o=r(7626);const l=r(2680);const c=r(7559);const u=r(1611);const d=r(9905);const f=r(2258);const h=r(5993);const p="outlier_detection";function trace(e){h.trace(s.LogVerbosity.DEBUG,p,e)}const g="outlier_detection";const m=((n=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&n!==void 0?n:"true")==="true";const v={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100};const y={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function validateFieldType(e,t,r,n){if(t in e&&e[t]!==undefined&&typeof e[t]!==r){const i=n?`${n}.${t}`:t;throw new Error(`outlier detection config ${i} parse error: expected ${r}, got ${typeof e[t]}`)}}function validatePositiveDuration(e,t,r){const n=r?`${r}.${t}`:t;if(t in e&&e[t]!==undefined){if(!(0,a.isDuration)(e[t])){throw new Error(`outlier detection config ${n} parse error: expected Duration, got ${typeof e[t]}`)}if(!(e[t].seconds>=0&&e[t].seconds<=315576e6&&e[t].nanos>=0&&e[t].nanos<=999999999)){throw new Error(`outlier detection config ${n} parse error: values out of range for non-negative Duaration`)}}}function validatePercentage(e,t,r){const n=r?`${r}.${t}`:t;validateFieldType(e,t,"number",r);if(t in e&&e[t]!==undefined&&!(e[t]>=0&&e[t]<=100)){throw new Error(`outlier detection config ${n} parse error: value out of range for percentage (0-100)`)}}class OutlierDetectionLoadBalancingConfig{constructor(e,t,r,n,i,s,a){this.childPolicy=a;if(a.getLoadBalancerName()==="pick_first"){throw new Error("outlier_detection LB policy cannot have a pick_first child policy")}this.intervalMs=e!==null&&e!==void 0?e:1e4;this.baseEjectionTimeMs=t!==null&&t!==void 0?t:3e4;this.maxEjectionTimeMs=r!==null&&r!==void 0?r:3e5;this.maxEjectionPercent=n!==null&&n!==void 0?n:10;this.successRateEjection=i?Object.assign(Object.assign({},v),i):null;this.failurePercentageEjection=s?Object.assign(Object.assign({},y),s):null}getLoadBalancerName(){return g}toJsonObject(){var e,t;return{outlier_detection:{interval:(0,a.msToDuration)(this.intervalMs),base_ejection_time:(0,a.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,a.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:(e=this.successRateEjection)!==null&&e!==void 0?e:undefined,failure_percentage_ejection:(t=this.failurePercentageEjection)!==null&&t!==void 0?t:undefined,child_policy:[this.childPolicy.toJsonObject()]}}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}static createFromJson(e){var t;validatePositiveDuration(e,"interval");validatePositiveDuration(e,"base_ejection_time");validatePositiveDuration(e,"max_ejection_time");validatePercentage(e,"max_ejection_percent");if("success_rate_ejection"in e&&e.success_rate_ejection!==undefined){if(typeof e.success_rate_ejection!=="object"){throw new Error("outlier detection config success_rate_ejection must be an object")}validateFieldType(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection");validatePercentage(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection");validateFieldType(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection");validateFieldType(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e&&e.failure_percentage_ejection!==undefined){if(typeof e.failure_percentage_ejection!=="object"){throw new Error("outlier detection config failure_percentage_ejection must be an object")}validatePercentage(e.failure_percentage_ejection,"threshold","failure_percentage_ejection");validatePercentage(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection");validateFieldType(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection");validateFieldType(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}if(!("child_policy"in e)||!Array.isArray(e.child_policy)){throw new Error("outlier detection config child_policy must be an array")}const r=(0,l.selectLbConfigFromList)(e.child_policy);if(!r){throw new Error("outlier detection config child_policy: no valid recognized policy found")}return new OutlierDetectionLoadBalancingConfig(e.interval?(0,a.durationToMs)(e.interval):null,e.base_ejection_time?(0,a.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,a.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,r)}}t.OutlierDetectionLoadBalancingConfig=OutlierDetectionLoadBalancingConfig;class OutlierDetectionSubchannelWrapper extends f.BaseSubchannelWrapper{constructor(e,t){super(e);this.mapEntry=t;this.refCount=0}ref(){this.child.ref();this.refCount+=1}unref(){this.child.unref();this.refCount-=1;if(this.refCount<=0){if(this.mapEntry){const e=this.mapEntry.subchannelWrappers.indexOf(this);if(e>=0){this.mapEntry.subchannelWrappers.splice(e,1)}}}}eject(){this.setHealthy(false)}uneject(){this.setHealthy(true)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function createEmptyBucket(){return{success:0,failure:0}}class CallCounter{constructor(){this.activeBucket=createEmptyBucket();this.inactiveBucket=createEmptyBucket()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket;this.activeBucket=createEmptyBucket()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class OutlierDetectionPicker{constructor(e,t){this.wrappedPicker=e;this.countCalls=t}pick(e){const t=this.wrappedPicker.pick(e);if(t.pickResultType===u.PickResultType.COMPLETE){const e=t.subchannel;const r=e.getMapEntry();if(r){let n=t.onCallEnded;if(this.countCalls){n=e=>{var n;if(e===s.Status.OK){r.counter.addSuccess()}else{r.counter.addFailure()}(n=t.onCallEnded)===null||n===void 0?void 0:n.call(t,e)}}return Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel(),onCallEnded:n})}else{return Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel()})}}else{return t}}}class OutlierDetectionLoadBalancer{constructor(e,t){this.entryMap=new d.EndpointMap;this.latestConfig=null;this.timerStartTime=null;this.childBalancer=new c.ChildLoadBalancerHandler((0,o.createChildChannelControlHelper)(e,{createSubchannel:(t,r)=>{const n=e.createSubchannel(t,r);const i=this.entryMap.getForSubchannelAddress(t);const s=new OutlierDetectionSubchannelWrapper(n,i);if((i===null||i===void 0?void 0:i.currentEjectionTimestamp)!==null){s.eject()}i===null||i===void 0?void 0:i.subchannelWrappers.push(s);return s},updateState:(t,r)=>{if(t===i.ConnectivityState.READY){e.updateState(t,new OutlierDetectionPicker(r,this.isCountingEnabled()))}else{e.updateState(t,r)}}}),t);this.ejectionTimer=setInterval((()=>{}),0);clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(const t of this.entryMap.values()){if(t.currentEjectionTimestamp!==null){e+=1}}return e*100/this.entryMap.size}runSuccessRateCheck(e){if(!this.latestConfig){return}const t=this.latestConfig.getSuccessRateEjectionConfig();if(!t){return}trace("Running success rate check");const r=t.request_volume;let n=0;const i=[];for(const[e,t]of this.entryMap.entries()){const s=t.counter.getLastSuccesses();const a=t.counter.getLastFailures();trace("Stats for "+(0,d.endpointToString)(e)+": successes="+s+" failures="+a+" targetRequestVolume="+r);if(s+a>=r){n+=1;i.push(s/(s+a))}}trace("Found "+n+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+i+"]");if(n<t.minimum_hosts){return}const s=i.reduce(((e,t)=>e+t))/i.length;let a=0;for(const e of i){const t=e-s;a+=t*t}const o=a/i.length;const l=Math.sqrt(o);const c=s-l*(t.stdev_factor/1e3);trace("stdev="+l+" ejectionThreshold="+c);for(const[n,i]of this.entryMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent()){break}const s=i.counter.getLastSuccesses();const a=i.counter.getLastFailures();if(s+a<r){continue}const o=s/(s+a);trace("Checking candidate "+n+" successRate="+o);if(o<c){const r=Math.random()*100;trace("Candidate "+n+" randomNumber="+r+" enforcement_percentage="+t.enforcement_percentage);if(r<t.enforcement_percentage){trace("Ejecting candidate "+n);this.eject(i,e)}}}}runFailurePercentageCheck(e){if(!this.latestConfig){return}const t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t){return}trace("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let r=0;for(const e of this.entryMap.values()){const n=e.counter.getLastSuccesses();const i=e.counter.getLastFailures();if(n+i>=t.request_volume){r+=1}}if(r<t.minimum_hosts){return}for(const[r,n]of this.entryMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent()){break}const i=n.counter.getLastSuccesses();const s=n.counter.getLastFailures();trace("Candidate successes="+i+" failures="+s);if(i+s<t.request_volume){continue}const a=s*100/(s+i);if(a>t.threshold){const i=Math.random()*100;trace("Candidate "+r+" randomNumber="+i+" enforcement_percentage="+t.enforcement_percentage);if(i<t.enforcement_percentage){trace("Ejecting candidate "+r);this.eject(n,e)}}}}eject(e,t){e.currentEjectionTimestamp=new Date;e.ejectionTimeMultiplier+=1;for(const t of e.subchannelWrappers){t.eject()}}uneject(e){e.currentEjectionTimestamp=null;for(const t of e.subchannelWrappers){t.uneject()}}switchAllBuckets(){for(const e of this.entryMap.values()){e.counter.switchBuckets()}}startTimer(e){var t,r;this.ejectionTimer=setTimeout((()=>this.runChecks()),e);(r=(t=this.ejectionTimer).unref)===null||r===void 0?void 0:r.call(t)}runChecks(){const e=new Date;trace("Ejection timer running");this.switchAllBuckets();if(!this.latestConfig){return}this.timerStartTime=e;this.startTimer(this.latestConfig.getIntervalMs());this.runSuccessRateCheck(e);this.runFailurePercentageCheck(e);for(const[e,t]of this.entryMap.entries()){if(t.currentEjectionTimestamp===null){if(t.ejectionTimeMultiplier>0){t.ejectionTimeMultiplier-=1}}else{const r=this.latestConfig.getBaseEjectionTimeMs();const n=this.latestConfig.getMaxEjectionTimeMs();const i=new Date(t.currentEjectionTimestamp.getTime());i.setMilliseconds(i.getMilliseconds()+Math.min(r*t.ejectionTimeMultiplier,Math.max(r,n)));if(i<new Date){trace("Unejecting "+e);this.uneject(t)}}}}updateAddressList(e,t,r){if(!(t instanceof OutlierDetectionLoadBalancingConfig)){return}for(const t of e){if(!this.entryMap.has(t)){trace("Adding map entry for "+(0,d.endpointToString)(t));this.entryMap.set(t,{counter:new CallCounter,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]})}}this.entryMap.deleteMissing(e);const n=t.getChildPolicy();this.childBalancer.updateAddressList(e,n,r);if(t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig()){if(this.timerStartTime){trace("Previous timer existed. Replacing timer");clearTimeout(this.ejectionTimer);const e=t.getIntervalMs()-((new Date).getTime()-this.timerStartTime.getTime());this.startTimer(e)}else{trace("Starting new timer");this.timerStartTime=new Date;this.startTimer(t.getIntervalMs());this.switchAllBuckets()}}else{trace("Counting disabled. Cancelling timer.");this.timerStartTime=null;clearTimeout(this.ejectionTimer);for(const e of this.entryMap.values()){this.uneject(e);e.ejectionTimeMultiplier=0}}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer);this.childBalancer.destroy()}getTypeName(){return g}}t.OutlierDetectionLoadBalancer=OutlierDetectionLoadBalancer;function setup(){if(m){(0,o.registerLoadBalancerType)(g,OutlierDetectionLoadBalancer,OutlierDetectionLoadBalancingConfig)}}t.setup=setup},8977:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.setup=t.LeafLoadBalancer=t.PickFirstLoadBalancer=t.shuffled=t.PickFirstLoadBalancingConfig=void 0;const n=r(2680);const i=r(878);const s=r(1611);const a=r(5993);const o=r(634);const l=r(9905);const c=r(1808);const u="pick_first";function trace(e){a.trace(o.LogVerbosity.DEBUG,u,e)}const d="pick_first";const f=250;class PickFirstLoadBalancingConfig{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return d}toJsonObject(){return{[d]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&!(typeof e.shuffleAddressList==="boolean")){throw new Error("pick_first config field shuffleAddressList must be a boolean if provided")}return new PickFirstLoadBalancingConfig(e.shuffleAddressList===true)}}t.PickFirstLoadBalancingConfig=PickFirstLoadBalancingConfig;class PickFirstPicker{constructor(e){this.subchannel=e}pick(e){return{pickResultType:s.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function shuffled(e){const t=e.slice();for(let e=t.length-1;e>1;e--){const r=Math.floor(Math.random()*(e+1));const n=t[e];t[e]=t[r];t[r]=n}return t}t.shuffled=shuffled;function interleaveAddressFamilies(e){const t=[];const r=[];const n=[];const i=(0,l.isTcpSubchannelAddress)(e[0])&&(0,c.isIPv6)(e[0].host);for(const t of e){if((0,l.isTcpSubchannelAddress)(t)&&(0,c.isIPv6)(t.host)){r.push(t)}else{n.push(t)}}const s=i?r:n;const a=i?n:r;for(let e=0;e<Math.max(s.length,a.length);e++){if(e<s.length){t.push(s[e])}if(e<a.length){t.push(a[e])}}return t}const h="grpc-node.internal.pick-first.report_health_status";class PickFirstLoadBalancer{constructor(e,t){this.channelControlHelper=e;this.children=[];this.currentState=i.ConnectivityState.IDLE;this.currentSubchannelIndex=0;this.currentPick=null;this.subchannelStateListener=(e,t,r,n,i)=>{this.onSubchannelStateUpdate(e,t,r,i)};this.pickedSubchannelHealthListener=()=>this.calculateAndReportNewState();this.triedAllSubchannels=false;this.stickyTransientFailureMode=false;this.requestedResolutionSinceLastUpdate=false;this.lastError=null;this.latestAddressList=null;this.connectionDelayTimeout=setTimeout((()=>{}),0);clearTimeout(this.connectionDelayTimeout);this.reportHealthStatus=t[h]}allChildrenHaveReportedTF(){return this.children.every((e=>e.hasReportedTransientFailure))}calculateAndReportNewState(){if(this.currentPick){if(this.reportHealthStatus&&!this.currentPick.isHealthy()){this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`Picked subchannel ${this.currentPick.getAddress()} is unhealthy`}))}else{this.updateState(i.ConnectivityState.READY,new PickFirstPicker(this.currentPick))}}else if(this.children.length===0){this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this))}else{if(this.stickyTransientFailureMode){this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`}))}else{this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}}}requestReresolution(){this.requestedResolutionSinceLastUpdate=true;this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(!this.allChildrenHaveReportedTF()){return}if(!this.requestedResolutionSinceLastUpdate){this.requestReresolution()}if(this.stickyTransientFailureMode){return}this.stickyTransientFailureMode=true;for(const{subchannel:e}of this.children){e.startConnecting()}this.calculateAndReportNewState()}removeCurrentPick(){if(this.currentPick!==null){const e=this.currentPick;this.currentPick=null;e.unref();e.removeConnectivityStateListener(this.subchannelStateListener);this.channelControlHelper.removeChannelzChild(e.getChannelzRef());if(this.reportHealthStatus){e.removeHealthStateWatcher(this.pickedSubchannelHealthListener)}}}onSubchannelStateUpdate(e,t,r,n){var s;if((s=this.currentPick)===null||s===void 0?void 0:s.realSubchannelEquals(e)){if(r!==i.ConnectivityState.READY){this.removeCurrentPick();this.calculateAndReportNewState();this.requestReresolution()}return}for(const[t,s]of this.children.entries()){if(e.realSubchannelEquals(s.subchannel)){if(r===i.ConnectivityState.READY){this.pickSubchannel(s.subchannel)}if(r===i.ConnectivityState.TRANSIENT_FAILURE){s.hasReportedTransientFailure=true;if(n){this.lastError=n}this.maybeEnterStickyTransientFailureMode();if(t===this.currentSubchannelIndex){this.startNextSubchannelConnecting(t+1)}}s.subchannel.startConnecting();return}}}startNextSubchannelConnecting(e){clearTimeout(this.connectionDelayTimeout);if(this.triedAllSubchannels){return}for(const[t,r]of this.children.entries()){if(t>=e){const e=r.subchannel.getConnectivityState();if(e===i.ConnectivityState.IDLE||e===i.ConnectivityState.CONNECTING){this.startConnecting(t);return}}}this.triedAllSubchannels=true;this.maybeEnterStickyTransientFailureMode()}startConnecting(e){var t,r;clearTimeout(this.connectionDelayTimeout);this.currentSubchannelIndex=e;if(this.children[e].subchannel.getConnectivityState()===i.ConnectivityState.IDLE){trace("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress());process.nextTick((()=>{var t;(t=this.children[e])===null||t===void 0?void 0:t.subchannel.startConnecting()}))}this.connectionDelayTimeout=(r=(t=setTimeout((()=>{this.startNextSubchannelConnecting(e+1)}),f)).unref)===null||r===void 0?void 0:r.call(t)}pickSubchannel(e){if(this.currentPick&&e.realSubchannelEquals(this.currentPick)){return}trace("Pick subchannel with address "+e.getAddress());this.stickyTransientFailureMode=false;this.removeCurrentPick();this.currentPick=e;e.ref();if(this.reportHealthStatus){e.addHealthStateWatcher(this.pickedSubchannelHealthListener)}this.channelControlHelper.addChannelzChild(e.getChannelzRef());this.resetSubchannelList();clearTimeout(this.connectionDelayTimeout);this.calculateAndReportNewState()}updateState(e,t){trace(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]);this.currentState=e;this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(const e of this.children){if(!(this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick))){e.subchannel.removeConnectivityStateListener(this.subchannelStateListener)}e.subchannel.unref();this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef())}this.currentSubchannelIndex=0;this.children=[];this.triedAllSubchannels=false;this.requestedResolutionSinceLastUpdate=false}connectToAddressList(e){const t=e.map((e=>({subchannel:this.channelControlHelper.createSubchannel(e,{}),hasReportedTransientFailure:false})));for(const{subchannel:e}of t){e.ref();this.channelControlHelper.addChannelzChild(e.getChannelzRef())}this.resetSubchannelList();this.children=t;for(const{subchannel:e}of this.children){e.addConnectivityStateListener(this.subchannelStateListener);if(e.getConnectivityState()===i.ConnectivityState.READY){this.pickSubchannel(e);return}}for(const e of this.children){if(e.subchannel.getConnectivityState()===i.ConnectivityState.TRANSIENT_FAILURE){e.hasReportedTransientFailure=true}}this.startNextSubchannelConnecting(0);this.calculateAndReportNewState()}updateAddressList(e,t){if(!(t instanceof PickFirstLoadBalancingConfig)){return}if(t.getShuffleAddressList()){e=shuffled(e)}const r=[].concat(...e.map((e=>e.addresses)));if(r.length===0){throw new Error("No addresses in endpoint list passed to pick_first")}const n=interleaveAddressFamilies(r);this.latestAddressList=n;this.connectToAddressList(n)}exitIdle(){if(this.currentState===i.ConnectivityState.IDLE&&this.latestAddressList){this.connectToAddressList(this.latestAddressList)}}resetBackoff(){}destroy(){this.resetSubchannelList();this.removeCurrentPick()}getTypeName(){return d}}t.PickFirstLoadBalancer=PickFirstLoadBalancer;const p=new PickFirstLoadBalancingConfig(false);class LeafLoadBalancer{constructor(e,t,r){this.endpoint=e;this.latestState=i.ConnectivityState.IDLE;const a=(0,n.createChildChannelControlHelper)(t,{updateState:(e,r)=>{this.latestState=e;this.latestPicker=r;t.updateState(e,r)}});this.pickFirstBalancer=new PickFirstLoadBalancer(a,Object.assign(Object.assign({},r),{[h]:true}));this.latestPicker=new s.QueuePicker(this.pickFirstBalancer)}startConnecting(){this.pickFirstBalancer.updateAddressList([this.endpoint],p)}updateEndpoint(e){this.endpoint=e;if(this.latestState!==i.ConnectivityState.IDLE){this.startConnecting()}}getConnectivityState(){return this.latestState}getPicker(){return this.latestPicker}getEndpoint(){return this.endpoint}exitIdle(){this.pickFirstBalancer.exitIdle()}destroy(){this.pickFirstBalancer.destroy()}}t.LeafLoadBalancer=LeafLoadBalancer;function setup(){(0,n.registerLoadBalancerType)(d,PickFirstLoadBalancer,PickFirstLoadBalancingConfig);(0,n.registerDefaultLoadBalancerType)(d)}t.setup=setup},2787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.setup=t.RoundRobinLoadBalancer=void 0;const n=r(2680);const i=r(878);const s=r(1611);const a=r(5993);const o=r(634);const l=r(9905);const c=r(8977);const u="round_robin";function trace(e){a.trace(o.LogVerbosity.DEBUG,u,e)}const d="round_robin";class RoundRobinLoadBalancingConfig{getLoadBalancerName(){return d}constructor(){}toJsonObject(){return{[d]:{}}}static createFromJson(e){return new RoundRobinLoadBalancingConfig}}class RoundRobinPicker{constructor(e,t=0){this.children=e;this.nextIndex=t}pick(e){const t=this.children[this.nextIndex].picker;this.nextIndex=(this.nextIndex+1)%this.children.length;return t.pick(e)}peekNextEndpoint(){return this.children[this.nextIndex].endpoint}}class RoundRobinLoadBalancer{constructor(e,t){this.channelControlHelper=e;this.options=t;this.children=[];this.currentState=i.ConnectivityState.IDLE;this.currentReadyPicker=null;this.updatesPaused=false;this.lastError=null;this.childChannelControlHelper=(0,n.createChildChannelControlHelper)(e,{updateState:(e,t)=>{this.calculateAndUpdateState()}})}countChildrenWithState(e){return this.children.filter((t=>t.getConnectivityState()===e)).length}calculateAndUpdateState(){if(this.updatesPaused){return}if(this.countChildrenWithState(i.ConnectivityState.READY)>0){const e=this.children.filter((e=>e.getConnectivityState()===i.ConnectivityState.READY));let t=0;if(this.currentReadyPicker!==null){const r=this.currentReadyPicker.peekNextEndpoint();t=e.findIndex((e=>(0,l.endpointEqual)(e.getEndpoint(),r)));if(t<0){t=0}}this.updateState(i.ConnectivityState.READY,new RoundRobinPicker(e.map((e=>({endpoint:e.getEndpoint(),picker:e.getPicker()}))),t))}else if(this.countChildrenWithState(i.ConnectivityState.CONNECTING)>0){this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}else if(this.countChildrenWithState(i.ConnectivityState.TRANSIENT_FAILURE)>0){this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`}))}else{this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this))}for(const e of this.children){if(e.getConnectivityState()===i.ConnectivityState.IDLE){e.exitIdle()}}}updateState(e,t){trace(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]);if(e===i.ConnectivityState.READY){this.currentReadyPicker=t}else{this.currentReadyPicker=null}this.currentState=e;this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(const e of this.children){e.destroy()}}updateAddressList(e,t){this.resetSubchannelList();trace("Connect to endpoint list "+e.map(l.endpointToString));this.updatesPaused=true;this.children=e.map((e=>new c.LeafLoadBalancer(e,this.childChannelControlHelper,this.options)));for(const e of this.children){e.startConnecting()}this.updatesPaused=false;this.calculateAndUpdateState()}exitIdle(){}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return d}}t.RoundRobinLoadBalancer=RoundRobinLoadBalancer;function setup(){(0,n.registerLoadBalancerType)(d,RoundRobinLoadBalancer,RoundRobinLoadBalancingConfig)}t.setup=setup},2680:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.selectLbConfigFromList=t.getDefaultConfig=t.parseLoadBalancingConfig=t.isLoadBalancerNameRegistered=t.createLoadBalancer=t.registerDefaultLoadBalancerType=t.registerLoadBalancerType=t.createChildChannelControlHelper=void 0;const n=r(5993);const i=r(634);function createChildChannelControlHelper(e,t){var r,n,i,s,a,o,l,c,u,d;return{createSubchannel:(n=(r=t.createSubchannel)===null||r===void 0?void 0:r.bind(t))!==null&&n!==void 0?n:e.createSubchannel.bind(e),updateState:(s=(i=t.updateState)===null||i===void 0?void 0:i.bind(t))!==null&&s!==void 0?s:e.updateState.bind(e),requestReresolution:(o=(a=t.requestReresolution)===null||a===void 0?void 0:a.bind(t))!==null&&o!==void 0?o:e.requestReresolution.bind(e),addChannelzChild:(c=(l=t.addChannelzChild)===null||l===void 0?void 0:l.bind(t))!==null&&c!==void 0?c:e.addChannelzChild.bind(e),removeChannelzChild:(d=(u=t.removeChannelzChild)===null||u===void 0?void 0:u.bind(t))!==null&&d!==void 0?d:e.removeChannelzChild.bind(e)}}t.createChildChannelControlHelper=createChildChannelControlHelper;const s={};let a=null;function registerLoadBalancerType(e,t,r){s[e]={LoadBalancer:t,LoadBalancingConfig:r}}t.registerLoadBalancerType=registerLoadBalancerType;function registerDefaultLoadBalancerType(e){a=e}t.registerDefaultLoadBalancerType=registerDefaultLoadBalancerType;function createLoadBalancer(e,t,r){const n=e.getLoadBalancerName();if(n in s){return new s[n].LoadBalancer(t,r)}else{return null}}t.createLoadBalancer=createLoadBalancer;function isLoadBalancerNameRegistered(e){return e in s}t.isLoadBalancerNameRegistered=isLoadBalancerNameRegistered;function parseLoadBalancingConfig(e){const t=Object.keys(e);if(t.length!==1){throw new Error("Provided load balancing config has multiple conflicting entries")}const r=t[0];if(r in s){try{return s[r].LoadBalancingConfig.createFromJson(e[r])}catch(e){throw new Error(`${r}: ${e.message}`)}}else{throw new Error(`Unrecognized load balancing config name ${r}`)}}t.parseLoadBalancingConfig=parseLoadBalancingConfig;function getDefaultConfig(){if(!a){throw new Error("No default load balancer type registered")}return new s[a].LoadBalancingConfig}t.getDefaultConfig=getDefaultConfig;function selectLbConfigFromList(e,t=false){for(const t of e){try{return parseLoadBalancingConfig(t)}catch(e){(0,n.log)(i.LogVerbosity.DEBUG,"Config parsing failed with error",e.message);continue}}if(t){if(a){return new s[a].LoadBalancingConfig}else{return null}}else{return null}}t.selectLbConfigFromList=selectLbConfigFromList},776:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.LoadBalancingCall=void 0;const n=r(878);const i=r(634);const s=r(511);const a=r(3665);const o=r(1611);const l=r(5974);const c=r(5993);const u=r(9129);const d=r(5158);const f="load_balancing_call";class LoadBalancingCall{constructor(e,t,r,n,i,s,a){var o,c;this.channel=e;this.callConfig=t;this.methodName=r;this.host=n;this.credentials=i;this.deadline=s;this.callNumber=a;this.child=null;this.readPending=false;this.pendingMessage=null;this.pendingHalfClose=false;this.ended=false;this.metadata=null;this.listener=null;this.onCallEnded=null;const u=this.methodName.split("/");let d="";if(u.length>=2){d=u[1]}const f=(c=(o=(0,l.splitHostPort)(this.host))===null||o===void 0?void 0:o.host)!==null&&c!==void 0?c:"localhost";this.serviceUrl=`https://${f}/${d}`}trace(e){c.trace(i.LogVerbosity.DEBUG,f,"["+this.callNumber+"] "+e)}outputStatus(e,t){var r,n;if(!this.ended){this.ended=true;this.trace("ended with status: code="+e.code+' details="'+e.details+'"');const i=Object.assign(Object.assign({},e),{progress:t});(r=this.listener)===null||r===void 0?void 0:r.onReceiveStatus(i);(n=this.onCallEnded)===null||n===void 0?void 0:n.call(this,i.code)}}doPick(){var e,t;if(this.ended){return}if(!this.metadata){throw new Error("doPick called before start")}this.trace("Pick called");const r=this.metadata.clone();const l=this.channel.doPick(r,this.callConfig.pickInformation);const c=l.subchannel?"("+l.subchannel.getChannelzRef().id+") "+l.subchannel.getAddress():""+l.subchannel;this.trace("Pick result: "+o.PickResultType[l.pickResultType]+" subchannel: "+c+" status: "+((e=l.status)===null||e===void 0?void 0:e.code)+" "+((t=l.status)===null||t===void 0?void 0:t.details));switch(l.pickResultType){case o.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then((e=>{var t,o,u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}r.merge(e);if(r.get("authorization").length>1){this.outputStatus({code:i.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new a.Metadata},"PROCESSED")}if(l.subchannel.getConnectivityState()!==n.ConnectivityState.READY){this.trace("Picked subchannel "+c+" has state "+n.ConnectivityState[l.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick");this.doPick();return}if(this.deadline!==Infinity){r.set("grpc-timeout",(0,s.getDeadlineTimeoutString)(this.deadline))}try{this.child=l.subchannel.getRealSubchannel().createCall(r,this.host,this.methodName,{onReceiveMetadata:e=>{this.trace("Received metadata");this.listener.onReceiveMetadata(e)},onReceiveMessage:e=>{this.trace("Received message");this.listener.onReceiveMessage(e)},onReceiveStatus:e=>{this.trace("Received status");if(e.rstCode===d.constants.NGHTTP2_REFUSED_STREAM){this.outputStatus(e,"REFUSED")}else{this.outputStatus(e,"PROCESSED")}}})}catch(e){this.trace("Failed to start call on picked subchannel "+c+" with error "+e.message);this.outputStatus({code:i.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+e.message,metadata:new a.Metadata},"NOT_STARTED");return}(o=(t=this.callConfig).onCommitted)===null||o===void 0?void 0:o.call(t);(u=l.onCallStarted)===null||u===void 0?void 0:u.call(l);this.onCallEnded=l.onCallEnded;this.trace("Created child call ["+this.child.getCallNumber()+"]");if(this.readPending){this.child.startRead()}if(this.pendingMessage){this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message)}if(this.pendingHalfClose){this.child.halfClose()}}),(e=>{const{code:t,details:r}=(0,u.restrictControlPlaneStatusCode)(typeof e.code==="number"?e.code:i.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${e.message}`);this.outputStatus({code:t,details:r,metadata:new a.Metadata},"PROCESSED")}));break;case o.PickResultType.DROP:const{code:e,details:t}=(0,u.restrictControlPlaneStatusCode)(l.status.code,l.status.details);setImmediate((()=>{this.outputStatus({code:e,details:t,metadata:l.status.metadata},"DROP")}));break;case o.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady){this.channel.queueCallForPick(this)}else{const{code:e,details:t}=(0,u.restrictControlPlaneStatusCode)(l.status.code,l.status.details);setImmediate((()=>{this.outputStatus({code:e,details:t,metadata:l.status.metadata},"PROCESSED")}))}break;case o.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"');(r=this.child)===null||r===void 0?void 0:r.cancelWithStatus(e,t);this.outputStatus({code:e,details:t,metadata:new a.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called");this.listener=t;this.metadata=e;this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);if(this.child){this.child.sendMessageWithContext(e,t)}else{this.pendingMessage={context:e,message:t}}}startRead(){this.trace("startRead called");if(this.child){this.child.startRead()}else{this.readPending=true}}halfClose(){this.trace("halfClose called");if(this.child){this.child.halfClose()}else{this.pendingHalfClose=true}}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}}t.LoadBalancingCall=LoadBalancingCall},5993:(e,t,r)=>{var n,i,s,a;Object.defineProperty(t,"__esModule",{value:true});t.isTracerEnabled=t.trace=t.log=t.setLoggerVerbosity=t.setLogger=t.getLogger=void 0;const o=r(634);const l=r(7282);const c=r(6569).i8;const u={error:(e,...t)=>{console.error("E "+e,...t)},info:(e,...t)=>{console.error("I "+e,...t)},debug:(e,...t)=>{console.error("D "+e,...t)}};let d=u;let f=o.LogVerbosity.ERROR;const h=(i=(n=process.env.GRPC_NODE_VERBOSITY)!==null&&n!==void 0?n:process.env.GRPC_VERBOSITY)!==null&&i!==void 0?i:"";switch(h.toUpperCase()){case"DEBUG":f=o.LogVerbosity.DEBUG;break;case"INFO":f=o.LogVerbosity.INFO;break;case"ERROR":f=o.LogVerbosity.ERROR;break;case"NONE":f=o.LogVerbosity.NONE;break;default:}const getLogger=()=>d;t.getLogger=getLogger;const setLogger=e=>{d=e};t.setLogger=setLogger;const setLoggerVerbosity=e=>{f=e};t.setLoggerVerbosity=setLoggerVerbosity;const log=(e,...t)=>{let r;if(e>=f){switch(e){case o.LogVerbosity.DEBUG:r=d.debug;break;case o.LogVerbosity.INFO:r=d.info;break;case o.LogVerbosity.ERROR:r=d.error;break}if(!r){r=d.error}if(r){r.bind(d)(...t)}}};t.log=log;const p=(a=(s=process.env.GRPC_NODE_TRACE)!==null&&s!==void 0?s:process.env.GRPC_TRACE)!==null&&a!==void 0?a:"";const g=new Set;const m=new Set;for(const e of p.split(",")){if(e.startsWith("-")){m.add(e.substring(1))}else{g.add(e)}}const v=g.has("all");function trace(e,r,n){if(isTracerEnabled(r)){(0,t.log)(e,(new Date).toISOString()+" | v"+c+" "+l.pid+" | "+r+" | "+n)}}t.trace=trace;function isTracerEnabled(e){return!m.has(e)&&(v||g.has(e))}t.isTracerEnabled=isTracerEnabled},8541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.loadPackageDefinition=t.makeClientConstructor=void 0;const n=r(7172);const i={unary:n.Client.prototype.makeUnaryRequest,server_stream:n.Client.prototype.makeServerStreamRequest,client_stream:n.Client.prototype.makeClientStreamRequest,bidi:n.Client.prototype.makeBidiStreamRequest};function isPrototypePolluted(e){return["__proto__","prototype","constructor"].includes(e)}function makeClientConstructor(e,t,r){if(!r){r={}}class ServiceClientImpl extends n.Client{}Object.keys(e).forEach((t=>{if(isPrototypePolluted(t)){return}const r=e[t];let n;if(typeof t==="string"&&t.charAt(0)==="$"){throw new Error("Method names cannot start with $")}if(r.requestStream){if(r.responseStream){n="bidi"}else{n="client_stream"}}else{if(r.responseStream){n="server_stream"}else{n="unary"}}const s=r.requestSerialize;const a=r.responseDeserialize;const o=partial(i[n],r.path,s,a);ServiceClientImpl.prototype[t]=o;Object.assign(ServiceClientImpl.prototype[t],r);if(r.originalName&&!isPrototypePolluted(r.originalName)){ServiceClientImpl.prototype[r.originalName]=ServiceClientImpl.prototype[t]}}));ServiceClientImpl.service=e;ServiceClientImpl.serviceName=t;return ServiceClientImpl}t.makeClientConstructor=makeClientConstructor;function partial(e,t,r,n){return function(...i){return e.call(this,t,r,n,...i)}}function isProtobufTypeDefinition(e){return"format"in e}function loadPackageDefinition(e){const t={};for(const r in e){if(Object.prototype.hasOwnProperty.call(e,r)){const n=e[r];const i=r.split(".");if(i.some((e=>isPrototypePolluted(e)))){continue}const s=i[i.length-1];let a=t;for(const e of i.slice(0,-1)){if(!a[e]){a[e]={}}a=a[e]}if(isProtobufTypeDefinition(n)){a[s]=n}else{a[s]=makeClientConstructor(n,s,{})}}}return t}t.loadPackageDefinition=loadPackageDefinition},659:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.MaxMessageSizeFilterFactory=t.MaxMessageSizeFilter=void 0;const n=r(3392);const i=r(634);const s=r(3665);class MaxMessageSizeFilter extends n.BaseFilter{constructor(e){super();this.maxSendMessageSize=i.DEFAULT_MAX_SEND_MESSAGE_LENGTH;this.maxReceiveMessageSize=i.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;if("grpc.max_send_message_length"in e){this.maxSendMessageSize=e["grpc.max_send_message_length"]}if("grpc.max_receive_message_length"in e){this.maxReceiveMessageSize=e["grpc.max_receive_message_length"]}}async sendMessage(e){if(this.maxSendMessageSize===-1){return e}else{const t=await e;if(t.message.length>this.maxSendMessageSize){throw{code:i.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${t.message.length} vs. ${this.maxSendMessageSize})`,metadata:new s.Metadata}}else{return t}}}async receiveMessage(e){if(this.maxReceiveMessageSize===-1){return e}else{const t=await e;if(t.length>this.maxReceiveMessageSize){throw{code:i.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${t.length} vs. ${this.maxReceiveMessageSize})`,metadata:new s.Metadata}}else{return t}}}}t.MaxMessageSizeFilter=MaxMessageSizeFilter;class MaxMessageSizeFilterFactory{constructor(e){this.options=e}createFilter(){return new MaxMessageSizeFilter(this.options)}}t.MaxMessageSizeFilterFactory=MaxMessageSizeFilterFactory},3665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.Metadata=void 0;const n=r(5993);const i=r(634);const s=r(2336);const a=/^[0-9a-z_.-]+$/;const o=/^[ -~]*$/;function isLegalKey(e){return a.test(e)}function isLegalNonBinaryValue(e){return o.test(e)}function isBinaryKey(e){return e.endsWith("-bin")}function isCustomMetadata(e){return!e.startsWith("grpc-")}function normalizeKey(e){return e.toLowerCase()}function validate(e,t){if(!isLegalKey(e)){throw new Error('Metadata key "'+e+'" contains illegal characters')}if(t!==null&&t!==undefined){if(isBinaryKey(e)){if(!Buffer.isBuffer(t)){throw new Error("keys that end with '-bin' must have Buffer values")}}else{if(Buffer.isBuffer(t)){throw new Error("keys that don't end with '-bin' must have String values")}if(!isLegalNonBinaryValue(t)){throw new Error('Metadata string value "'+t+'" contains illegal characters')}}}}class Metadata{constructor(e={}){this.internalRepr=new Map;this.options=e}set(e,t){e=normalizeKey(e);validate(e,t);this.internalRepr.set(e,[t])}add(e,t){e=normalizeKey(e);validate(e,t);const r=this.internalRepr.get(e);if(r===undefined){this.internalRepr.set(e,[t])}else{r.push(t)}}remove(e){e=normalizeKey(e);this.internalRepr.delete(e)}get(e){e=normalizeKey(e);return this.internalRepr.get(e)||[]}getMap(){const e={};for(const[t,r]of this.internalRepr){if(r.length>0){const n=r[0];e[t]=Buffer.isBuffer(n)?Buffer.from(n):n}}return e}clone(){const e=new Metadata(this.options);const t=e.internalRepr;for(const[e,r]of this.internalRepr){const n=r.map((e=>{if(Buffer.isBuffer(e)){return Buffer.from(e)}else{return e}}));t.set(e,n)}return e}merge(e){for(const[t,r]of e.internalRepr){const e=(this.internalRepr.get(t)||[]).concat(r);this.internalRepr.set(t,e)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){const e={};for(const[t,r]of this.internalRepr){e[t]=r.map(bufToString)}return e}toJSON(){const e={};for(const[t,r]of this.internalRepr){e[t]=r}return e}static fromHttp2Headers(e){const t=new Metadata;for(const r of Object.keys(e)){if(r.charAt(0)===":"){continue}const a=e[r];try{if(isBinaryKey(r)){if(Array.isArray(a)){a.forEach((e=>{t.add(r,Buffer.from(e,"base64"))}))}else if(a!==undefined){if(isCustomMetadata(r)){a.split(",").forEach((e=>{t.add(r,Buffer.from(e.trim(),"base64"))}))}else{t.add(r,Buffer.from(a,"base64"))}}}else{if(Array.isArray(a)){a.forEach((e=>{t.add(r,e)}))}else if(a!==undefined){t.add(r,a)}}}catch(e){const t=`Failed to add metadata entry ${r}: ${a}. ${(0,s.getErrorMessage)(e)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,n.log)(i.LogVerbosity.ERROR,t)}}return t}}t.Metadata=Metadata;const bufToString=e=>Buffer.isBuffer(e)?e.toString("base64"):e},1611:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.QueuePicker=t.UnavailablePicker=t.PickResultType=void 0;const n=r(3665);const i=r(634);var s;(function(e){e[e["COMPLETE"]=0]="COMPLETE";e[e["QUEUE"]=1]="QUEUE";e[e["TRANSIENT_FAILURE"]=2]="TRANSIENT_FAILURE";e[e["DROP"]=3]="DROP"})(s||(t.PickResultType=s={}));class UnavailablePicker{constructor(e){this.status=Object.assign({code:i.Status.UNAVAILABLE,details:"No connection established",metadata:new n.Metadata},e)}pick(e){return{pickResultType:s.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}t.UnavailablePicker=UnavailablePicker;class QueuePicker{constructor(e,t){this.loadBalancer=e;this.childPicker=t;this.calledExitIdle=false}pick(e){if(!this.calledExitIdle){process.nextTick((()=>{this.loadBalancer.exitIdle()}));this.calledExitIdle=true}if(this.childPicker){return this.childPicker.pick(e)}else{return{pickResultType:s.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}}t.QueuePicker=QueuePicker},4886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.setup=t.DEFAULT_PORT=void 0;const n=r(1594);const i=r(9523);const s=r(3837);const a=r(1761);const o=r(634);const l=r(3665);const c=r(5993);const u=r(634);const d=r(5974);const f=r(1808);const h=r(4186);const p="dns_resolver";function trace(e){c.trace(u.LogVerbosity.DEBUG,p,e)}t.DEFAULT_PORT=443;const g=3e4;const m=s.promisify(i.resolveTxt);const v=s.promisify(i.lookup);class DnsResolver{constructor(e,r,n){var i,s,a;this.target=e;this.listener=r;this.pendingLookupPromise=null;this.pendingTxtPromise=null;this.latestLookupResult=null;this.latestServiceConfig=null;this.latestServiceConfigError=null;this.continueResolving=false;this.isNextResolutionTimerRunning=false;this.isServiceConfigEnabled=true;this.returnedIpResult=false;trace("Resolver constructed for target "+(0,d.uriToString)(e));const c=(0,d.splitHostPort)(e.path);if(c===null){this.ipResult=null;this.dnsHostname=null;this.port=null}else{if((0,f.isIPv4)(c.host)||(0,f.isIPv6)(c.host)){this.ipResult=[{addresses:[{host:c.host,port:(i=c.port)!==null&&i!==void 0?i:t.DEFAULT_PORT}]}];this.dnsHostname=null;this.port=null}else{this.ipResult=null;this.dnsHostname=c.host;this.port=(s=c.port)!==null&&s!==void 0?s:t.DEFAULT_PORT}}this.percentage=Math.random()*100;if(n["grpc.service_config_disable_resolution"]===1){this.isServiceConfigEnabled=false}this.defaultResolutionError={code:o.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,d.uriToString)(this.target)}`,metadata:new l.Metadata};const u={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoff=new h.BackoffTimeout((()=>{if(this.continueResolving){this.startResolutionWithBackoff()}}),u);this.backoff.unref();this.minTimeBetweenResolutionsMs=(a=n["grpc.dns_min_time_between_resolutions_ms"])!==null&&a!==void 0?a:g;this.nextResolutionTimer=setTimeout((()=>{}),0);clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){if(!this.returnedIpResult){trace("Returning IP address for target "+(0,d.uriToString)(this.target));setImmediate((()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}));this.returnedIpResult=true}this.backoff.stop();this.backoff.reset();this.stopNextResolutionTimer();return}if(this.dnsHostname===null){trace("Failed to parse DNS address "+(0,d.uriToString)(this.target));setImmediate((()=>{this.listener.onError({code:o.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,d.uriToString)(this.target)}`,metadata:new l.Metadata})}));this.stopNextResolutionTimer()}else{if(this.pendingLookupPromise!==null){return}trace("Looking up DNS hostname "+this.dnsHostname);this.latestLookupResult=null;const e=this.dnsHostname;this.pendingLookupPromise=v(e,{all:true});this.pendingLookupPromise.then((e=>{if(this.pendingLookupPromise===null){return}this.pendingLookupPromise=null;this.backoff.reset();this.backoff.stop();const t=e.map((e=>({host:e.address,port:+this.port})));this.latestLookupResult=t.map((e=>({addresses:[e]})));const r="["+t.map((e=>e.host+":"+e.port)).join(",")+"]";trace("Resolved addresses for target "+(0,d.uriToString)(this.target)+": "+r);if(this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}),(e=>{if(this.pendingLookupPromise===null){return}trace("Resolution error for target "+(0,d.uriToString)(this.target)+": "+e.message);this.pendingLookupPromise=null;this.stopNextResolutionTimer();this.listener.onError(this.defaultResolutionError)}));if(this.isServiceConfigEnabled&&this.pendingTxtPromise===null){this.pendingTxtPromise=m(e);this.pendingTxtPromise.then((e=>{if(this.pendingTxtPromise===null){return}this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,a.extractAndSelectServiceConfig)(e,this.percentage)}catch(e){this.latestServiceConfigError={code:o.Status.UNAVAILABLE,details:`Parsing service config failed with error ${e.message}`,metadata:new l.Metadata}}if(this.latestLookupResult!==null){this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}}),(e=>{}))}}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer);this.nextResolutionTimer=(t=(e=setTimeout((()=>{this.stopNextResolutionTimer();if(this.continueResolving){this.startResolutionWithBackoff()}}),this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e);this.isNextResolutionTimerRunning=true}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer);this.isNextResolutionTimerRunning=false}startResolutionWithBackoff(){if(this.pendingLookupPromise===null){this.continueResolving=false;this.backoff.runOnce();this.startNextResolutionTimer();this.startResolution()}}updateResolution(){if(this.pendingLookupPromise===null){if(this.isNextResolutionTimerRunning||this.backoff.isRunning()){if(this.isNextResolutionTimerRunning){trace('resolution update delayed by "min time between resolutions" rate limit')}else{trace("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString())}this.continueResolving=true}else{this.startResolutionWithBackoff()}}}destroy(){this.continueResolving=false;this.backoff.reset();this.backoff.stop();this.stopNextResolutionTimer();this.pendingLookupPromise=null;this.pendingTxtPromise=null;this.latestLookupResult=null;this.latestServiceConfig=null;this.latestServiceConfigError=null;this.returnedIpResult=false}static getDefaultAuthority(e){return e.path}}function setup(){(0,n.registerResolver)("dns",DnsResolver);(0,n.registerDefaultScheme)("dns")}t.setup=setup},7902:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.setup=void 0;const n=r(1808);const i=r(634);const s=r(3665);const a=r(1594);const o=r(5974);const l=r(5993);const c="ip_resolver";function trace(e){l.trace(i.LogVerbosity.DEBUG,c,e)}const u="ipv4";const d="ipv6";const f=443;class IpResolver{constructor(e,t,r){var a;this.listener=t;this.endpoints=[];this.error=null;this.hasReturnedResult=false;trace("Resolver constructed for target "+(0,o.uriToString)(e));const l=[];if(!(e.scheme===u||e.scheme===d)){this.error={code:i.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new s.Metadata};return}const c=e.path.split(",");for(const t of c){const r=(0,o.splitHostPort)(t);if(r===null){this.error={code:i.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new s.Metadata};return}if(e.scheme===u&&!(0,n.isIPv4)(r.host)||e.scheme===d&&!(0,n.isIPv6)(r.host)){this.error={code:i.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new s.Metadata};return}l.push({host:r.host,port:(a=r.port)!==null&&a!==void 0?a:f})}this.endpoints=l.map((e=>({addresses:[e]})));trace("Parsed "+e.scheme+" address list "+l)}updateResolution(){if(!this.hasReturnedResult){this.hasReturnedResult=true;process.nextTick((()=>{if(this.error){this.listener.onError(this.error)}else{this.listener.onSuccessfulResolution(this.endpoints,null,null,null,{})}}))}}destroy(){this.hasReturnedResult=false}static getDefaultAuthority(e){return e.path.split(",")[0]}}function setup(){(0,a.registerResolver)(u,IpResolver);(0,a.registerResolver)(d,IpResolver)}t.setup=setup},5252:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.setup=void 0;const n=r(1594);class UdsResolver{constructor(e,t,r){this.listener=t;this.hasReturnedResult=false;this.endpoints=[];let n;if(e.authority===""){n="/"+e.path}else{n=e.path}this.endpoints=[{addresses:[{path:n}]}]}updateResolution(){if(!this.hasReturnedResult){this.hasReturnedResult=true;process.nextTick(this.listener.onSuccessfulResolution,this.endpoints,null,null,null,{})}}destroy(){}static getDefaultAuthority(e){return"localhost"}}function setup(){(0,n.registerResolver)("unix",UdsResolver)}t.setup=setup},1594:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.mapUriDefaultScheme=t.getDefaultAuthority=t.createResolver=t.registerDefaultScheme=t.registerResolver=void 0;const n=r(5974);const i={};let s=null;function registerResolver(e,t){i[e]=t}t.registerResolver=registerResolver;function registerDefaultScheme(e){s=e}t.registerDefaultScheme=registerDefaultScheme;function createResolver(e,t,r){if(e.scheme!==undefined&&e.scheme in i){return new i[e.scheme](e,t,r)}else{throw new Error(`No resolver could be created for target ${(0,n.uriToString)(e)}`)}}t.createResolver=createResolver;function getDefaultAuthority(e){if(e.scheme!==undefined&&e.scheme in i){return i[e.scheme].getDefaultAuthority(e)}else{throw new Error(`Invalid target ${(0,n.uriToString)(e)}`)}}t.getDefaultAuthority=getDefaultAuthority;function mapUriDefaultScheme(e){if(e.scheme===undefined||!(e.scheme in i)){if(s!==null){return{scheme:s,authority:undefined,path:(0,n.uriToString)(e)}}else{return null}}return e}t.mapUriDefaultScheme=mapUriDefaultScheme},9909:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ResolvingCall=void 0;const n=r(634);const i=r(511);const s=r(3665);const a=r(5993);const o=r(9129);const l="resolving_call";class ResolvingCall{constructor(e,t,r,s,a,o){this.channel=e;this.method=t;this.filterStackFactory=s;this.credentials=a;this.callNumber=o;this.child=null;this.readPending=false;this.pendingMessage=null;this.pendingHalfClose=false;this.ended=false;this.readFilterPending=false;this.writeFilterPending=false;this.pendingChildStatus=null;this.metadata=null;this.listener=null;this.statusWatchers=[];this.deadlineTimer=setTimeout((()=>{}),0);this.filterStack=null;this.deadline=r.deadline;this.host=r.host;if(r.parentCall){if(r.flags&n.Propagate.CANCELLATION){r.parentCall.on("cancelled",(()=>{this.cancelWithStatus(n.Status.CANCELLED,"Cancelled by parent call")}))}if(r.flags&n.Propagate.DEADLINE){this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline());this.deadline=(0,i.minDeadline)(this.deadline,r.parentCall.getDeadline())}}this.trace("Created");this.runDeadlineTimer()}trace(e){a.trace(n.LogVerbosity.DEBUG,l,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer);this.trace("Deadline: "+(0,i.deadlineToString)(this.deadline));const e=(0,i.getRelativeTimeout)(this.deadline);if(e!==Infinity){this.trace("Deadline will be reached in "+e+"ms");const handleDeadline=()=>{this.cancelWithStatus(n.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};if(e<=0){process.nextTick(handleDeadline)}else{this.deadlineTimer=setTimeout(handleDeadline,e)}}}outputStatus(e){if(!this.ended){this.ended=true;if(!this.filterStack){this.filterStack=this.filterStackFactory.createFilter()}clearTimeout(this.deadlineTimer);const t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"');this.statusWatchers.forEach((e=>e(t)));process.nextTick((()=>{var e;(e=this.listener)===null||e===void 0?void 0:e.onReceiveStatus(t)}))}}sendMessageOnChild(e,t){if(!this.child){throw new Error("sendMessageonChild called with child not populated")}const r=this.child;this.writeFilterPending=true;this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then((t=>{this.writeFilterPending=false;r.sendMessageWithContext(e,t.message);if(this.pendingHalfClose){r.halfClose()}}),(e=>{this.cancelWithStatus(e.code,e.details)}))}getConfig(){if(this.ended){return}if(!this.metadata||!this.listener){throw new Error("getConfig called before start")}const e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){if(this.metadata.getOptions().waitForReady){this.channel.queueCallForConfig(this)}else{this.outputStatus(e.error)}return}const t=e.config;if(t.status!==n.Status.OK){const{code:e,details:r}=(0,o.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:e,details:r,metadata:new s.Metadata});return}if(t.methodConfig.timeout){const e=new Date;e.setSeconds(e.getSeconds()+t.methodConfig.timeout.seconds);e.setMilliseconds(e.getMilliseconds()+t.methodConfig.timeout.nanos/1e6);this.deadline=(0,i.minDeadline)(this.deadline,e);this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories);this.filterStack=this.filterStackFactory.createFilter();this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then((e=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline);this.trace("Created child ["+this.child.getCallNumber()+"]");this.child.start(e,{onReceiveMetadata:e=>{this.trace("Received metadata");this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(e))},onReceiveMessage:e=>{this.trace("Received message");this.readFilterPending=true;this.filterStack.receiveMessage(e).then((e=>{this.trace("Finished filtering received message");this.readFilterPending=false;this.listener.onReceiveMessage(e);if(this.pendingChildStatus){this.outputStatus(this.pendingChildStatus)}}),(e=>{this.cancelWithStatus(e.code,e.details)}))},onReceiveStatus:e=>{this.trace("Received status");if(this.readFilterPending){this.pendingChildStatus=e}else{this.outputStatus(e)}}});if(this.readPending){this.child.startRead()}if(this.pendingMessage){this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message)}else if(this.pendingHalfClose){this.child.halfClose()}}),(e=>{this.outputStatus(e)}))}reportResolverError(e){var t;if((t=this.metadata)===null||t===void 0?void 0:t.getOptions().waitForReady){this.channel.queueCallForConfig(this)}else{this.outputStatus(e)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"');(r=this.child)===null||r===void 0?void 0:r.cancelWithStatus(e,t);this.outputStatus({code:e,details:t,metadata:new s.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called");this.metadata=e.clone();this.listener=t;this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);if(this.child){this.sendMessageOnChild(e,t)}else{this.pendingMessage={context:e,message:t}}}startRead(){this.trace("startRead called");if(this.child){this.child.startRead()}else{this.readPending=true}}halfClose(){this.trace("halfClose called");if(this.child&&!this.writeFilterPending){this.child.halfClose()}else{this.pendingHalfClose=true}}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}}t.ResolvingCall=ResolvingCall},9192:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ResolvingLoadBalancer=void 0;const n=r(2680);const i=r(1761);const s=r(878);const a=r(1594);const o=r(1611);const l=r(4186);const c=r(634);const u=r(3665);const d=r(5993);const f=r(634);const h=r(5974);const p=r(7559);const g="resolving_load_balancer";function trace(e){d.trace(f.LogVerbosity.DEBUG,g,e)}const m=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function hasMatchingName(e,t,r,n){for(const i of r.name){switch(n){case"EMPTY":if(!i.service&&!i.method){return true}break;case"SERVICE":if(i.service===e&&!i.method){return true}break;case"SERVICE_AND_METHOD":if(i.service===e&&i.method===t){return true}}}return false}function findMatchingConfig(e,t,r,n){for(const i of r){if(hasMatchingName(e,t,i,n)){return i}}return null}function getDefaultConfigSelector(e){return function defaultConfigSelector(t,r){var n,i;const s=t.split("/").filter((e=>e.length>0));const a=(n=s[0])!==null&&n!==void 0?n:"";const o=(i=s[1])!==null&&i!==void 0?i:"";if(e&&e.methodConfig){for(const t of m){const r=findMatchingConfig(a,o,e.methodConfig,t);if(r){return{methodConfig:r,pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}}}return{methodConfig:{name:[]},pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}}class ResolvingLoadBalancer{constructor(e,t,r,d,f){this.target=e;this.channelControlHelper=t;this.onSuccessfulResolution=d;this.onFailedResolution=f;this.latestChildState=s.ConnectivityState.IDLE;this.latestChildPicker=new o.QueuePicker(this);this.currentState=s.ConnectivityState.IDLE;this.previousServiceConfig=null;this.continueResolving=false;if(r["grpc.service_config"]){this.defaultServiceConfig=(0,i.validateServiceConfig)(JSON.parse(r["grpc.service_config"]))}else{this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]}}this.updateState(s.ConnectivityState.IDLE,new o.QueuePicker(this));this.childLoadBalancer=new p.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{if(this.backoffTimeout.isRunning()){trace("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString());this.continueResolving=true}else{this.updateResolution()}},updateState:(e,t)=>{this.latestChildState=e;this.latestChildPicker=t;this.updateState(e,t)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)},r);this.innerResolver=(0,a.createResolver)(e,{onSuccessfulResolution:(e,t,r,i,s)=>{var a;this.backoffTimeout.stop();this.backoffTimeout.reset();let o=null;if(t===null){if(r===null){this.previousServiceConfig=null;o=this.defaultServiceConfig}else{if(this.previousServiceConfig===null){this.handleResolutionFailure(r)}else{o=this.previousServiceConfig}}}else{o=t;this.previousServiceConfig=t}const l=(a=o===null||o===void 0?void 0:o.loadBalancingConfig)!==null&&a!==void 0?a:[];const d=(0,n.selectLbConfigFromList)(l,true);if(d===null){this.handleResolutionFailure({code:c.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new u.Metadata});return}this.childLoadBalancer.updateAddressList(e,d,s);const f=o!==null&&o!==void 0?o:this.defaultServiceConfig;this.onSuccessfulResolution(f,i!==null&&i!==void 0?i:getDefaultConfigSelector(f))},onError:e=>{this.handleResolutionFailure(e)}},r);const h={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new l.BackoffTimeout((()=>{if(this.continueResolving){this.updateResolution();this.continueResolving=false}else{this.updateState(this.latestChildState,this.latestChildPicker)}}),h);this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution();if(this.currentState===s.ConnectivityState.IDLE){this.updateState(s.ConnectivityState.CONNECTING,this.latestChildPicker)}this.backoffTimeout.runOnce()}updateState(e,t){trace((0,h.uriToString)(this.target)+" "+s.ConnectivityState[this.currentState]+" -> "+s.ConnectivityState[e]);if(e===s.ConnectivityState.IDLE){t=new o.QueuePicker(this,t)}this.currentState=e;this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){if(this.latestChildState===s.ConnectivityState.IDLE){this.updateState(s.ConnectivityState.TRANSIENT_FAILURE,new o.UnavailablePicker(e));this.onFailedResolution(e)}}exitIdle(){if(this.currentState===s.ConnectivityState.IDLE||this.currentState===s.ConnectivityState.TRANSIENT_FAILURE){if(this.backoffTimeout.isRunning()){this.continueResolving=true}else{this.updateResolution()}}this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset();this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy();this.innerResolver.destroy();this.backoffTimeout.reset();this.backoffTimeout.stop();this.latestChildState=s.ConnectivityState.IDLE;this.latestChildPicker=new o.QueuePicker(this);this.currentState=s.ConnectivityState.IDLE;this.previousServiceConfig=null;this.continueResolving=false}getTypeName(){return"resolving_load_balancer"}}t.ResolvingLoadBalancer=ResolvingLoadBalancer},8159:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.RetryingCall=t.MessageBufferTracker=t.RetryThrottler=void 0;const n=r(634);const i=r(3665);const s=r(5993);const a="retrying_call";class RetryThrottler{constructor(e,t,r){this.maxTokens=e;this.tokenRatio=t;if(r){this.tokens=r.tokens*(e/r.maxTokens)}else{this.tokens=e}}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}t.RetryThrottler=RetryThrottler;class MessageBufferTracker{constructor(e,t){this.totalLimit=e;this.limitPerCall=t;this.totalAllocated=0;this.allocatedPerCall=new Map}allocate(e,t){var r;const n=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;if(this.limitPerCall-n<e||this.totalLimit-this.totalAllocated<e){return false}this.allocatedPerCall.set(t,n+e);this.totalAllocated+=e;return true}free(e,t){var r;if(this.totalAllocated<e){throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`)}this.totalAllocated-=e;const n=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;if(n<e){throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${n}`)}this.allocatedPerCall.set(t,n-e)}freeAll(e){var t;const r=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<r){throw new Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`)}this.totalAllocated-=r;this.allocatedPerCall.delete(e)}}t.MessageBufferTracker=MessageBufferTracker;const o="grpc-previous-rpc-attempts";class RetryingCall{constructor(e,t,r,n,i,s,a,o,l){this.channel=e;this.callConfig=t;this.methodName=r;this.host=n;this.credentials=i;this.deadline=s;this.callNumber=a;this.bufferTracker=o;this.retryThrottler=l;this.listener=null;this.initialMetadata=null;this.underlyingCalls=[];this.writeBuffer=[];this.writeBufferOffset=0;this.readStarted=false;this.transparentRetryUsed=false;this.attempts=0;this.hedgingTimer=null;this.committedCallIndex=null;this.initialRetryBackoffSec=0;this.nextRetryBackoffSec=0;if(t.methodConfig.retryPolicy){this.state="RETRY";const e=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(e.initialBackoff.substring(0,e.initialBackoff.length-1))}else if(t.methodConfig.hedgingPolicy){this.state="HEDGING"}else{this.state="TRANSPARENT_ONLY"}}getCallNumber(){return this.callNumber}trace(e){s.trace(n.LogVerbosity.DEBUG,a,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"');this.bufferTracker.freeAll(this.callNumber);this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length;this.writeBuffer=[];process.nextTick((()=>{var t;(t=this.listener)===null||t===void 0?void 0:t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})}))}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"');this.reportStatus({code:e,details:t,metadata:new i.Metadata});for(const{call:r}of this.underlyingCalls){r.cancelWithStatus(e,t)}}getPeer(){if(this.committedCallIndex!==null){return this.underlyingCalls[this.committedCallIndex].call.getPeer()}else{return"unknown"}}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:false}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED"){return}const e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){const e=this.getBufferEntry(t);if(e.allocated){this.bufferTracker.free(e.message.message.length,this.callNumber)}}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset);this.writeBufferOffset=e}commitCall(e){if(this.state==="COMMITTED"){return}if(this.underlyingCalls[e].state==="COMPLETED"){return}this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e);this.state="COMMITTED";this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++){if(t===e){continue}if(this.underlyingCalls[t].state==="COMPLETED"){continue}this.underlyingCalls[t].state="COMPLETED";this.underlyingCalls[t].call.cancelWithStatus(n.Status.CANCELLED,"Discarded in favor of other hedged attempt")}this.clearSentMessages()}commitCallWithMostMessages(){if(this.state==="COMMITTED"){return}let e=-1;let t=-1;for(const[r,n]of this.underlyingCalls.entries()){if(n.state==="ACTIVE"&&n.nextMessageToSend>e){e=n.nextMessageToSend;t=r}}if(t===-1){this.state="TRANSPARENT_ONLY"}else{this.commitCall(t)}}isStatusCodeInList(e,t){return e.some((e=>e===t||e.toString().toLowerCase()===n.Status[t].toLowerCase()))}getNextRetryBackoffMs(){var e;const t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t){return 0}const r=Math.random()*this.nextRetryBackoffSec*1e3;const n=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,n);return r}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(false);return}const r=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(r.maxAttempts,5)){t(false);return}let n;if(e===null){n=this.getNextRetryBackoffMs()}else if(e<0){this.state="TRANSPARENT_ONLY";t(false);return}else{n=e;this.nextRetryBackoffSec=this.initialRetryBackoffSec}setTimeout((()=>{var e,r;if(this.state!=="RETRY"){t(false);return}if((r=(e=this.retryThrottler)===null||e===void 0?void 0:e.canRetryCall())!==null&&r!==void 0?r:true){t(true);this.attempts+=1;this.startNewAttempt()}}),n)}countActiveCalls(){let e=0;for(const t of this.underlyingCalls){if((t===null||t===void 0?void 0:t.state)==="ACTIVE"){e+=1}}return e}handleProcessedStatus(e,t,r){var n,i,s;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t);this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((n=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&n!==void 0?n:[],e.code)){(i=this.retryThrottler)===null||i===void 0?void 0:i.addCallFailed();let n;if(r===null){n=0}else if(r<0){this.state="TRANSPARENT_ONLY";this.commitCall(t);this.reportStatus(e);return}else{n=r}setTimeout((()=>{this.maybeStartHedgingAttempt();if(this.countActiveCalls()===0){this.commitCall(t);this.reportStatus(e)}}),n)}else{this.commitCall(t);this.reportStatus(e)}break;case"RETRY":if(this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)){(s=this.retryThrottler)===null||s===void 0?void 0:s.addCallFailed();this.maybeRetryCall(r,(r=>{if(!r){this.commitCall(t);this.reportStatus(e)}}))}else{this.commitCall(t);this.reportStatus(e)}break}}getPushback(e){const t=e.get("grpc-retry-pushback-ms");if(t.length===0){return null}try{return parseInt(t[0])}catch(e){return-1}}handleChildStatus(e,t){var r;if(this.underlyingCalls[t].state==="COMPLETED"){return}this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state);this.underlyingCalls[t].state="COMPLETED";if(e.code===n.Status.OK){(r=this.retryThrottler)===null||r===void 0?void 0:r.addCallSucceeded();this.commitCall(t);this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}const i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":if(this.transparentRetryUsed){this.handleProcessedStatus(e,t,i)}else{this.transparentRetryUsed=true;this.startNewAttempt()}break;case"DROP":this.commitCall(t);this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,i);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"){return}if(!this.callConfig.methodConfig.hedgingPolicy){return}const e=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(e.maxAttempts,5)){return}this.attempts+=1;this.startNewAttempt();this.maybeStartHedgingTimer()}maybeStartHedgingTimer(){var e,t,r;if(this.hedgingTimer){clearTimeout(this.hedgingTimer)}if(this.state!=="HEDGING"){return}if(!this.callConfig.methodConfig.hedgingPolicy){return}const n=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(n.maxAttempts,5)){return}const i=(e=n.hedgingDelay)!==null&&e!==void 0?e:"0s";const s=Number(i.substring(0,i.length-1));this.hedgingTimer=setTimeout((()=>{this.maybeStartHedgingAttempt()}),s*1e3);(r=(t=this.hedgingTimer).unref)===null||r===void 0?void 0:r.call(t)}startNewAttempt(){const e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);const t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});const r=this.attempts-1;const n=this.initialMetadata.clone();if(r>0){n.set(o,`${r}`)}let i=false;e.start(n,{onReceiveMetadata:n=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]");this.commitCall(t);i=true;if(r>0){n.set(o,`${r}`)}if(this.underlyingCalls[t].state==="ACTIVE"){this.listener.onReceiveMetadata(n)}},onReceiveMessage:r=>{this.trace("Received message from child ["+e.getCallNumber()+"]");this.commitCall(t);if(this.underlyingCalls[t].state==="ACTIVE"){this.listener.onReceiveMessage(r)}},onReceiveStatus:n=>{this.trace("Received status from child ["+e.getCallNumber()+"]");if(!i&&r>0){n.metadata.set(o,`${r}`)}this.handleChildStatus(n,t)}});this.sendNextChildMessage(t);if(this.readStarted){e.startRead()}}start(e,t){this.trace("start called");this.listener=t;this.initialMetadata=e;this.attempts+=1;this.startNewAttempt();this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,r;const n=this.underlyingCalls[e];const i=n.nextMessageToSend;(r=(t=this.getBufferEntry(i)).callback)===null||r===void 0?void 0:r.call(t);this.clearSentMessages();n.nextMessageToSend+=1;this.sendNextChildMessage(e)}sendNextChildMessage(e){const t=this.underlyingCalls[e];if(t.state==="COMPLETED"){return}if(this.getBufferEntry(t.nextMessageToSend)){const r=this.getBufferEntry(t.nextMessageToSend);switch(r.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:t=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1;t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var r;this.trace("write() called with message of length "+t.length);const n={message:t,flags:e.flags};const i=this.getNextBufferIndex();const s={entryType:"MESSAGE",message:n,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};this.writeBuffer.push(s);if(s.allocated){(r=e.callback)===null||r===void 0?void 0:r.call(e);for(const[e,r]of this.underlyingCalls.entries()){if(r.state==="ACTIVE"&&r.nextMessageToSend===i){r.call.sendMessageWithContext({callback:t=>{this.handleChildWriteCompleted(e)}},t)}}}else{this.commitCallWithMostMessages();if(this.committedCallIndex===null){return}const r=this.underlyingCalls[this.committedCallIndex];s.callback=e.callback;if(r.state==="ACTIVE"&&r.nextMessageToSend===i){r.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}}startRead(){this.trace("startRead called");this.readStarted=true;for(const e of this.underlyingCalls){if((e===null||e===void 0?void 0:e.state)==="ACTIVE"){e.call.startRead()}}}halfClose(){this.trace("halfClose called");const e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:false});for(const t of this.underlyingCalls){if((t===null||t===void 0?void 0:t.state)==="ACTIVE"&&t.nextMessageToSend===e){t.nextMessageToSend+=1;t.call.halfClose()}}}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}t.RetryingCall=RetryingCall},2533:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ServerDuplexStreamImpl=t.ServerWritableStreamImpl=t.ServerReadableStreamImpl=t.ServerUnaryCallImpl=t.serverErrorToStatus=void 0;const n=r(2361);const i=r(2781);const s=r(634);const a=r(3665);function serverErrorToStatus(e,t){var r;const n={code:s.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:(r=t!==null&&t!==void 0?t:e.metadata)!==null&&r!==void 0?r:null};if("code"in e&&typeof e.code==="number"&&Number.isInteger(e.code)){n.code=e.code;if("details"in e&&typeof e.details==="string"){n.details=e.details}}return n}t.serverErrorToStatus=serverErrorToStatus;class ServerUnaryCallImpl extends n.EventEmitter{constructor(e,t,r,n){super();this.path=e;this.call=t;this.metadata=r;this.request=n;this.cancelled=false}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}}t.ServerUnaryCallImpl=ServerUnaryCallImpl;class ServerReadableStreamImpl extends i.Readable{constructor(e,t,r){super({objectMode:true});this.path=e;this.call=t;this.metadata=r;this.cancelled=false}_read(e){this.call.startRead()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}}t.ServerReadableStreamImpl=ServerReadableStreamImpl;class ServerWritableStreamImpl extends i.Writable{constructor(e,t,r,n){super({objectMode:true});this.path=e;this.call=t;this.metadata=r;this.request=n;this.pendingStatus={code:s.Status.OK,details:"OK"};this.cancelled=false;this.trailingMetadata=new a.Metadata;this.on("error",(e=>{this.pendingStatus=serverErrorToStatus(e);this.end()}))}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}_write(e,t,r){this.call.sendMessage(e,r)}_final(e){var t;this.call.sendStatus(Object.assign(Object.assign({},this.pendingStatus),{metadata:(t=this.pendingStatus.metadata)!==null&&t!==void 0?t:this.trailingMetadata}));e(null)}end(e){if(e){this.trailingMetadata=e}return super.end()}}t.ServerWritableStreamImpl=ServerWritableStreamImpl;class ServerDuplexStreamImpl extends i.Duplex{constructor(e,t,r){super({objectMode:true});this.path=e;this.call=t;this.metadata=r;this.pendingStatus={code:s.Status.OK,details:"OK"};this.cancelled=false;this.trailingMetadata=new a.Metadata;this.on("error",(e=>{this.pendingStatus=serverErrorToStatus(e);this.end()}))}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}_read(e){this.call.startRead()}_write(e,t,r){this.call.sendMessage(e,r)}_final(e){var t;this.call.sendStatus(Object.assign(Object.assign({},this.pendingStatus),{metadata:(t=this.pendingStatus.metadata)!==null&&t!==void 0?t:this.trailingMetadata}));e(null)}end(e){if(e){this.trailingMetadata=e}return super.end()}}t.ServerDuplexStreamImpl=ServerDuplexStreamImpl},3828:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ServerCredentials=void 0;const n=r(6581);class ServerCredentials{static createInsecure(){return new InsecureServerCredentials}static createSsl(e,t,r=false){var i;if(e!==null&&!Buffer.isBuffer(e)){throw new TypeError("rootCerts must be null or a Buffer")}if(!Array.isArray(t)){throw new TypeError("keyCertPairs must be an array")}if(typeof r!=="boolean"){throw new TypeError("checkClientCertificate must be a boolean")}const s=[];const a=[];for(let e=0;e<t.length;e++){const r=t[e];if(r===null||typeof r!=="object"){throw new TypeError(`keyCertPair[${e}] must be an object`)}if(!Buffer.isBuffer(r.private_key)){throw new TypeError(`keyCertPair[${e}].private_key must be a Buffer`)}if(!Buffer.isBuffer(r.cert_chain)){throw new TypeError(`keyCertPair[${e}].cert_chain must be a Buffer`)}s.push(r.cert_chain);a.push(r.private_key)}return new SecureServerCredentials({ca:(i=e!==null&&e!==void 0?e:(0,n.getDefaultRootsData)())!==null&&i!==void 0?i:undefined,cert:s,key:a,requestCert:r,ciphers:n.CIPHER_SUITES})}}t.ServerCredentials=ServerCredentials;class InsecureServerCredentials extends ServerCredentials{_isSecure(){return false}_getSettings(){return null}_equals(e){return e instanceof InsecureServerCredentials}}class SecureServerCredentials extends ServerCredentials{constructor(e){super();this.options=e}_isSecure(){return true}_getSettings(){return this.options}_equals(e){if(this===e){return true}if(!(e instanceof SecureServerCredentials)){return false}if(Buffer.isBuffer(this.options.ca)&&Buffer.isBuffer(e.options.ca)){if(!this.options.ca.equals(e.options.ca)){return false}}else{if(this.options.ca!==e.options.ca){return false}}if(Array.isArray(this.options.cert)&&Array.isArray(e.options.cert)){if(this.options.cert.length!==e.options.cert.length){return false}for(let t=0;t<this.options.cert.length;t++){const r=this.options.cert[t];const n=e.options.cert[t];if(Buffer.isBuffer(r)&&Buffer.isBuffer(n)){if(!r.equals(n)){return false}}else{if(r!==n){return false}}}}else{if(this.options.cert!==e.options.cert){return false}}if(Array.isArray(this.options.key)&&Array.isArray(e.options.key)){if(this.options.key.length!==e.options.key.length){return false}for(let t=0;t<this.options.key.length;t++){const r=this.options.key[t];const n=e.options.key[t];if(Buffer.isBuffer(r)&&Buffer.isBuffer(n)){if(!r.equals(n)){return false}}else{if(r!==n){return false}}}}else{if(this.options.key!==e.options.key){return false}}if(this.options.requestCert!==e.options.requestCert){return false}return true}}},998:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.getServerInterceptingCall=t.BaseServerInterceptingCall=t.ServerInterceptingCall=t.ResponderBuilder=t.isInterceptingServerListener=t.ServerListenerBuilder=void 0;const n=r(3665);const i=r(634);const s=r(5158);const a=r(2336);const o=r(9796);const l=r(3837);const c=r(6575);const u=r(5993);const d=(0,l.promisify)(o.unzip);const f=(0,l.promisify)(o.inflate);const h="server_call";function trace(e){u.trace(i.LogVerbosity.DEBUG,h,e)}class ServerListenerBuilder{constructor(){this.metadata=undefined;this.message=undefined;this.halfClose=undefined;this.cancel=undefined}withOnReceiveMetadata(e){this.metadata=e;return this}withOnReceiveMessage(e){this.message=e;return this}withOnReceiveHalfClose(e){this.halfClose=e;return this}withOnCancel(e){this.cancel=e;return this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveHalfClose:this.halfClose,onCancel:this.cancel}}}t.ServerListenerBuilder=ServerListenerBuilder;function isInterceptingServerListener(e){return e.onReceiveMetadata!==undefined&&e.onReceiveMetadata.length===1}t.isInterceptingServerListener=isInterceptingServerListener;class InterceptingServerListenerImpl{constructor(e,t){this.listener=e;this.nextListener=t;this.cancelled=false;this.processingMetadata=false;this.hasPendingMessage=false;this.pendingMessage=null;this.processingMessage=false;this.hasPendingHalfClose=false}processPendingMessage(){if(this.hasPendingMessage){this.nextListener.onReceiveMessage(this.pendingMessage);this.pendingMessage=null;this.hasPendingMessage=false}}processPendingHalfClose(){if(this.hasPendingHalfClose){this.nextListener.onReceiveHalfClose();this.hasPendingHalfClose=false}}onReceiveMetadata(e){if(this.cancelled){return}this.processingMetadata=true;this.listener.onReceiveMetadata(e,(e=>{this.processingMetadata=false;if(this.cancelled){return}this.nextListener.onReceiveMetadata(e);this.processPendingMessage();this.processPendingHalfClose()}))}onReceiveMessage(e){if(this.cancelled){return}this.processingMessage=true;this.listener.onReceiveMessage(e,(e=>{this.processingMessage=false;if(this.cancelled){return}if(this.processingMetadata){this.pendingMessage=e;this.hasPendingMessage=true}else{this.nextListener.onReceiveMessage(e);this.processPendingHalfClose()}}))}onReceiveHalfClose(){if(this.cancelled){return}this.listener.onReceiveHalfClose((()=>{if(this.cancelled){return}if(this.processingMetadata||this.processingMessage){this.hasPendingHalfClose=true}else{this.nextListener.onReceiveHalfClose()}}))}onCancel(){this.cancelled=true;this.listener.onCancel();this.nextListener.onCancel()}}class ResponderBuilder{constructor(){this.start=undefined;this.metadata=undefined;this.message=undefined;this.status=undefined}withStart(e){this.start=e;return this}withSendMetadata(e){this.metadata=e;return this}withSendMessage(e){this.message=e;return this}withSendStatus(e){this.status=e;return this}build(){return{start:this.start,sendMetadata:this.metadata,sendMessage:this.message,sendStatus:this.status}}}t.ResponderBuilder=ResponderBuilder;const p={onReceiveMetadata:(e,t)=>{t(e)},onReceiveMessage:(e,t)=>{t(e)},onReceiveHalfClose:e=>{e()},onCancel:()=>{}};const g={start:e=>{e()},sendMetadata:(e,t)=>{t(e)},sendMessage:(e,t)=>{t(e)},sendStatus:(e,t)=>{t(e)}};class ServerInterceptingCall{constructor(e,t){this.nextCall=e;this.processingMetadata=false;this.processingMessage=false;this.pendingMessage=null;this.pendingMessageCallback=null;this.pendingStatus=null;this.responder=Object.assign(Object.assign({},g),t)}processPendingMessage(){if(this.pendingMessageCallback){this.nextCall.sendMessage(this.pendingMessage,this.pendingMessageCallback);this.pendingMessage=null;this.pendingMessageCallback=null}}processPendingStatus(){if(this.pendingStatus){this.nextCall.sendStatus(this.pendingStatus);this.pendingStatus=null}}start(e){this.responder.start((t=>{const r=Object.assign(Object.assign({},p),t);const n=new InterceptingServerListenerImpl(r,e);this.nextCall.start(n)}))}sendMetadata(e){this.processingMetadata=true;this.responder.sendMetadata(e,(e=>{this.processingMetadata=false;this.nextCall.sendMetadata(e);this.processPendingMessage();this.processPendingStatus()}))}sendMessage(e,t){this.processingMessage=true;this.responder.sendMessage(e,(e=>{this.processingMessage=false;if(this.processingMetadata){this.pendingMessage=e;this.pendingMessageCallback=t}else{this.nextCall.sendMessage(e,t)}}))}sendStatus(e){this.responder.sendStatus(e,(e=>{if(this.processingMetadata||this.processingMessage){this.pendingStatus=e}else{this.nextCall.sendStatus(e)}}))}startRead(){this.nextCall.startRead()}getPeer(){return this.nextCall.getPeer()}getDeadline(){return this.nextCall.getDeadline()}}t.ServerInterceptingCall=ServerInterceptingCall;const m="grpc-accept-encoding";const v="grpc-encoding";const y="grpc-message";const b="grpc-status";const S="grpc-timeout";const _=/(\d{1,8})\s*([HMSmun])/;const w={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6};const C={[m]:"identity,deflate,gzip",[v]:"identity"};const E={[s.constants.HTTP2_HEADER_STATUS]:s.constants.HTTP_STATUS_OK,[s.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"};const T={waitForTrailers:true};class BaseServerInterceptingCall{constructor(e,t,r,a,o){this.stream=e;this.callEventTracker=r;this.handler=a;this.listener=null;this.deadlineTimer=null;this.deadline=Infinity;this.maxSendMessageSize=i.DEFAULT_MAX_SEND_MESSAGE_LENGTH;this.maxReceiveMessageSize=i.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.cancelled=false;this.metadataSent=false;this.wantTrailers=false;this.cancelNotified=false;this.incomingEncoding="identity";this.decoder=new c.StreamDecoder;this.readQueue=[];this.isReadPending=false;this.receivedHalfClose=false;this.streamEnded=false;this.stream.once("error",(e=>{}));this.stream.once("close",(()=>{var e;trace("Request to method "+((e=this.handler)===null||e===void 0?void 0:e.path)+" stream closed with rstCode "+this.stream.rstCode);if(this.callEventTracker&&!this.streamEnded){this.streamEnded=true;this.callEventTracker.onStreamEnd(false);this.callEventTracker.onCallEnd({code:i.Status.CANCELLED,details:"Stream closed before sending status",metadata:null})}this.notifyOnCancel()}));this.stream.on("data",(e=>{this.handleDataFrame(e)}));this.stream.pause();this.stream.on("end",(()=>{this.handleEndEvent()}));if("grpc.max_send_message_length"in o){this.maxSendMessageSize=o["grpc.max_send_message_length"]}if("grpc.max_receive_message_length"in o){this.maxReceiveMessageSize=o["grpc.max_receive_message_length"]}const l=n.Metadata.fromHttp2Headers(t);if(u.isTracerEnabled(h)){trace("Request to "+this.handler.path+" received headers "+JSON.stringify(l.toJSON()))}const d=l.get(S);if(d.length>0){this.handleTimeoutHeader(d[0])}const f=l.get(v);if(f.length>0){this.incomingEncoding=f[0]}l.remove(S);l.remove(v);l.remove(m);l.remove(s.constants.HTTP2_HEADER_ACCEPT_ENCODING);l.remove(s.constants.HTTP2_HEADER_TE);l.remove(s.constants.HTTP2_HEADER_CONTENT_TYPE);this.metadata=l}handleTimeoutHeader(e){const t=e.toString().match(_);if(t===null){const t={code:i.Status.INTERNAL,details:`Invalid ${S} value "${e}"`,metadata:null};process.nextTick((()=>{this.sendStatus(t)}));return}const r=+t[1]*w[t[2]]|0;const n=new Date;this.deadline=n.setMilliseconds(n.getMilliseconds()+r);this.deadlineTimer=setTimeout((()=>{const e={code:i.Status.DEADLINE_EXCEEDED,details:"Deadline exceeded",metadata:null};this.sendStatus(e)}),r)}checkCancelled(){if(!this.cancelled&&(this.stream.destroyed||this.stream.closed)){this.notifyOnCancel();this.cancelled=true}return this.cancelled}notifyOnCancel(){if(this.cancelNotified){return}this.cancelNotified=true;this.cancelled=true;process.nextTick((()=>{var e;(e=this.listener)===null||e===void 0?void 0:e.onCancel()}));if(this.deadlineTimer){clearTimeout(this.deadlineTimer)}this.stream.resume()}maybeSendMetadata(){if(!this.metadataSent){this.sendMetadata(new n.Metadata)}}serializeMessage(e){const t=this.handler.serialize(e);const r=t.byteLength;const n=Buffer.allocUnsafe(r+5);n.writeUInt8(0,0);n.writeUInt32BE(r,1);t.copy(n,5);return n}decompressMessage(e,t){switch(t){case"deflate":return f(e.subarray(5));case"gzip":return d(e.subarray(5));case"identity":return e.subarray(5);default:return Promise.reject({code:i.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}}async decompressAndMaybePush(e){if(e.type!=="COMPRESSED"){throw new Error(`Invalid queue entry type: ${e.type}`)}const t=e.compressedMessage.readUInt8(0)===1;const r=t?this.incomingEncoding:"identity";const n=await this.decompressMessage(e.compressedMessage,r);try{e.parsedMessage=this.handler.deserialize(n)}catch(e){this.sendStatus({code:i.Status.INTERNAL,details:`Error deserializing request: ${e.message}`});return}e.type="READABLE";this.maybePushNextMessage()}maybePushNextMessage(){if(this.listener&&this.isReadPending&&this.readQueue.length>0&&this.readQueue[0].type!=="COMPRESSED"){this.isReadPending=false;const e=this.readQueue.shift();if(e.type==="READABLE"){this.listener.onReceiveMessage(e.parsedMessage)}else{this.listener.onReceiveHalfClose()}}}handleDataFrame(e){var t;if(this.checkCancelled()){return}trace("Request to "+this.handler.path+" received data frame of size "+e.length);const r=this.decoder.write(e);for(const e of r){this.stream.pause();if(this.maxReceiveMessageSize!==-1&&e.length-5>this.maxReceiveMessageSize){this.sendStatus({code:i.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${e.length-5} vs. ${this.maxReceiveMessageSize})`,metadata:null});return}const r={type:"COMPRESSED",compressedMessage:e,parsedMessage:null};this.readQueue.push(r);this.decompressAndMaybePush(r);(t=this.callEventTracker)===null||t===void 0?void 0:t.addMessageReceived()}}handleEndEvent(){this.readQueue.push({type:"HALF_CLOSE",compressedMessage:null,parsedMessage:null});this.receivedHalfClose=true;this.maybePushNextMessage()}start(e){trace("Request to "+this.handler.path+" start called");if(this.checkCancelled()){return}this.listener=e;e.onReceiveMetadata(this.metadata)}sendMetadata(e){if(this.checkCancelled()){return}if(this.metadataSent){return}this.metadataSent=true;const t=e?e.toHttp2Headers():null;const r=Object.assign(Object.assign(Object.assign({},E),C),t);this.stream.respond(r,T)}sendMessage(e,t){if(this.checkCancelled()){return}let r;try{r=this.serializeMessage(e)}catch(e){this.sendStatus({code:i.Status.INTERNAL,details:`Error serializing response: ${(0,a.getErrorMessage)(e)}`,metadata:null});return}if(this.maxSendMessageSize!==-1&&r.length-5>this.maxSendMessageSize){this.sendStatus({code:i.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${r.length} vs. ${this.maxSendMessageSize})`,metadata:null});return}this.maybeSendMetadata();trace("Request to "+this.handler.path+" sent data frame of size "+r.length);this.stream.write(r,(e=>{var r;if(e){this.sendStatus({code:i.Status.INTERNAL,details:`Error writing message: ${(0,a.getErrorMessage)(e)}`,metadata:null});return}(r=this.callEventTracker)===null||r===void 0?void 0:r.addMessageSent();t()}))}sendStatus(e){var t,r;if(this.checkCancelled()){return}this.notifyOnCancel();trace("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+i.Status[e.code]+" details: "+e.details);if(this.stream.headersSent){if(!this.wantTrailers){this.wantTrailers=true;this.stream.once("wantTrailers",(()=>{var t;if(this.callEventTracker&&!this.streamEnded){this.streamEnded=true;this.callEventTracker.onStreamEnd(true);this.callEventTracker.onCallEnd(e)}const r=Object.assign({[b]:e.code,[y]:encodeURI(e.details)},(t=e.metadata)===null||t===void 0?void 0:t.toHttp2Headers());this.stream.sendTrailers(r)}));this.stream.end()}}else{if(this.callEventTracker&&!this.streamEnded){this.streamEnded=true;this.callEventTracker.onStreamEnd(true);this.callEventTracker.onCallEnd(e)}const t=Object.assign(Object.assign({[b]:e.code,[y]:encodeURI(e.details)},E),(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.respond(t,{endStream:true})}}startRead(){trace("Request to "+this.handler.path+" startRead called");if(this.checkCancelled()){return}this.isReadPending=true;if(this.readQueue.length===0){if(!this.receivedHalfClose){this.stream.resume()}}else{this.maybePushNextMessage()}}getPeer(){var e;const t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;if(t===null||t===void 0?void 0:t.remoteAddress){if(t.remotePort){return`${t.remoteAddress}:${t.remotePort}`}else{return t.remoteAddress}}else{return"unknown"}}getDeadline(){return this.deadline}}t.BaseServerInterceptingCall=BaseServerInterceptingCall;function getServerInterceptingCall(e,t,r,n,i,s){const a={path:i.path,requestStream:i.type==="clientStream"||i.type==="bidi",responseStream:i.type==="serverStream"||i.type==="bidi",requestDeserialize:i.deserialize,responseSerialize:i.serialize};const o=new BaseServerInterceptingCall(t,r,n,i,s);return e.reduce(((e,t)=>t(a,e)),o)}t.getServerInterceptingCall=getServerInterceptingCall},3389:function(e,t,r){var n=this&&this.__runInitializers||function(e,t,r){var n=arguments.length>2;for(var i=0;i<t.length;i++){r=n?t[i].call(e,r):t[i].call(e)}return n?r:void 0};var i=this&&this.__esDecorate||function(e,t,r,n,i,s){function accept(e){if(e!==void 0&&typeof e!=="function")throw new TypeError("Function expected");return e}var a=n.kind,o=a==="getter"?"get":a==="setter"?"set":"value";var l=!t&&e?n["static"]?e:e.prototype:null;var c=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{});var u,d=false;for(var f=r.length-1;f>=0;f--){var h={};for(var p in n)h[p]=p==="access"?{}:n[p];for(var p in n.access)h.access[p]=n.access[p];h.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(accept(e||null))};var g=(0,r[f])(a==="accessor"?{get:c.get,set:c.set}:c[o],h);if(a==="accessor"){if(g===void 0)continue;if(g===null||typeof g!=="object")throw new TypeError("Object expected");if(u=accept(g.get))c.get=u;if(u=accept(g.set))c.set=u;if(u=accept(g.init))i.unshift(u)}else if(u=accept(g)){if(a==="field")i.unshift(u);else c[o]=u}}if(l)Object.defineProperty(l,n.name,c);d=true};Object.defineProperty(t,"__esModule",{value:true});t.Server=void 0;const s=r(5158);const a=r(3837);const o=r(634);const l=r(2533);const c=r(3828);const u=r(1594);const d=r(5993);const f=r(9905);const h=r(5974);const p=r(9975);const g=r(998);const m=~(1<<31);const v=~(1<<31);const y=2e4;const{HTTP2_HEADER_PATH:b}=s.constants;const S="server";function noop(){}function deprecate(e){return function(t,r){return a.deprecate(t,e)}}function getUnimplementedStatusResponse(e){return{code:o.Status.UNIMPLEMENTED,details:`The server does not implement the method ${e}`}}function getDefaultHandler(e,t){const r=getUnimplementedStatusResponse(t);switch(e){case"unary":return(e,t)=>{t(r,null)};case"clientStream":return(e,t)=>{t(r,null)};case"serverStream":return e=>{e.emit("error",r)};case"bidi":return e=>{e.emit("error",r)};default:throw new Error(`Invalid handlerType ${e}`)}}let _=(()=>{var e;let t=[];let r;return e=class Server{constructor(e){var r,i,s,a,o;this.boundPorts=(n(this,t),new Map);this.http2Servers=new Map;this.handlers=new Map;this.sessions=new Map;this.started=false;this.shutdown=false;this.serverAddressString="null";this.channelzEnabled=true;this.channelzTrace=new p.ChannelzTrace;this.callTracker=new p.ChannelzCallTracker;this.listenerChildrenTracker=new p.ChannelzChildrenTracker;this.sessionChildrenTracker=new p.ChannelzChildrenTracker;this.options=e!==null&&e!==void 0?e:{};if(this.options["grpc.enable_channelz"]===0){this.channelzEnabled=false}this.channelzRef=(0,p.registerChannelzServer)((()=>this.getChannelzInfo()),this.channelzEnabled);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Server created")}this.maxConnectionAgeMs=(r=this.options["grpc.max_connection_age_ms"])!==null&&r!==void 0?r:m;this.maxConnectionAgeGraceMs=(i=this.options["grpc.max_connection_age_grace_ms"])!==null&&i!==void 0?i:m;this.keepaliveTimeMs=(s=this.options["grpc.keepalive_time_ms"])!==null&&s!==void 0?s:v;this.keepaliveTimeoutMs=(a=this.options["grpc.keepalive_timeout_ms"])!==null&&a!==void 0?a:y;this.commonServerOptions={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};if("grpc-node.max_session_memory"in this.options){this.commonServerOptions.maxSessionMemory=this.options["grpc-node.max_session_memory"]}else{this.commonServerOptions.maxSessionMemory=Number.MAX_SAFE_INTEGER}if("grpc.max_concurrent_streams"in this.options){this.commonServerOptions.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]}}this.interceptors=(o=this.options.interceptors)!==null&&o!==void 0?o:[];this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,r,n;const i=this.sessions.get(e);const s=e.socket;const a=s.remoteAddress?(0,f.stringToSubchannelAddress)(s.remoteAddress,s.remotePort):null;const o=s.localAddress?(0,f.stringToSubchannelAddress)(s.localAddress,s.localPort):null;let l;if(e.encrypted){const e=s;const r=e.getCipher();const n=e.getCertificate();const i=e.getPeerCertificate();l={cipherSuiteStandardName:(t=r.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:r.standardName?null:r.name,localCertificate:n&&"raw"in n?n.raw:null,remoteCertificate:i&&"raw"in i?i.raw:null}}else{l=null}const c={remoteAddress:a,localAddress:o,security:l,remoteName:null,streamsStarted:i.streamTracker.callsStarted,streamsSucceeded:i.streamTracker.callsSucceeded,streamsFailed:i.streamTracker.callsFailed,messagesSent:i.messagesSent,messagesReceived:i.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:i.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:i.lastMessageSentTimestamp,lastMessageReceivedTimestamp:i.lastMessageReceivedTimestamp,localFlowControlWindow:(r=e.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(n=e.state.remoteWindowSize)!==null&&n!==void 0?n:null};return c}}trace(e){d.trace(o.LogVerbosity.DEBUG,S,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!=="object"||t===null||typeof t!=="object"){throw new Error("addService() requires two objects as arguments")}const r=Object.keys(e);if(r.length===0){throw new Error("Cannot add an empty service to a server")}r.forEach((r=>{const n=e[r];let i;if(n.requestStream){if(n.responseStream){i="bidi"}else{i="clientStream"}}else{if(n.responseStream){i="serverStream"}else{i="unary"}}let s=t[r];let a;if(s===undefined&&typeof n.originalName==="string"){s=t[n.originalName]}if(s!==undefined){a=s.bind(t)}else{a=getDefaultHandler(i,r)}const o=this.register(n.path,a,n.responseSerialize,n.requestDeserialize,i);if(o===false){throw new Error(`Method handler for ${n.path} already provided.`)}}))}removeService(e){if(e===null||typeof e!=="object"){throw new Error("removeService() requires object as argument")}const t=Object.keys(e);t.forEach((t=>{const r=e[t];this.unregister(r.path)}))}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}registerListenerToChannelz(e){return(0,p.registerChannelzSocket)((0,f.subchannelAddressToString)(e),(()=>({localAddress:e,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null})),this.channelzEnabled)}createHttp2Server(e){let t;if(e._isSecure()){const r=Object.assign(this.commonServerOptions,e._getSettings());r.enableTrace=this.options["grpc-node.tls_enable_trace"]===1;t=s.createSecureServer(r);t.on("secureConnection",(e=>{e.on("error",(e=>{this.trace("An incoming TLS connection closed with error: "+e.message)}))}))}else{t=s.createServer(this.commonServerOptions)}t.setTimeout(0,noop);this._setupHandlers(t);return t}bindOneAddress(e,t){this.trace("Attempting to bind "+(0,f.subchannelAddressToString)(e));const r=this.createHttp2Server(t.credentials);return new Promise(((n,i)=>{const onError=t=>{this.trace("Failed to bind "+(0,f.subchannelAddressToString)(e)+" with error "+t.message);n({port:"port"in e?e.port:1,error:t.message})};r.once("error",onError);r.listen(e,(()=>{const e=r.address();let i;if(typeof e==="string"){i={path:e}}else{i={host:e.address,port:e.port}}const s=this.registerListenerToChannelz(i);if(this.channelzEnabled){this.listenerChildrenTracker.refChild(s)}this.http2Servers.set(r,{channelzRef:s,sessions:new Set});t.listeningServers.add(r);this.trace("Successfully bound "+(0,f.subchannelAddressToString)(i));n({port:"port"in i?i.port:1});r.removeListener("error",onError)}))}))}async bindManyPorts(e,t){if(e.length===0){return{count:0,port:0,errors:[]}}if((0,f.isTcpSubchannelAddress)(e[0])&&e[0].port===0){const r=await this.bindOneAddress(e[0],t);if(r.error){const n=await this.bindManyPorts(e.slice(1),t);return Object.assign(Object.assign({},n),{errors:[r.error,...n.errors]})}else{const n=e.slice(1).map((e=>(0,f.isTcpSubchannelAddress)(e)?{host:e.host,port:r.port}:e));const i=await Promise.all(n.map((e=>this.bindOneAddress(e,t))));const s=[r,...i];return{count:s.filter((e=>e.error===undefined)).length,port:r.port,errors:s.filter((e=>e.error)).map((e=>e.error))}}}else{const r=await Promise.all(e.map((e=>this.bindOneAddress(e,t))));return{count:r.filter((e=>e.error===undefined)).length,port:r[0].port,errors:r.filter((e=>e.error)).map((e=>e.error))}}}async bindAddressList(e,t){let r;try{r=await this.bindManyPorts(e,t)}catch(e){throw e}if(r.count>0){if(r.count<e.length){d.log(o.LogVerbosity.INFO,`WARNING Only ${r.count} addresses added out of total ${e.length} resolved`)}return r.port}else{const t=`No address added out of total ${e.length} resolved`;d.log(o.LogVerbosity.ERROR,t);throw new Error(`${t} errors: [${r.errors.join(",")}]`)}}resolvePort(e){return new Promise(((t,r)=>{const n={onSuccessfulResolution:(i,s,a)=>{n.onSuccessfulResolution=()=>{};const o=[].concat(...i.map((e=>e.addresses)));if(o.length===0){r(new Error(`No addresses resolved for port ${e}`));return}t(o)},onError:e=>{r(new Error(e.details))}};const i=(0,u.createResolver)(e,n,this.options);i.updateResolution()}))}async bindPort(e,t){const r=await this.resolvePort(e);if(t.cancelled){this.completeUnbind(t);throw new Error("bindAsync operation cancelled by unbind call")}const n=await this.bindAddressList(r,t);if(t.cancelled){this.completeUnbind(t);throw new Error("bindAsync operation cancelled by unbind call")}return n}normalizePort(e){const t=(0,h.parseUri)(e);if(t===null){throw new Error(`Could not parse port "${e}"`)}const r=(0,u.mapUriDefaultScheme)(t);if(r===null){throw new Error(`Could not get a default scheme for port "${e}"`)}return r}bindAsync(e,t,r){if(this.shutdown){throw new Error("bindAsync called after shutdown")}if(typeof e!=="string"){throw new TypeError("port must be a string")}if(t===null||!(t instanceof c.ServerCredentials)){throw new TypeError("creds must be a ServerCredentials object")}if(typeof r!=="function"){throw new TypeError("callback must be a function")}this.trace("bindAsync port="+e);const n=this.normalizePort(e);const deferredCallback=(e,t)=>{process.nextTick((()=>r(e,t)))};let i=this.boundPorts.get((0,h.uriToString)(n));if(i){if(!t._equals(i.credentials)){deferredCallback(new Error(`${e} already bound with incompatible credentials`),0);return}i.cancelled=false;if(i.completionPromise){i.completionPromise.then((e=>r(null,e)),(e=>r(e,0)))}else{deferredCallback(null,i.portNumber)}return}i={mapKey:(0,h.uriToString)(n),originalUri:n,completionPromise:null,cancelled:false,portNumber:0,credentials:t,listeningServers:new Set};const s=(0,h.splitHostPort)(n.path);const a=this.bindPort(n,i);i.completionPromise=a;if((s===null||s===void 0?void 0:s.port)===0){a.then((e=>{const t={scheme:n.scheme,authority:n.authority,path:(0,h.combineHostPort)({host:s.host,port:e})};i.mapKey=(0,h.uriToString)(t);i.completionPromise=null;i.portNumber=e;this.boundPorts.set(i.mapKey,i);r(null,e)}),(e=>{r(e,0)}))}else{this.boundPorts.set(i.mapKey,i);a.then((e=>{i.completionPromise=null;i.portNumber=e;r(null,e)}),(e=>{r(e,0)}))}}closeServer(e,t){this.trace("Closing server with address "+JSON.stringify(e.address()));const r=this.http2Servers.get(e);e.close((()=>{if(this.channelzEnabled&&r){this.listenerChildrenTracker.unrefChild(r.channelzRef);(0,p.unregisterChannelzRef)(r.channelzRef)}this.http2Servers.delete(e);t===null||t===void 0?void 0:t()}))}closeSession(e,t){var r;this.trace("Closing session initiated by "+((r=e.socket)===null||r===void 0?void 0:r.remoteAddress));const n=this.sessions.get(e);const closeCallback=()=>{if(this.channelzEnabled&&n){this.sessionChildrenTracker.unrefChild(n.ref);(0,p.unregisterChannelzRef)(n.ref)}this.sessions.delete(e);t===null||t===void 0?void 0:t()};if(e.closed){process.nextTick(closeCallback)}else{e.close(closeCallback)}}completeUnbind(e){for(const t of e.listeningServers){const r=this.http2Servers.get(t);this.closeServer(t,(()=>{e.listeningServers.delete(t)}));if(r){for(const e of r.sessions){this.closeSession(e)}}}this.boundPorts.delete(e.mapKey)}unbind(e){this.trace("unbind port="+e);const t=this.normalizePort(e);const r=(0,h.splitHostPort)(t.path);if((r===null||r===void 0?void 0:r.port)===0){throw new Error("Cannot unbind port 0")}const n=this.boundPorts.get((0,h.uriToString)(t));if(n){this.trace("unbinding "+n.mapKey+" originally bound as "+(0,h.uriToString)(n.originalUri));if(n.completionPromise){n.cancelled=true}else{this.completeUnbind(n)}}}drain(e,t){var r,n;this.trace("drain port="+e+" graceTimeMs="+t);const i=this.normalizePort(e);const a=(0,h.splitHostPort)(i.path);if((a===null||a===void 0?void 0:a.port)===0){throw new Error("Cannot drain port 0")}const o=this.boundPorts.get((0,h.uriToString)(i));if(!o){return}const l=new Set;for(const e of o.listeningServers){const t=this.http2Servers.get(e);if(!t){continue}for(const e of t.sessions){l.add(e);this.closeSession(e,(()=>{l.delete(e)}))}}(n=(r=setTimeout((()=>{for(const e of l){e.destroy(s.constants.NGHTTP2_CANCEL)}}),t)).unref)===null||n===void 0?void 0:n.call(r)}forceShutdown(){for(const e of this.boundPorts.values()){e.cancelled=true}this.boundPorts.clear();for(const e of this.http2Servers.keys()){this.closeServer(e)}this.sessions.forEach(((e,t)=>{this.closeSession(t);t.destroy(s.constants.NGHTTP2_CANCEL)}));this.sessions.clear();if(this.channelzEnabled){(0,p.unregisterChannelzRef)(this.channelzRef)}this.shutdown=true}register(e,t,r,n,i){if(this.handlers.has(e)){return false}this.handlers.set(e,{func:t,serialize:r,deserialize:n,type:i,path:e});return true}unregister(e){return this.handlers.delete(e)}start(){if(this.http2Servers.size===0||[...this.http2Servers.keys()].every((e=>!e.listening))){throw new Error("server must be bound in order to start")}if(this.started===true){throw new Error("server is already started")}this.started=true}tryShutdown(e){var t;const wrappedCallback=t=>{if(this.channelzEnabled){(0,p.unregisterChannelzRef)(this.channelzRef)}e(t)};let r=0;function maybeCallback(){r--;if(r===0){wrappedCallback()}}this.shutdown=true;for(const e of this.http2Servers.keys()){r++;const t=this.http2Servers.get(e).channelzRef.name;this.trace("Waiting for server "+t+" to close");this.closeServer(e,(()=>{this.trace("Server "+t+" finished closing");maybeCallback()}))}for(const e of this.sessions.keys()){r++;const n=(t=e.socket)===null||t===void 0?void 0:t.remoteAddress;this.trace("Waiting for session "+n+" to close");this.closeSession(e,(()=>{this.trace("Session "+n+" finished closing");maybeCallback()}))}if(r===0){wrappedCallback()}}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){const r=t[s.constants.HTTP2_HEADER_CONTENT_TYPE];if(typeof r!=="string"||!r.startsWith("application/grpc")){e.respond({[s.constants.HTTP2_HEADER_STATUS]:s.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:true});return false}return true}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);const t=this.handlers.get(e);if(t===undefined){this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status.");return null}return t}_respondWithError(e,t,r=null){var n,i;const a=Object.assign({"grpc-status":(n=e.code)!==null&&n!==void 0?n:o.Status.INTERNAL,"grpc-message":e.details,[s.constants.HTTP2_HEADER_STATUS]:s.constants.HTTP_STATUS_OK,[s.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());t.respond(a,{endStream:true});if(this.channelzEnabled){this.callTracker.addCallFailed();r===null||r===void 0?void 0:r.streamTracker.addCallFailed()}}_channelzHandler(e,t){const r=this.sessions.get(e.session);this.callTracker.addCallStarted();r===null||r===void 0?void 0:r.streamTracker.addCallStarted();if(!this._verifyContentType(e,t)){this.callTracker.addCallFailed();r===null||r===void 0?void 0:r.streamTracker.addCallFailed();return}const n=t[b];const i=this._retrieveHandler(n);if(!i){this._respondWithError(getUnimplementedStatusResponse(n),e,r);return}let s={addMessageSent:()=>{if(r){r.messagesSent+=1;r.lastMessageSentTimestamp=new Date}},addMessageReceived:()=>{if(r){r.messagesReceived+=1;r.lastMessageReceivedTimestamp=new Date}},onCallEnd:e=>{if(e.code===o.Status.OK){this.callTracker.addCallSucceeded()}else{this.callTracker.addCallFailed()}},onStreamEnd:e=>{if(r){if(e){r.streamTracker.addCallSucceeded()}else{r.streamTracker.addCallFailed()}}}};const a=(0,g.getServerInterceptingCall)(this.interceptors,e,t,s,i,this.options);if(!this._runHandlerForCall(a,i)){this.callTracker.addCallFailed();r===null||r===void 0?void 0:r.streamTracker.addCallFailed();a.sendStatus({code:o.Status.INTERNAL,details:`Unknown handler type: ${i.type}`})}}_streamHandler(e,t){if(this._verifyContentType(e,t)!==true){return}const r=t[b];const n=this._retrieveHandler(r);if(!n){this._respondWithError(getUnimplementedStatusResponse(r),e,null);return}const i=(0,g.getServerInterceptingCall)(this.interceptors,e,t,null,n,this.options);if(!this._runHandlerForCall(i,n)){i.sendStatus({code:o.Status.INTERNAL,details:`Unknown handler type: ${n.type}`})}}_runHandlerForCall(e,t){const{type:r}=t;if(r==="unary"){handleUnary(e,t)}else if(r==="clientStream"){handleClientStreaming(e,t)}else if(r==="serverStream"){handleServerStreaming(e,t)}else if(r==="bidi"){handleBidiStreaming(e,t)}else{return false}return true}_setupHandlers(e){if(e===null){return}const t=e.address();let r="null";if(t){if(typeof t==="string"){r=t}else{r=t.address+":"+t.port}}this.serverAddressString=r;const n=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",n.bind(this));e.on("session",(t=>{var r,n,i,a,o,l;const c=(0,p.registerChannelzSocket)((r=t.socket.remoteAddress)!==null&&r!==void 0?r:"unknown",this.getChannelzSessionInfoGetter(t),this.channelzEnabled);const u={ref:c,streamTracker:new p.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};(n=this.http2Servers.get(e))===null||n===void 0?void 0:n.sessions.add(t);this.sessions.set(t,u);const d=t.socket.remoteAddress;if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Connection established by client "+d);this.sessionChildrenTracker.refChild(c)}let f=null;let h=null;let g=false;if(this.maxConnectionAgeMs!==m){const e=this.maxConnectionAgeMs/10;const r=Math.random()*e*2-e;f=(a=(i=setTimeout((()=>{var e,r;g=true;if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+d)}try{t.goaway(s.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch(e){t.destroy();return}t.close();if(this.maxConnectionAgeGraceMs!==m){h=(r=(e=setTimeout((()=>{t.destroy()}),this.maxConnectionAgeGraceMs)).unref)===null||r===void 0?void 0:r.call(e)}}),this.maxConnectionAgeMs+r)).unref)===null||a===void 0?void 0:a.call(i)}const v=(l=(o=setInterval((()=>{var e,r;const n=(r=(e=setTimeout((()=>{g=true;if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+d)}t.close()}),this.keepaliveTimeoutMs)).unref)===null||r===void 0?void 0:r.call(e);try{t.ping(((e,t,r)=>{clearTimeout(n)}))}catch(e){t.destroy()}}),this.keepaliveTimeMs)).unref)===null||l===void 0?void 0:l.call(o);t.on("close",(()=>{var r;if(this.channelzEnabled){if(!g){this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+d)}this.sessionChildrenTracker.unrefChild(c);(0,p.unregisterChannelzRef)(c)}if(f){clearTimeout(f)}if(h){clearTimeout(h)}if(v){clearTimeout(v)}(r=this.http2Servers.get(e))===null||r===void 0?void 0:r.sessions.delete(t);this.sessions.delete(t)}))}))}},(()=>{const n=typeof Symbol==="function"&&Symbol.metadata?Object.create(null):void 0;r=[deprecate("Calling start() is no longer necessary. It can be safely omitted.")];i(e,null,r,{kind:"method",name:"start",static:false,private:false,access:{has:e=>"start"in e,get:e=>e.start},metadata:n},null,t);if(n)Object.defineProperty(e,Symbol.metadata,{enumerable:true,configurable:true,writable:true,value:n})})(),e})();t.Server=_;async function handleUnary(e,t){let r;function respond(t,r,n,i){if(t){e.sendStatus((0,l.serverErrorToStatus)(t,n));return}e.sendMessage(r,(()=>{e.sendStatus({code:o.Status.OK,details:"OK",metadata:n!==null&&n!==void 0?n:null})}))}let n;let i=null;e.start({onReceiveMetadata(t){n=t;e.startRead()},onReceiveMessage(r){if(i){e.sendStatus({code:o.Status.UNIMPLEMENTED,details:`Received a second request message for server streaming method ${t.path}`,metadata:null});return}i=r;e.startRead()},onReceiveHalfClose(){if(!i){e.sendStatus({code:o.Status.UNIMPLEMENTED,details:`Received no request message for server streaming method ${t.path}`,metadata:null});return}r=new l.ServerWritableStreamImpl(t.path,e,n,i);try{t.func(r,respond)}catch(t){e.sendStatus({code:o.Status.UNKNOWN,details:`Server method handler threw error ${t.message}`,metadata:null})}},onCancel(){if(r){r.cancelled=true;r.emit("cancelled","cancelled")}}})}function handleClientStreaming(e,t){let r;function respond(t,r,n,i){if(t){e.sendStatus((0,l.serverErrorToStatus)(t,n));return}e.sendMessage(r,(()=>{e.sendStatus({code:o.Status.OK,details:"OK",metadata:n!==null&&n!==void 0?n:null})}))}e.start({onReceiveMetadata(n){r=new l.ServerDuplexStreamImpl(t.path,e,n);try{t.func(r,respond)}catch(t){e.sendStatus({code:o.Status.UNKNOWN,details:`Server method handler threw error ${t.message}`,metadata:null})}},onReceiveMessage(e){r.push(e)},onReceiveHalfClose(){r.push(null)},onCancel(){if(r){r.cancelled=true;r.emit("cancelled","cancelled");r.destroy()}}})}function handleServerStreaming(e,t){let r;let n;let i=null;e.start({onReceiveMetadata(t){n=t;e.startRead()},onReceiveMessage(r){if(i){e.sendStatus({code:o.Status.UNIMPLEMENTED,details:`Received a second request message for server streaming method ${t.path}`,metadata:null});return}i=r;e.startRead()},onReceiveHalfClose(){if(!i){e.sendStatus({code:o.Status.UNIMPLEMENTED,details:`Received no request message for server streaming method ${t.path}`,metadata:null});return}r=new l.ServerWritableStreamImpl(t.path,e,n,i);try{t.func(r)}catch(t){e.sendStatus({code:o.Status.UNKNOWN,details:`Server method handler threw error ${t.message}`,metadata:null})}},onCancel(){if(r){r.cancelled=true;r.emit("cancelled","cancelled");r.destroy()}}})}function handleBidiStreaming(e,t){let r;e.start({onReceiveMetadata(n){r=new l.ServerDuplexStreamImpl(t.path,e,n);try{t.func(r)}catch(t){e.sendStatus({code:o.Status.UNKNOWN,details:`Server method handler threw error ${t.message}`,metadata:null})}},onReceiveMessage(e){r.push(e)},onReceiveHalfClose(){r.push(null)},onCancel(){if(r){r.cancelled=true;r.emit("cancelled","cancelled");r.destroy()}}})}},1761:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.extractAndSelectServiceConfig=t.validateServiceConfig=t.validateRetryThrottling=void 0;const n=r(2037);const i=r(634);const s=/^\d+(\.\d{1,9})?s$/;const a="node";function validateName(e){if("service"in e&&e.service!==""){if(typeof e.service!=="string"){throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof e.service}`)}if("method"in e&&e.method!==""){if(typeof e.method!=="string"){throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof e.service}`)}return{service:e.service,method:e.method}}else{return{service:e.service}}}else{if("method"in e&&e.method!==undefined){throw new Error(`Invalid method config name: method set with empty or unset service`)}return{}}}function validateRetryPolicy(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2){throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2")}if(!("initialBackoff"in e)||typeof e.initialBackoff!=="string"||!s.test(e.initialBackoff)){throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s")}if(!("maxBackoff"in e)||typeof e.maxBackoff!=="string"||!s.test(e.maxBackoff)){throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s")}if(!("backoffMultiplier"in e)||typeof e.backoffMultiplier!=="number"||e.backoffMultiplier<=0){throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0")}if(!("retryableStatusCodes"in e&&Array.isArray(e.retryableStatusCodes))){throw new Error("Invalid method config retry policy: retryableStatusCodes is required")}if(e.retryableStatusCodes.length===0){throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty")}for(const t of e.retryableStatusCodes){if(typeof t==="number"){if(!Object.values(i.Status).includes(t)){throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}}else if(typeof t==="string"){if(!Object.values(i.Status).includes(t.toUpperCase())){throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}}else{throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number")}}return{maxAttempts:e.maxAttempts,initialBackoff:e.initialBackoff,maxBackoff:e.maxBackoff,backoffMultiplier:e.backoffMultiplier,retryableStatusCodes:e.retryableStatusCodes}}function validateHedgingPolicy(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2){throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2")}if("hedgingDelay"in e&&(typeof e.hedgingDelay!=="string"||!s.test(e.hedgingDelay))){throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s")}if("nonFatalStatusCodes"in e&&Array.isArray(e.nonFatalStatusCodes)){for(const t of e.nonFatalStatusCodes){if(typeof t==="number"){if(!Object.values(i.Status).includes(t)){throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}}else if(typeof t==="string"){if(!Object.values(i.Status).includes(t.toUpperCase())){throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}}else{throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number")}}}const t={maxAttempts:e.maxAttempts};if(e.hedgingDelay){t.hedgingDelay=e.hedgingDelay}if(e.nonFatalStatusCodes){t.nonFatalStatusCodes=e.nonFatalStatusCodes}return t}function validateMethodConfig(e){var t;const r={name:[]};if(!("name"in e)||!Array.isArray(e.name)){throw new Error("Invalid method config: invalid name array")}for(const t of e.name){r.name.push(validateName(t))}if("waitForReady"in e){if(typeof e.waitForReady!=="boolean"){throw new Error("Invalid method config: invalid waitForReady")}r.waitForReady=e.waitForReady}if("timeout"in e){if(typeof e.timeout==="object"){if(!("seconds"in e.timeout)||!(typeof e.timeout.seconds==="number")){throw new Error("Invalid method config: invalid timeout.seconds")}if(!("nanos"in e.timeout)||!(typeof e.timeout.nanos==="number")){throw new Error("Invalid method config: invalid timeout.nanos")}r.timeout=e.timeout}else if(typeof e.timeout==="string"&&s.test(e.timeout)){const n=e.timeout.substring(0,e.timeout.length-1).split(".");r.timeout={seconds:n[0]|0,nanos:((t=n[1])!==null&&t!==void 0?t:0)|0}}else{throw new Error("Invalid method config: invalid timeout")}}if("maxRequestBytes"in e){if(typeof e.maxRequestBytes!=="number"){throw new Error("Invalid method config: invalid maxRequestBytes")}r.maxRequestBytes=e.maxRequestBytes}if("maxResponseBytes"in e){if(typeof e.maxResponseBytes!=="number"){throw new Error("Invalid method config: invalid maxRequestBytes")}r.maxResponseBytes=e.maxResponseBytes}if("retryPolicy"in e){if("hedgingPolicy"in e){throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified")}else{r.retryPolicy=validateRetryPolicy(e.retryPolicy)}}else if("hedgingPolicy"in e){r.hedgingPolicy=validateHedgingPolicy(e.hedgingPolicy)}return r}function validateRetryThrottling(e){if(!("maxTokens"in e)||typeof e.maxTokens!=="number"||e.maxTokens<=0||e.maxTokens>1e3){throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]")}if(!("tokenRatio"in e)||typeof e.tokenRatio!=="number"||e.tokenRatio<=0){throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0")}return{maxTokens:+e.maxTokens.toFixed(3),tokenRatio:+e.tokenRatio.toFixed(3)}}t.validateRetryThrottling=validateRetryThrottling;function validateLoadBalancingConfig(e){if(!(typeof e==="object"&&e!==null)){throw new Error(`Invalid loadBalancingConfig: unexpected type ${typeof e}`)}const t=Object.keys(e);if(t.length>1){throw new Error(`Invalid loadBalancingConfig: unexpected multiple keys ${t}`)}if(t.length===0){throw new Error("Invalid loadBalancingConfig: load balancing policy name required")}return{[t[0]]:e[t[0]]}}function validateServiceConfig(e){const t={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in e){if(typeof e.loadBalancingPolicy==="string"){t.loadBalancingPolicy=e.loadBalancingPolicy}else{throw new Error("Invalid service config: invalid loadBalancingPolicy")}}if("loadBalancingConfig"in e){if(Array.isArray(e.loadBalancingConfig)){for(const r of e.loadBalancingConfig){t.loadBalancingConfig.push(validateLoadBalancingConfig(r))}}else{throw new Error("Invalid service config: invalid loadBalancingConfig")}}if("methodConfig"in e){if(Array.isArray(e.methodConfig)){for(const r of e.methodConfig){t.methodConfig.push(validateMethodConfig(r))}}}if("retryThrottling"in e){t.retryThrottling=validateRetryThrottling(e.retryThrottling)}const r=[];for(const e of t.methodConfig){for(const t of e.name){for(const e of r){if(t.service===e.service&&t.method===e.method){throw new Error(`Invalid service config: duplicate name ${t.service}/${t.method}`)}}r.push(t)}}return t}t.validateServiceConfig=validateServiceConfig;function validateCanaryConfig(e){if(!("serviceConfig"in e)){throw new Error("Invalid service config choice: missing service config")}const t={serviceConfig:validateServiceConfig(e.serviceConfig)};if("clientLanguage"in e){if(Array.isArray(e.clientLanguage)){t.clientLanguage=[];for(const r of e.clientLanguage){if(typeof r==="string"){t.clientLanguage.push(r)}else{throw new Error("Invalid service config choice: invalid clientLanguage")}}}else{throw new Error("Invalid service config choice: invalid clientLanguage")}}if("clientHostname"in e){if(Array.isArray(e.clientHostname)){t.clientHostname=[];for(const r of e.clientHostname){if(typeof r==="string"){t.clientHostname.push(r)}else{throw new Error("Invalid service config choice: invalid clientHostname")}}}else{throw new Error("Invalid service config choice: invalid clientHostname")}}if("percentage"in e){if(typeof e.percentage==="number"&&0<=e.percentage&&e.percentage<=100){t.percentage=e.percentage}else{throw new Error("Invalid service config choice: invalid percentage")}}const r=["clientLanguage","percentage","clientHostname","serviceConfig"];for(const t in e){if(!r.includes(t)){throw new Error(`Invalid service config choice: unexpected field ${t}`)}}return t}function validateAndSelectCanaryConfig(e,t){if(!Array.isArray(e)){throw new Error("Invalid service config list")}for(const r of e){const e=validateCanaryConfig(r);if(typeof e.percentage==="number"&&t>e.percentage){continue}if(Array.isArray(e.clientHostname)){let t=false;for(const r of e.clientHostname){if(r===n.hostname()){t=true}}if(!t){continue}}if(Array.isArray(e.clientLanguage)){let t=false;for(const r of e.clientLanguage){if(r===a){t=true}}if(!t){continue}}return e.serviceConfig}throw new Error("No matching service config found")}function extractAndSelectServiceConfig(e,t){for(const r of e){if(r.length>0&&r[0].startsWith("grpc_config=")){const e=r.join("").substring("grpc_config=".length);const n=JSON.parse(e);return validateAndSelectCanaryConfig(n,t)}}return null}t.extractAndSelectServiceConfig=extractAndSelectServiceConfig},3155:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.StatusBuilder=void 0;class StatusBuilder{constructor(){this.code=null;this.details=null;this.metadata=null}withCode(e){this.code=e;return this}withDetails(e){this.details=e;return this}withMetadata(e){this.metadata=e;return this}build(){const e={};if(this.code!==null){e.code=this.code}if(this.details!==null){e.details=this.details}if(this.metadata!==null){e.metadata=this.metadata}return e}}t.StatusBuilder=StatusBuilder},6575:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.StreamDecoder=void 0;var r;(function(e){e[e["NO_DATA"]=0]="NO_DATA";e[e["READING_SIZE"]=1]="READING_SIZE";e[e["READING_MESSAGE"]=2]="READING_MESSAGE"})(r||(r={}));class StreamDecoder{constructor(){this.readState=r.NO_DATA;this.readCompressFlag=Buffer.alloc(1);this.readPartialSize=Buffer.alloc(4);this.readSizeRemaining=4;this.readMessageSize=0;this.readPartialMessage=[];this.readMessageRemaining=0}write(e){let t=0;let n;const i=[];while(t<e.length){switch(this.readState){case r.NO_DATA:this.readCompressFlag=e.slice(t,t+1);t+=1;this.readState=r.READING_SIZE;this.readPartialSize.fill(0);this.readSizeRemaining=4;this.readMessageSize=0;this.readMessageRemaining=0;this.readPartialMessage=[];break;case r.READING_SIZE:n=Math.min(e.length-t,this.readSizeRemaining);e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+n);this.readSizeRemaining-=n;t+=n;if(this.readSizeRemaining===0){this.readMessageSize=this.readPartialSize.readUInt32BE(0);this.readMessageRemaining=this.readMessageSize;if(this.readMessageRemaining>0){this.readState=r.READING_MESSAGE}else{const e=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=r.NO_DATA;i.push(e)}}break;case r.READING_MESSAGE:n=Math.min(e.length-t,this.readMessageRemaining);this.readPartialMessage.push(e.slice(t,t+n));this.readMessageRemaining-=n;t+=n;if(this.readMessageRemaining===0){const e=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage);const t=Buffer.concat(e,this.readMessageSize+5);this.readState=r.NO_DATA;i.push(t)}break;default:throw new Error("Unexpected read state")}}return i}}t.StreamDecoder=StreamDecoder},9905:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.EndpointMap=t.endpointHasAddress=t.endpointToString=t.endpointEqual=t.stringToSubchannelAddress=t.subchannelAddressToString=t.subchannelAddressEqual=t.isTcpSubchannelAddress=void 0;const n=r(1808);function isTcpSubchannelAddress(e){return"port"in e}t.isTcpSubchannelAddress=isTcpSubchannelAddress;function subchannelAddressEqual(e,t){if(!e&&!t){return true}if(!e||!t){return false}if(isTcpSubchannelAddress(e)){return isTcpSubchannelAddress(t)&&e.host===t.host&&e.port===t.port}else{return!isTcpSubchannelAddress(t)&&e.path===t.path}}t.subchannelAddressEqual=subchannelAddressEqual;function subchannelAddressToString(e){if(isTcpSubchannelAddress(e)){return e.host+":"+e.port}else{return e.path}}t.subchannelAddressToString=subchannelAddressToString;const i=443;function stringToSubchannelAddress(e,t){if((0,n.isIP)(e)){return{host:e,port:t!==null&&t!==void 0?t:i}}else{return{path:e}}}t.stringToSubchannelAddress=stringToSubchannelAddress;function endpointEqual(e,t){if(e.addresses.length!==t.addresses.length){return false}for(let r=0;r<e.addresses.length;r++){if(!subchannelAddressEqual(e.addresses[r],t.addresses[r])){return false}}return true}t.endpointEqual=endpointEqual;function endpointToString(e){return"["+e.addresses.map(subchannelAddressToString).join(", ")+"]"}t.endpointToString=endpointToString;function endpointHasAddress(e,t){for(const r of e.addresses){if(subchannelAddressEqual(r,t)){return true}}return false}t.endpointHasAddress=endpointHasAddress;function endpointEqualUnordered(e,t){if(e.addresses.length!==t.addresses.length){return false}for(const r of e.addresses){let e=false;for(const n of t.addresses){if(subchannelAddressEqual(r,n)){e=true;break}}if(!e){return false}}return true}class EndpointMap{constructor(){this.map=new Set}get size(){return this.map.size}getForSubchannelAddress(e){for(const t of this.map){if(endpointHasAddress(t.key,e)){return t.value}}return undefined}deleteMissing(e){const t=[];for(const r of this.map){let n=false;for(const t of e){if(endpointEqualUnordered(t,r.key)){n=true}}if(!n){t.push(r.value);this.map.delete(r)}}return t}get(e){for(const t of this.map){if(endpointEqualUnordered(e,t.key)){return t.value}}return undefined}set(e,t){for(const r of this.map){if(endpointEqualUnordered(e,r.key)){r.value=t;return}}this.map.add({key:e,value:t})}delete(e){for(const t of this.map){if(endpointEqualUnordered(e,t.key)){this.map.delete(t);return}}}has(e){for(const t of this.map){if(endpointEqualUnordered(e,t.key)){return true}}return false}clear(){this.map.clear()}*keys(){for(const e of this.map){yield e.key}}*values(){for(const e of this.map){yield e.value}}*entries(){for(const e of this.map){yield[e.key,e.value]}}}t.EndpointMap=EndpointMap},6940:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.Http2SubchannelCall=void 0;const n=r(5158);const i=r(2037);const s=r(634);const a=r(3665);const o=r(6575);const l=r(5993);const c=r(634);const u="subchannel_call";function getSystemErrorName(e){for(const[t,r]of Object.entries(i.constants.errno)){if(r===e){return t}}return"Unknown system error "+e}class Http2SubchannelCall{constructor(e,t,r,i,l){this.http2Stream=e;this.callEventTracker=t;this.listener=r;this.transport=i;this.callId=l;this.decoder=new o.StreamDecoder;this.isReadFilterPending=false;this.isPushPending=false;this.canPush=false;this.readsClosed=false;this.statusOutput=false;this.unpushedReadMessages=[];this.mappedStatusCode=s.Status.UNKNOWN;this.finalStatus=null;this.internalError=null;e.on("response",((e,t)=>{let r="";for(const t of Object.keys(e)){r+="\t\t"+t+": "+e[t]+"\n"}this.trace("Received server headers:\n"+r);switch(e[":status"]){case 400:this.mappedStatusCode=s.Status.INTERNAL;break;case 401:this.mappedStatusCode=s.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=s.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=s.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=s.Status.UNAVAILABLE;break;default:this.mappedStatusCode=s.Status.UNKNOWN}if(t&n.constants.NGHTTP2_FLAG_END_STREAM){this.handleTrailers(e)}else{let t;try{t=a.Metadata.fromHttp2Headers(e)}catch(e){this.endCall({code:s.Status.UNKNOWN,details:e.message,metadata:new a.Metadata});return}this.listener.onReceiveMetadata(t)}}));e.on("trailers",(e=>{this.handleTrailers(e)}));e.on("data",(e=>{if(this.statusOutput){return}this.trace("receive HTTP/2 data frame of length "+e.length);const t=this.decoder.write(e);for(const e of t){this.trace("parsed message of length "+e.length);this.callEventTracker.addMessageReceived();this.tryPush(e)}}));e.on("end",(()=>{this.readsClosed=true;this.maybeOutputStatus()}));e.on("close",(()=>{process.nextTick((()=>{var t;this.trace("HTTP/2 stream closed with code "+e.rstCode);if(((t=this.finalStatus)===null||t===void 0?void 0:t.code)===s.Status.OK){return}let r;let i="";switch(e.rstCode){case n.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null){return}r=s.Status.INTERNAL;i=`Received RST_STREAM with code ${e.rstCode}`;break;case n.constants.NGHTTP2_REFUSED_STREAM:r=s.Status.UNAVAILABLE;i="Stream refused by server";break;case n.constants.NGHTTP2_CANCEL:r=s.Status.CANCELLED;i="Call cancelled";break;case n.constants.NGHTTP2_ENHANCE_YOUR_CALM:r=s.Status.RESOURCE_EXHAUSTED;i="Bandwidth exhausted or memory limit exceeded";break;case n.constants.NGHTTP2_INADEQUATE_SECURITY:r=s.Status.PERMISSION_DENIED;i="Protocol not secure enough";break;case n.constants.NGHTTP2_INTERNAL_ERROR:r=s.Status.INTERNAL;if(this.internalError===null){i=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`}else{if(this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"){r=s.Status.UNAVAILABLE;i=this.internalError.message}else{i=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`}}break;default:r=s.Status.INTERNAL;i=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:r,details:i,metadata:new a.Metadata,rstCode:e.rstCode})}))}));e.on("error",(e=>{if(e.code!=="ERR_HTTP2_STREAM_ERROR"){this.trace("Node error event: message="+e.message+" code="+e.code+" errno="+getSystemErrorName(e.errno)+" syscall="+e.syscall);this.internalError=e}this.callEventTracker.onStreamEnd(false)}))}onDisconnect(){this.endCall({code:s.Status.UNAVAILABLE,details:"Connection dropped",metadata:new a.Metadata})}outputStatus(){if(!this.statusOutput){this.statusOutput=true;this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"');this.callEventTracker.onCallEnd(this.finalStatus);process.nextTick((()=>{this.listener.onReceiveStatus(this.finalStatus)}));this.http2Stream.resume()}}trace(e){l.trace(c.LogVerbosity.DEBUG,u,"["+this.callId+"] "+e)}endCall(e){if(this.finalStatus===null||this.finalStatus.code===s.Status.OK){this.finalStatus=e;this.maybeOutputStatus()}this.destroyHttp2Stream()}maybeOutputStatus(){if(this.finalStatus!==null){if(this.finalStatus.code!==s.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending){this.outputStatus()}}}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null));this.canPush=false;this.isPushPending=true;process.nextTick((()=>{this.isPushPending=false;if(this.statusOutput){return}this.listener.onReceiveMessage(e);this.maybeOutputStatus()}))}tryPush(e){if(this.canPush){this.http2Stream.pause();this.push(e)}else{this.trace("unpushedReadMessages.push message of length "+e.length);this.unpushedReadMessages.push(e)}}handleTrailers(e){this.callEventTracker.onStreamEnd(true);let t="";for(const r of Object.keys(e)){t+="\t\t"+r+": "+e[r]+"\n"}this.trace("Received server trailers:\n"+t);let r;try{r=a.Metadata.fromHttp2Headers(e)}catch(e){r=new a.Metadata}const n=r.getMap();let i=this.mappedStatusCode;if(i===s.Status.UNKNOWN&&typeof n["grpc-status"]==="string"){const e=Number(n["grpc-status"]);if(e in s.Status){i=e;this.trace("received status code "+e+" from server")}r.remove("grpc-status")}let o="";if(typeof n["grpc-message"]==="string"){try{o=decodeURI(n["grpc-message"])}catch(e){o=n["grpc-message"]}r.remove("grpc-message");this.trace('received status details string "'+o+'" from server')}const l={code:i,details:o,metadata:r};this.endCall(l)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;if(((e=this.finalStatus)===null||e===void 0?void 0:e.code)===s.Status.OK){t=n.constants.NGHTTP2_NO_ERROR}else{t=n.constants.NGHTTP2_CANCEL}this.trace("close http2 stream with code "+t);this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"');this.endCall({code:e,details:t,metadata:new a.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==s.Status.OK){this.readsClosed=true;this.maybeOutputStatus();return}this.canPush=true;if(this.unpushedReadMessages.length>0){const e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);const cb=t=>{process.nextTick((()=>{var r;let n=s.Status.UNAVAILABLE;if((t===null||t===void 0?void 0:t.code)==="ERR_STREAM_WRITE_AFTER_END"){n=s.Status.INTERNAL}if(t){this.cancelWithStatus(n,`Write error: ${t.message}`)}(r=e.callback)===null||r===void 0?void 0:r.call(e)}))};this.trace("sending data chunk of length "+t.length);this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,cb)}catch(e){this.endCall({code:s.Status.UNAVAILABLE,details:`Write failed with error ${e.message}`,metadata:new a.Metadata})}}halfClose(){this.trace("end() called");this.trace("calling end() on HTTP/2 stream");this.http2Stream.end()}}t.Http2SubchannelCall=Http2SubchannelCall},2258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.BaseSubchannelWrapper=void 0;class BaseSubchannelWrapper{constructor(e){this.child=e;this.healthy=true;this.healthListeners=new Set;e.addHealthStateWatcher((e=>{if(this.healthy){this.updateHealthListeners()}}))}updateHealthListeners(){for(const e of this.healthListeners){e(this.isHealthy())}}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}isHealthy(){return this.healthy&&this.child.isHealthy()}addHealthStateWatcher(e){this.healthListeners.add(e)}removeHealthStateWatcher(e){this.healthListeners.delete(e)}setHealthy(e){if(e!==this.healthy){this.healthy=e;if(this.child.isHealthy()){this.updateHealthListeners()}}}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}}t.BaseSubchannelWrapper=BaseSubchannelWrapper},9780:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.getSubchannelPool=t.SubchannelPool=void 0;const n=r(9810);const i=r(4764);const s=r(9905);const a=r(5974);const o=r(6690);const l=1e4;class SubchannelPool{constructor(){this.pool=Object.create(null);this.cleanupTimer=null}unrefUnusedSubchannels(){let e=true;for(const t in this.pool){const r=this.pool[t];const n=r.filter((e=>!e.subchannel.unrefIfOneRef()));if(n.length>0){e=false}this.pool[t]=n}if(e&&this.cleanupTimer!==null){clearInterval(this.cleanupTimer);this.cleanupTimer=null}}ensureCleanupTask(){var e,t;if(this.cleanupTimer===null){this.cleanupTimer=setInterval((()=>{this.unrefUnusedSubchannels()}),l);(t=(e=this.cleanupTimer).unref)===null||t===void 0?void 0:t.call(e)}}getOrCreateSubchannel(e,t,r,l){this.ensureCleanupTask();const c=(0,a.uriToString)(e);if(c in this.pool){const e=this.pool[c];for(const i of e){if((0,s.subchannelAddressEqual)(t,i.subchannelAddress)&&(0,n.channelOptionsEqual)(r,i.channelArguments)&&l._equals(i.channelCredentials)){return i.subchannel}}}const u=new i.Subchannel(e,t,r,l,new o.Http2SubchannelConnector(e));if(!(c in this.pool)){this.pool[c]=[]}this.pool[c].push({subchannelAddress:t,channelArguments:r,channelCredentials:l,subchannel:u});u.ref();return u}}t.SubchannelPool=SubchannelPool;const c=new SubchannelPool;function getSubchannelPool(e){if(e){return c}else{return new SubchannelPool}}t.getSubchannelPool=getSubchannelPool},4764:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.Subchannel=void 0;const n=r(878);const i=r(4186);const s=r(5993);const a=r(634);const o=r(5974);const l=r(9905);const c=r(9975);const u="subchannel";const d=~(1<<31);class Subchannel{constructor(e,t,r,s,a){var o;this.channelTarget=e;this.subchannelAddress=t;this.options=r;this.credentials=s;this.connector=a;this.connectivityState=n.ConnectivityState.IDLE;this.transport=null;this.continueConnecting=false;this.stateListeners=new Set;this.refcount=0;this.channelzEnabled=true;this.callTracker=new c.ChannelzCallTracker;this.childrenTracker=new c.ChannelzChildrenTracker;this.streamTracker=new c.ChannelzCallTracker;const u={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new i.BackoffTimeout((()=>{this.handleBackoffTimer()}),u);this.backoffTimeout.unref();this.subchannelAddressString=(0,l.subchannelAddressToString)(t);this.keepaliveTime=(o=r["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1;if(r["grpc.enable_channelz"]===0){this.channelzEnabled=false}this.channelzTrace=new c.ChannelzTrace;this.channelzRef=(0,c.registerChannelzSubchannel)(this.subchannelAddressString,(()=>this.getChannelzInfo()),this.channelzEnabled);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Subchannel created")}this.trace("Subchannel constructed with options "+JSON.stringify(r,undefined,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){s.trace(a.LogVerbosity.DEBUG,u,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){s.trace(a.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){if(this.continueConnecting){this.transitionToState([n.ConnectivityState.TRANSIENT_FAILURE],n.ConnectivityState.CONNECTING)}else{this.transitionToState([n.ConnectivityState.TRANSIENT_FAILURE],n.ConnectivityState.IDLE)}}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop();this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){const t=Math.min(this.keepaliveTime,d);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then((e=>{if(this.transitionToState([n.ConnectivityState.CONNECTING],n.ConnectivityState.READY)){this.transport=e;if(this.channelzEnabled){this.childrenTracker.refChild(e.getChannelzRef())}e.addDisconnectListener((e=>{this.transitionToState([n.ConnectivityState.READY],n.ConnectivityState.IDLE);if(e&&this.keepaliveTime>0){this.keepaliveTime*=2;s.log(a.LogVerbosity.ERROR,`Connection to ${(0,o.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`)}}))}else{e.shutdown()}}),(e=>{this.transitionToState([n.ConnectivityState.CONNECTING],n.ConnectivityState.TRANSIENT_FAILURE,`${e}`)}))}transitionToState(e,t,r){var i,s;if(e.indexOf(this.connectivityState)===-1){return false}this.trace(n.ConnectivityState[this.connectivityState]+" -> "+n.ConnectivityState[t]);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+n.ConnectivityState[t])}const a=this.connectivityState;this.connectivityState=t;switch(t){case n.ConnectivityState.READY:this.stopBackoff();break;case n.ConnectivityState.CONNECTING:this.startBackoff();this.startConnectingInternal();this.continueConnecting=false;break;case n.ConnectivityState.TRANSIENT_FAILURE:if(this.channelzEnabled&&this.transport){this.childrenTracker.unrefChild(this.transport.getChannelzRef())}(i=this.transport)===null||i===void 0?void 0:i.shutdown();this.transport=null;if(!this.backoffTimeout.isRunning()){process.nextTick((()=>{this.handleBackoffTimer()}))}break;case n.ConnectivityState.IDLE:if(this.channelzEnabled&&this.transport){this.childrenTracker.unrefChild(this.transport.getChannelzRef())}(s=this.transport)===null||s===void 0?void 0:s.shutdown();this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(const e of this.stateListeners){e(this,a,t,this.keepaliveTime,r)}return true}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1));this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1));this.refcount-=1;if(this.refcount===0){if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Shutting down")}if(this.channelzEnabled){(0,c.unregisterChannelzRef)(this.channelzRef)}process.nextTick((()=>{this.transitionToState([n.ConnectivityState.CONNECTING,n.ConnectivityState.READY],n.ConnectivityState.IDLE)}))}}unrefIfOneRef(){if(this.refcount===1){this.unref();return true}return false}createCall(e,t,r,n){if(!this.transport){throw new Error("Cannot create call, subchannel not READY")}let i;if(this.channelzEnabled){this.callTracker.addCallStarted();this.streamTracker.addCallStarted();i={onCallEnd:e=>{if(e.code===a.Status.OK){this.callTracker.addCallSucceeded()}else{this.callTracker.addCallFailed()}}}}else{i={}}return this.transport.createCall(e,t,r,n,i)}startConnecting(){process.nextTick((()=>{if(!this.transitionToState([n.ConnectivityState.IDLE],n.ConnectivityState.CONNECTING)){if(this.connectivityState===n.ConnectivityState.TRANSIENT_FAILURE){this.continueConnecting=true}}}))}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick((()=>{this.backoffTimeout.reset();this.transitionToState([n.ConnectivityState.TRANSIENT_FAILURE],n.ConnectivityState.CONNECTING)}))}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}isHealthy(){return true}addHealthStateWatcher(e){}removeHealthStateWatcher(e){}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e}}}t.Subchannel=Subchannel},6581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.getDefaultRootsData=t.CIPHER_SUITES=void 0;const n=r(7147);t.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;const i=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH;let s=null;function getDefaultRootsData(){if(i){if(s===null){s=n.readFileSync(i)}return s}return null}t.getDefaultRootsData=getDefaultRootsData},6690:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.Http2SubchannelConnector=void 0;const n=r(5158);const i=r(4404);const s=r(9975);const a=r(634);const o=r(4e3);const l=r(5993);const c=r(1594);const u=r(9905);const d=r(5974);const f=r(1808);const h=r(6940);const p=r(380);const g="transport";const m="transport_flowctrl";const v=r(6569).i8;const{HTTP2_HEADER_AUTHORITY:y,HTTP2_HEADER_CONTENT_TYPE:b,HTTP2_HEADER_METHOD:S,HTTP2_HEADER_PATH:_,HTTP2_HEADER_TE:w,HTTP2_HEADER_USER_AGENT:C}=n.constants;const E=2e4;const T=Buffer.from("too_many_pings","ascii");class Http2Transport{constructor(e,t,r,i){this.session=e;this.remoteName=i;this.keepaliveTimeMs=-1;this.keepaliveTimeoutMs=E;this.keepaliveTimerId=null;this.pendingSendKeepalivePing=false;this.keepaliveTimeoutId=null;this.keepaliveWithoutCalls=false;this.activeCalls=new Set;this.disconnectListeners=[];this.disconnectHandled=false;this.channelzEnabled=true;this.streamTracker=new s.ChannelzCallTracker;this.keepalivesSent=0;this.messagesSent=0;this.messagesReceived=0;this.lastMessageSentTimestamp=null;this.lastMessageReceivedTimestamp=null;this.subchannelAddressString=(0,u.subchannelAddressToString)(t);if(r["grpc.enable_channelz"]===0){this.channelzEnabled=false}this.channelzRef=(0,s.registerChannelzSocket)(this.subchannelAddressString,(()=>this.getChannelzInfo()),this.channelzEnabled);this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${v}`,r["grpc.secondary_user_agent"]].filter((e=>e)).join(" ");if("grpc.keepalive_time_ms"in r){this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]}if("grpc.keepalive_timeout_ms"in r){this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]}if("grpc.keepalive_permit_without_calls"in r){this.keepaliveWithoutCalls=r["grpc.keepalive_permit_without_calls"]===1}else{this.keepaliveWithoutCalls=false}e.once("close",(()=>{this.trace("session closed");this.stopKeepalivePings();this.handleDisconnect()}));e.once("goaway",((e,t,r)=>{let i=false;if(e===n.constants.NGHTTP2_ENHANCE_YOUR_CALM&&r&&r.equals(T)){i=true}this.trace("connection closed by GOAWAY with code "+e+" and data "+(r===null||r===void 0?void 0:r.toString()));this.reportDisconnectToOwner(i)}));e.once("error",(e=>{this.trace("connection closed with error "+e.message)}));if(l.isTracerEnabled(g)){e.on("remoteSettings",(t=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))}));e.on("localSettings",(t=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))}))}if(this.keepaliveWithoutCalls){this.maybeStartKeepalivePingTimer()}}getChannelzInfo(){var e,t,r;const n=this.session.socket;const i=n.remoteAddress?(0,u.stringToSubchannelAddress)(n.remoteAddress,n.remotePort):null;const s=n.localAddress?(0,u.stringToSubchannelAddress)(n.localAddress,n.localPort):null;let a;if(this.session.encrypted){const t=n;const r=t.getCipher();const i=t.getCertificate();const s=t.getPeerCertificate();a={cipherSuiteStandardName:(e=r.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:r.standardName?null:r.name,localCertificate:i&&"raw"in i?i.raw:null,remoteCertificate:s&&"raw"in s?s.raw:null}}else{a=null}const o={remoteAddress:i,localAddress:s,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(r=this.session.state.remoteWindowSize)!==null&&r!==void 0?r:null};return o}trace(e){l.trace(a.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){l.trace(a.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){l.trace(a.LogVerbosity.DEBUG,m,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){l.trace(a.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){if(this.disconnectHandled){return}this.disconnectHandled=true;this.disconnectListeners.forEach((t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(false);setImmediate((()=>{for(const e of this.activeCalls){e.onDisconnect()}}))}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){if(!this.keepaliveTimerId){return}clearTimeout(this.keepaliveTimerId);this.keepaliveTimerId=null}clearKeepaliveTimeout(){if(!this.keepaliveTimeoutId){return}clearTimeout(this.keepaliveTimeoutId);this.keepaliveTimeoutId=null}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;this.clearKeepaliveTimer();if(!this.canSendPing()){this.pendingSendKeepalivePing=true;return}if(this.channelzEnabled){this.keepalivesSent+=1}this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms");if(!this.keepaliveTimeoutId){this.keepaliveTimeoutId=setTimeout((()=>{this.keepaliveTrace("Ping timeout passed without response");this.handleDisconnect()}),this.keepaliveTimeoutMs);(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0?void 0:t.call(e)}try{this.session.ping(((e,t,r)=>{if(e){this.keepaliveTrace("Ping failed with error "+e.message);this.handleDisconnect()}this.keepaliveTrace("Received ping response");this.clearKeepaliveTimeout();this.maybeStartKeepalivePingTimer()}))}catch(e){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;if(!this.canSendPing()){return}if(this.pendingSendKeepalivePing){this.pendingSendKeepalivePing=false;this.maybeSendPing()}else if(!this.keepaliveTimerId&&!this.keepaliveTimeoutId){this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms");this.keepaliveTimerId=(t=(e=setTimeout((()=>{this.maybeSendPing()}),this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)}}stopKeepalivePings(){if(this.keepaliveTimerId){clearTimeout(this.keepaliveTimerId);this.keepaliveTimerId=null}this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e);if(this.activeCalls.size===0){this.session.unref()}}addActiveCall(e){this.activeCalls.add(e);if(this.activeCalls.size===1){this.session.ref();if(!this.keepaliveWithoutCalls){this.maybeStartKeepalivePingTimer()}}}createCall(e,t,r,n,i){const s=e.toHttp2Headers();s[y]=t;s[C]=this.userAgent;s[b]="application/grpc";s[S]="POST";s[_]=r;s[w]="trailers";let a;try{a=this.session.request(s)}catch(e){this.handleDisconnect();throw e}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize);this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let o;let l;if(this.channelzEnabled){this.streamTracker.addCallStarted();o={addMessageSent:()=>{var e;this.messagesSent+=1;this.lastMessageSentTimestamp=new Date;(e=i.addMessageSent)===null||e===void 0?void 0:e.call(i)},addMessageReceived:()=>{var e;this.messagesReceived+=1;this.lastMessageReceivedTimestamp=new Date;(e=i.addMessageReceived)===null||e===void 0?void 0:e.call(i)},onCallEnd:e=>{var t;(t=i.onCallEnd)===null||t===void 0?void 0:t.call(i,e);this.removeActiveCall(l)},onStreamEnd:e=>{var t;if(e){this.streamTracker.addCallSucceeded()}else{this.streamTracker.addCallFailed()}(t=i.onStreamEnd)===null||t===void 0?void 0:t.call(i,e)}}}else{o={addMessageSent:()=>{var e;(e=i.addMessageSent)===null||e===void 0?void 0:e.call(i)},addMessageReceived:()=>{var e;(e=i.addMessageReceived)===null||e===void 0?void 0:e.call(i)},onCallEnd:e=>{var t;(t=i.onCallEnd)===null||t===void 0?void 0:t.call(i,e);this.removeActiveCall(l)},onStreamEnd:e=>{var t;(t=i.onStreamEnd)===null||t===void 0?void 0:t.call(i,e)}}}l=new h.Http2SubchannelCall(a,o,n,this,(0,p.getNextCallNumber)());this.addActiveCall(l);return l}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}shutdown(){this.session.close();(0,s.unregisterChannelzRef)(this.channelzRef)}}class Http2SubchannelConnector{constructor(e){this.channelTarget=e;this.session=null;this.isShutdown=false}trace(e){l.trace(a.LogVerbosity.DEBUG,g,(0,d.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,r,s){if(this.isShutdown){return Promise.reject()}return new Promise(((a,o)=>{var l,h,p;let g;if(s.realTarget){g=(0,d.uriToString)(s.realTarget);this.trace("creating HTTP/2 session through proxy to "+(0,d.uriToString)(s.realTarget))}else{g=null;this.trace("creating HTTP/2 session to "+(0,u.subchannelAddressToString)(e))}const m=(0,c.getDefaultAuthority)((l=s.realTarget)!==null&&l!==void 0?l:this.channelTarget);let v=t._getConnectionOptions()||{};v.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER;if("grpc-node.max_session_memory"in r){v.maxSessionMemory=r["grpc-node.max_session_memory"]}else{v.maxSessionMemory=Number.MAX_SAFE_INTEGER}let y="http://";if("secureContext"in v){y="https://";if(r["grpc.ssl_target_name_override"]){const e=r["grpc.ssl_target_name_override"];v.checkServerIdentity=(t,r)=>(0,i.checkServerIdentity)(e,r);v.servername=e}else{const e=(p=(h=(0,d.splitHostPort)(m))===null||h===void 0?void 0:h.host)!==null&&p!==void 0?p:"localhost";v.servername=e}if(s.socket){v.createConnection=(e,t)=>s.socket}}else{v.createConnection=(t,r)=>{if(s.socket){return s.socket}else{return f.connect(e)}}}v=Object.assign(Object.assign(Object.assign({},v),e),{enableTrace:r["grpc-node.tls_enable_trace"]===1});const b=n.connect(y+m,v);this.session=b;let S="Failed to connect";b.unref();b.once("connect",(()=>{b.removeAllListeners();a(new Http2Transport(b,e,r,g));this.session=null}));b.once("close",(()=>{this.session=null;setImmediate((()=>{o(`${S} (${(new Date).toISOString()})`)}))}));b.once("error",(e=>{S=e.message;this.trace("connection failed with error "+S)}))}))}connect(e,t,r){var n,s;if(this.isShutdown){return Promise.reject()}const a=t._getConnectionOptions()||{};if("secureContext"in a){a.ALPNProtocols=["h2"];if(r["grpc.ssl_target_name_override"]){const e=r["grpc.ssl_target_name_override"];a.checkServerIdentity=(t,r)=>(0,i.checkServerIdentity)(e,r);a.servername=e}else{if("grpc.http_connect_target"in r){const e=(0,c.getDefaultAuthority)((n=(0,d.parseUri)(r["grpc.http_connect_target"]))!==null&&n!==void 0?n:{path:"localhost"});const t=(0,d.splitHostPort)(e);a.servername=(s=t===null||t===void 0?void 0:t.host)!==null&&s!==void 0?s:e}}if(r["grpc-node.tls_enable_trace"]){a.enableTrace=true}}return(0,o.getProxiedConnection)(e,r,a).then((n=>this.createSession(e,t,r,n)))}shutdown(){var e;this.isShutdown=true;(e=this.session)===null||e===void 0?void 0:e.close();this.session=null}}t.Http2SubchannelConnector=Http2SubchannelConnector},5974:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.uriToString=t.combineHostPort=t.splitHostPort=t.parseUri=void 0;const r=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function parseUri(e){const t=r.exec(e);if(t===null){return null}return{scheme:t[1],authority:t[2],path:t[3]}}t.parseUri=parseUri;const n=/^\d+$/;function splitHostPort(e){if(e.startsWith("[")){const t=e.indexOf("]");if(t===-1){return null}const r=e.substring(1,t);if(r.indexOf(":")===-1){return null}if(e.length>t+1){if(e[t+1]===":"){const i=e.substring(t+2);if(n.test(i)){return{host:r,port:+i}}else{return null}}else{return null}}else{return{host:r}}}else{const t=e.split(":");if(t.length===2){if(n.test(t[1])){return{host:t[0],port:+t[1]}}else{return null}}else{return{host:e}}}}t.splitHostPort=splitHostPort;function combineHostPort(e){if(e.port===undefined){return e.host}else{if(e.host.includes(":")){return`[${e.host}]:${e.port}`}else{return`${e.host}:${e.port}`}}}t.combineHostPort=combineHostPort;function uriToString(e){let t="";if(e.scheme!==undefined){t+=e.scheme+":"}if(e.authority!==undefined){t+="//"+e.authority+"/"}t+=e.path;return t}t.uriToString=uriToString},8171:(e,t,r)=>{var n;
/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */n={value:true};n=n=n=t.J_=n=n=n=void 0;const i=r(7994);const s=r(5881);const a=r(1629);const o=r(3245);const l=r(2694);n=l;function isAnyExtension(e){return"@type"in e&&typeof e["@type"]==="string"}n=isAnyExtension;const c={longs:String,enums:String,bytes:String,defaults:true,oneofs:true,json:true};function joinName(e,t){if(e===""){return t}else{return e+"."+t}}function isHandledReflectionObject(e){return e instanceof s.Service||e instanceof s.Type||e instanceof s.Enum}function isNamespaceBase(e){return e instanceof s.Namespace||e instanceof s.Root}function getAllHandledReflectionObjects(e,t){const r=joinName(t,e.name);if(isHandledReflectionObject(e)){return[[r,e]]}else{if(isNamespaceBase(e)&&typeof e.nested!=="undefined"){return Object.keys(e.nested).map((t=>getAllHandledReflectionObjects(e.nested[t],r))).reduce(((e,t)=>e.concat(t)),[])}}return[]}function createDeserializer(e,t){return function deserialize(r){return e.toObject(e.decode(r),t)}}function createSerializer(e){return function serialize(t){if(Array.isArray(t)){throw new Error(`Failed to serialize message: expected object with ${e.name} structure, got array instead`)}const r=e.fromObject(t);return e.encode(r).finish()}}function createMethodDefinition(e,t,r,n){const s=e.resolvedRequestType;const a=e.resolvedResponseType;return{path:"/"+t+"/"+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestSerialize:createSerializer(s),requestDeserialize:createDeserializer(s,r),responseSerialize:createSerializer(a),responseDeserialize:createDeserializer(a,r),originalName:i(e.name),requestType:createMessageDefinition(s,n),responseType:createMessageDefinition(a,n)}}function createServiceDefinition(e,t,r,n){const i={};for(const s of e.methodsArray){i[s.name]=createMethodDefinition(s,t,r,n)}return i}function createMessageDefinition(e,t){const r=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:r.$type.toObject(r,c),fileDescriptorProtos:t}}function createEnumDefinition(e,t){const r=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:r.$type.toObject(r,c),fileDescriptorProtos:t}}function createDefinition(e,t,r,n){if(e instanceof s.Service){return createServiceDefinition(e,t,r,n)}else if(e instanceof s.Type){return createMessageDefinition(e,n)}else if(e instanceof s.Enum){return createEnumDefinition(e,n)}else{throw new Error("Type mismatch in reflection object handling")}}function createPackageDefinition(e,t){const r={};e.resolveAll();const n=e.toDescriptor("proto3").file;const i=n.map((e=>Buffer.from(a.FileDescriptorProto.encode(e).finish())));for(const[n,s]of getAllHandledReflectionObjects(e,"")){r[n]=createDefinition(s,n,t,i)}return r}function createPackageDefinitionFromDescriptorSet(e,t){t=t||{};const r=s.Root.fromDescriptor(e);r.resolveAll();return createPackageDefinition(r,t)}function load(e,t){return(0,o.loadProtosWithOptions)(e,t).then((e=>createPackageDefinition(e,t)))}n=load;function loadSync(e,t){const r=(0,o.loadProtosWithOptionsSync)(e,t);return createPackageDefinition(r,t)}t.J_=loadSync;function fromJSON(e,t){t=t||{};const r=s.Root.fromJSON(e);r.resolveAll();return createPackageDefinition(r,t)}n=fromJSON;function loadFileDescriptorSetFromBuffer(e,t){const r=a.FileDescriptorSet.decode(e);return createPackageDefinitionFromDescriptorSet(r,t)}n=loadFileDescriptorSetFromBuffer;function loadFileDescriptorSetFromObject(e,t){const r=a.FileDescriptorSet.fromObject(e);return createPackageDefinitionFromDescriptorSet(r,t)}n=loadFileDescriptorSetFromObject;(0,o.addCommonProtos)()},3245:(e,t,r)=>{
/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
Object.defineProperty(t,"__esModule",{value:true});t.addCommonProtos=t.loadProtosWithOptionsSync=t.loadProtosWithOptions=void 0;const n=r(7147);const i=r(1017);const s=r(5881);function addIncludePathResolver(e,t){const r=e.resolvePath;e.resolvePath=(e,s)=>{if(i.isAbsolute(s)){return s}for(const e of t){const t=i.join(e,s);try{n.accessSync(t,n.constants.R_OK);return t}catch(e){continue}}process.emitWarning(`${s} not found in any of the include paths ${t}`);return r(e,s)}}async function loadProtosWithOptions(e,t){const r=new s.Root;t=t||{};if(!!t.includeDirs){if(!Array.isArray(t.includeDirs)){return Promise.reject(new Error("The includeDirs option must be an array"))}addIncludePathResolver(r,t.includeDirs)}const n=await r.load(e,t);n.resolveAll();return n}t.loadProtosWithOptions=loadProtosWithOptions;function loadProtosWithOptionsSync(e,t){const r=new s.Root;t=t||{};if(!!t.includeDirs){if(!Array.isArray(t.includeDirs)){throw new Error("The includeDirs option must be an array")}addIncludePathResolver(r,t.includeDirs)}const n=r.loadSync(e,t);n.resolveAll();return n}t.loadProtosWithOptionsSync=loadProtosWithOptionsSync;function addCommonProtos(){const e=r(4784);const t=r(3571);const n=r(3342);const i=r(8783);s.common("api",e.nested.google.nested.protobuf.nested);s.common("descriptor",t.nested.google.nested.protobuf.nested);s.common("source_context",n.nested.google.nested.protobuf.nested);s.common("type",i.nested.google.nested.protobuf.nested)}t.addCommonProtos=addCommonProtos},252:e=>{e.exports=asPromise;function asPromise(e,t){var r=new Array(arguments.length-1),n=0,i=2,s=true;while(i<arguments.length)r[n++]=arguments[i++];return new Promise((function executor(i,a){r[n]=function callback(e){if(s){s=false;if(e)a(e);else{var t=new Array(arguments.length-1),r=0;while(r<t.length)t[r++]=arguments[r];i.apply(null,t)}}};try{e.apply(t||null,r)}catch(e){if(s){s=false;a(e)}}}))}},6718:(e,t)=>{var r=t;r.length=function length(e){var t=e.length;if(!t)return 0;var r=0;while(--t%4>1&&e.charAt(t)==="=")++r;return Math.ceil(e.length*3)/4-r};var n=new Array(64);var i=new Array(123);for(var s=0;s<64;)i[n[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function encode(e,t,r){var i=null,s=[];var a=0,o=0,l;while(t<r){var c=e[t++];switch(o){case 0:s[a++]=n[c>>2];l=(c&3)<<4;o=1;break;case 1:s[a++]=n[l|c>>4];l=(c&15)<<2;o=2;break;case 2:s[a++]=n[l|c>>6];s[a++]=n[c&63];o=0;break}if(a>8191){(i||(i=[])).push(String.fromCharCode.apply(String,s));a=0}}if(o){s[a++]=n[l];s[a++]=61;if(o===1)s[a++]=61}if(i){if(a)i.push(String.fromCharCode.apply(String,s.slice(0,a)));return i.join("")}return String.fromCharCode.apply(String,s.slice(0,a))};var a="invalid encoding";r.decode=function decode(e,t,r){var n=r;var s=0,o;for(var l=0;l<e.length;){var c=e.charCodeAt(l++);if(c===61&&s>1)break;if((c=i[c])===undefined)throw Error(a);switch(s){case 0:o=c;s=1;break;case 1:t[r++]=o<<2|(c&48)>>4;o=c;s=2;break;case 2:t[r++]=(o&15)<<4|(c&60)>>2;o=c;s=3;break;case 3:t[r++]=(o&3)<<6|c;s=0;break}}if(s===1)throw Error(a);return r-n};r.test=function test(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},8882:e=>{e.exports=codegen;function codegen(e,t){if(typeof e==="string"){t=e;e=undefined}var r=[];function Codegen(e){if(typeof e!=="string"){var t=toString();if(codegen.verbose)console.log("codegen: "+t);t="return "+t;if(e){var n=Object.keys(e),i=new Array(n.length+1),s=new Array(n.length),a=0;while(a<n.length){i[a]=n[a];s[a]=e[n[a++]]}i[a]=t;return Function.apply(null,i).apply(null,s)}return Function(t)()}var o=new Array(arguments.length-1),l=0;while(l<o.length)o[l]=arguments[++l];l=0;e=e.replace(/%([%dfijs])/g,(function replace(e,t){var r=o[l++];switch(t){case"d":case"f":return String(Number(r));case"i":return String(Math.floor(r));case"j":return JSON.stringify(r);case"s":return String(r)}return"%"}));if(l!==o.length)throw Error("parameter count mismatch");r.push(e);return Codegen}function toString(n){return"function "+(n||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}Codegen.toString=toString;return Codegen}codegen.verbose=false},6850:e=>{e.exports=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function on(e,t,r){(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this});return this};EventEmitter.prototype.off=function off(e,t){if(e===undefined)this._listeners={};else{if(t===undefined)this._listeners[e]=[];else{var r=this._listeners[e];for(var n=0;n<r.length;)if(r[n].fn===t)r.splice(n,1);else++n}}return this};EventEmitter.prototype.emit=function emit(e){var t=this._listeners[e];if(t){var r=[],n=1;for(;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},663:(e,t,r)=>{e.exports=fetch;var n=r(252),i=r(94);var s=i("fs");function fetch(e,t,r){if(typeof t==="function"){r=t;t={}}else if(!t)t={};if(!r)return n(fetch,this,e,t);if(!t.xhr&&s&&s.readFile)return s.readFile(e,(function fetchReadFileCallback(n,i){return n&&typeof XMLHttpRequest!=="undefined"?fetch.xhr(e,t,r):n?r(n):r(null,t.binary?i:i.toString("utf8"))}));return fetch.xhr(e,t,r)}fetch.xhr=function fetch_xhr(e,t,r){var n=new XMLHttpRequest;n.onreadystatechange=function fetchOnReadyStateChange(){if(n.readyState!==4)return undefined;if(n.status!==0&&n.status!==200)return r(Error("status "+n.status));if(t.binary){var e=n.response;if(!e){e=[];for(var i=0;i<n.responseText.length;++i)e.push(n.responseText.charCodeAt(i)&255)}return r(null,typeof Uint8Array!=="undefined"?new Uint8Array(e):e)}return r(null,n.responseText)};if(t.binary){if("overrideMimeType"in n)n.overrideMimeType("text/plain; charset=x-user-defined");n.responseType="arraybuffer"}n.open("GET",e);n.send()}},3182:e=>{e.exports=factory(factory);function factory(e){if(typeof Float32Array!=="undefined")(function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function writeFloat_f32_cpy(e,n,i){t[0]=e;n[i]=r[0];n[i+1]=r[1];n[i+2]=r[2];n[i+3]=r[3]}function writeFloat_f32_rev(e,n,i){t[0]=e;n[i]=r[3];n[i+1]=r[2];n[i+2]=r[1];n[i+3]=r[0]}e.writeFloatLE=n?writeFloat_f32_cpy:writeFloat_f32_rev;e.writeFloatBE=n?writeFloat_f32_rev:writeFloat_f32_cpy;function readFloat_f32_cpy(e,n){r[0]=e[n];r[1]=e[n+1];r[2]=e[n+2];r[3]=e[n+3];return t[0]}function readFloat_f32_rev(e,n){r[3]=e[n];r[2]=e[n+1];r[1]=e[n+2];r[0]=e[n+3];return t[0]}e.readFloatLE=n?readFloat_f32_cpy:readFloat_f32_rev;e.readFloatBE=n?readFloat_f32_rev:readFloat_f32_cpy})();else(function(){function writeFloat_ieee754(e,t,r,n){var i=t<0?1:0;if(i)t=-t;if(t===0)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var s=Math.floor(Math.log(t)/Math.LN2),a=Math.round(t*Math.pow(2,-s)*8388608)&8388607;e((i<<31|s+127<<23|a)>>>0,r,n)}}e.writeFloatLE=writeFloat_ieee754.bind(null,writeUintLE);e.writeFloatBE=writeFloat_ieee754.bind(null,writeUintBE);function readFloat_ieee754(e,t,r){var n=e(t,r),i=(n>>31)*2+1,s=n>>>23&255,a=n&8388607;return s===255?a?NaN:i*Infinity:s===0?i*1401298464324817e-60*a:i*Math.pow(2,s-150)*(a+8388608)}e.readFloatLE=readFloat_ieee754.bind(null,readUintLE);e.readFloatBE=readFloat_ieee754.bind(null,readUintBE)})();if(typeof Float64Array!=="undefined")(function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function writeDouble_f64_cpy(e,n,i){t[0]=e;n[i]=r[0];n[i+1]=r[1];n[i+2]=r[2];n[i+3]=r[3];n[i+4]=r[4];n[i+5]=r[5];n[i+6]=r[6];n[i+7]=r[7]}function writeDouble_f64_rev(e,n,i){t[0]=e;n[i]=r[7];n[i+1]=r[6];n[i+2]=r[5];n[i+3]=r[4];n[i+4]=r[3];n[i+5]=r[2];n[i+6]=r[1];n[i+7]=r[0]}e.writeDoubleLE=n?writeDouble_f64_cpy:writeDouble_f64_rev;e.writeDoubleBE=n?writeDouble_f64_rev:writeDouble_f64_cpy;function readDouble_f64_cpy(e,n){r[0]=e[n];r[1]=e[n+1];r[2]=e[n+2];r[3]=e[n+3];r[4]=e[n+4];r[5]=e[n+5];r[6]=e[n+6];r[7]=e[n+7];return t[0]}function readDouble_f64_rev(e,n){r[7]=e[n];r[6]=e[n+1];r[5]=e[n+2];r[4]=e[n+3];r[3]=e[n+4];r[2]=e[n+5];r[1]=e[n+6];r[0]=e[n+7];return t[0]}e.readDoubleLE=n?readDouble_f64_cpy:readDouble_f64_rev;e.readDoubleBE=n?readDouble_f64_rev:readDouble_f64_cpy})();else(function(){function writeDouble_ieee754(e,t,r,n,i,s){var a=n<0?1:0;if(a)n=-n;if(n===0){e(0,i,s+t);e(1/n>0?0:2147483648,i,s+r)}else if(isNaN(n)){e(0,i,s+t);e(2146959360,i,s+r)}else if(n>17976931348623157e292){e(0,i,s+t);e((a<<31|2146435072)>>>0,i,s+r)}else{var o;if(n<22250738585072014e-324){o=n/5e-324;e(o>>>0,i,s+t);e((a<<31|o/4294967296)>>>0,i,s+r)}else{var l=Math.floor(Math.log(n)/Math.LN2);if(l===1024)l=1023;o=n*Math.pow(2,-l);e(o*4503599627370496>>>0,i,s+t);e((a<<31|l+1023<<20|o*1048576&1048575)>>>0,i,s+r)}}}e.writeDoubleLE=writeDouble_ieee754.bind(null,writeUintLE,0,4);e.writeDoubleBE=writeDouble_ieee754.bind(null,writeUintBE,4,0);function readDouble_ieee754(e,t,r,n,i){var s=e(n,i+t),a=e(n,i+r);var o=(a>>31)*2+1,l=a>>>20&2047,c=4294967296*(a&1048575)+s;return l===2047?c?NaN:o*Infinity:l===0?o*5e-324*c:o*Math.pow(2,l-1075)*(c+4503599627370496)}e.readDoubleLE=readDouble_ieee754.bind(null,readUintLE,0,4);e.readDoubleBE=readDouble_ieee754.bind(null,readUintBE,4,0)})();return e}function writeUintLE(e,t,r){t[r]=e&255;t[r+1]=e>>>8&255;t[r+2]=e>>>16&255;t[r+3]=e>>>24}function writeUintBE(e,t,r){t[r]=e>>>24;t[r+1]=e>>>16&255;t[r+2]=e>>>8&255;t[r+3]=e&255}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}},94:module=>{module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}},4761:(e,t)=>{var r=t;var n=r.isAbsolute=function isAbsolute(e){return/^(?:\/|\w+:)/.test(e)};var i=r.normalize=function normalize(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=n(e),i="";if(r)i=t.shift()+"/";for(var s=0;s<t.length;){if(t[s]===".."){if(s>0&&t[s-1]!=="..")t.splice(--s,2);else if(r)t.splice(s,1);else++s}else if(t[s]===".")t.splice(s,1);else++s}return i+t.join("/")};r.resolve=function resolve(e,t,r){if(!r)t=i(t);if(n(t))return t;if(!r)e=i(e);return(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?i(e+"/"+t):t}},7743:e=>{e.exports=pool;function pool(e,t,r){var n=r||8192;var i=n>>>1;var s=null;var a=n;return function pool_alloc(r){if(r<1||r>i)return e(r);if(a+r>n){s=e(n);a=0}var o=t.call(s,a,a+=r);if(a&7)a=(a|7)+1;return o}}},9049:(e,t)=>{var r=t;r.length=function utf8_length(e){var t=0,r=0;for(var n=0;n<e.length;++n){r=e.charCodeAt(n);if(r<128)t+=1;else if(r<2048)t+=2;else if((r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320){++n;t+=4}else t+=3}return t};r.read=function utf8_read(e,t,r){var n=r-t;if(n<1)return"";var i=null,s=[],a=0,o;while(t<r){o=e[t++];if(o<128)s[a++]=o;else if(o>191&&o<224)s[a++]=(o&31)<<6|e[t++]&63;else if(o>239&&o<365){o=((o&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536;s[a++]=55296+(o>>10);s[a++]=56320+(o&1023)}else s[a++]=(o&15)<<12|(e[t++]&63)<<6|e[t++]&63;if(a>8191){(i||(i=[])).push(String.fromCharCode.apply(String,s));a=0}}if(i){if(a)i.push(String.fromCharCode.apply(String,s.slice(0,a)));return i.join("")}return String.fromCharCode.apply(String,s.slice(0,a))};r.write=function utf8_write(e,t,r){var n=r,i,s;for(var a=0;a<e.length;++a){i=e.charCodeAt(a);if(i<128){t[r++]=i}else if(i<2048){t[r++]=i>>6|192;t[r++]=i&63|128}else if((i&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320){i=65536+((i&1023)<<10)+(s&1023);++a;t[r++]=i>>18|240;t[r++]=i>>12&63|128;t[r++]=i>>6&63|128;t[r++]=i&63|128}else{t[r++]=i>>12|224;t[r++]=i>>6&63|128;t[r++]=i&63|128}}return r-n}},991:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=asyncify;var n=r(9658);var i=_interopRequireDefault(n);var s=r(729);var a=_interopRequireDefault(s);var o=r(7456);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function asyncify(e){if((0,o.isAsync)(e)){return function(...t){const r=t.pop();const n=e.apply(this,t);return handlePromise(n,r)}}return(0,i.default)((function(t,r){var n;try{n=e.apply(this,t)}catch(e){return r(e)}if(n&&typeof n.then==="function"){return handlePromise(n,r)}else{r(null,n)}}))}function handlePromise(e,t){return e.then((e=>{invokeCallback(t,null,e)}),(e=>{invokeCallback(t,e&&(e instanceof Error||e.message)?e:new Error(e))}))}function invokeCallback(e,t,r){try{e(t,r)}catch(e){(0,a.default)((e=>{throw e}),e)}}e.exports=t.default},5460:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});var n=r(7157);var i=_interopRequireDefault(n);var s=r(8810);var a=_interopRequireDefault(s);var o=r(9342);var l=_interopRequireDefault(o);var c=r(7260);var u=_interopRequireDefault(c);var d=r(1990);var f=_interopRequireDefault(d);var h=r(7456);var p=_interopRequireDefault(h);var g=r(3887);var m=_interopRequireDefault(g);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function eachOfArrayLike(e,t,r){r=(0,u.default)(r);var n=0,i=0,{length:s}=e,o=false;if(s===0){r(null)}function iteratorCallback(e,t){if(e===false){o=true}if(o===true)return;if(e){r(e)}else if(++i===s||t===a.default){r(null)}}for(;n<s;n++){t(e[n],n,(0,f.default)(iteratorCallback))}}function eachOfGeneric(e,t,r){return(0,l.default)(e,Infinity,t,r)}function eachOf(e,t,r){var n=(0,i.default)(e)?eachOfArrayLike:eachOfGeneric;return n(e,(0,p.default)(t),r)}t["default"]=(0,m.default)(eachOf,3);e.exports=t.default},9342:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});var n=r(6658);var i=_interopRequireDefault(n);var s=r(7456);var a=_interopRequireDefault(s);var o=r(3887);var l=_interopRequireDefault(o);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function eachOfLimit(e,t,r,n){return(0,i.default)(t)(e,(0,a.default)(r),n)}t["default"]=(0,l.default)(eachOfLimit,4);e.exports=t.default},1336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});var n=r(9342);var i=_interopRequireDefault(n);var s=r(3887);var a=_interopRequireDefault(s);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function eachOfSeries(e,t,r){return(0,i.default)(e,1,t,r)}t["default"]=(0,a.default)(eachOfSeries,3);e.exports=t.default},1216:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});var n=r(5460);var i=_interopRequireDefault(n);var s=r(4674);var a=_interopRequireDefault(s);var o=r(7456);var l=_interopRequireDefault(o);var c=r(3887);var u=_interopRequireDefault(c);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function eachLimit(e,t,r){return(0,i.default)(e,(0,a.default)((0,l.default)(t)),r)}t["default"]=(0,u.default)(eachLimit,3);e.exports=t.default},2718:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=asyncEachOfLimit;var n=r(8810);var i=_interopRequireDefault(n);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function asyncEachOfLimit(e,t,r,n){let s=false;let a=false;let o=false;let l=0;let c=0;function replenish(){if(l>=t||o||s)return;o=true;e.next().then((({value:e,done:t})=>{if(a||s)return;o=false;if(t){s=true;if(l<=0){n(null)}return}l++;r(e,c,iterateeCallback);c++;replenish()})).catch(handleError)}function iterateeCallback(e,t){l-=1;if(a)return;if(e)return handleError(e);if(e===false){s=true;a=true;return}if(t===i.default||s&&l<=0){s=true;return n(null)}replenish()}function handleError(e){if(a)return;o=false;s=true;n(e)}replenish()}e.exports=t.default},3887:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=awaitify;function awaitify(e,t){if(!t)t=e.length;if(!t)throw new Error("arity is undefined");function awaitable(...r){if(typeof r[t-1]==="function"){return e.apply(this,r)}return new Promise(((n,i)=>{r[t-1]=(e,...t)=>{if(e)return i(e);n(t.length>1?t:t[0])};e.apply(this,r)}))}return awaitable}e.exports=t.default},8810:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});const r={};t["default"]=r;e.exports=t.default},6658:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});var n=r(7260);var i=_interopRequireDefault(n);var s=r(1420);var a=_interopRequireDefault(s);var o=r(1990);var l=_interopRequireDefault(o);var c=r(7456);var u=r(2718);var d=_interopRequireDefault(u);var f=r(8810);var h=_interopRequireDefault(f);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t["default"]=e=>(t,r,n)=>{n=(0,i.default)(n);if(e<=0){throw new RangeError("concurrency limit cannot be less than 1")}if(!t){return n(null)}if((0,c.isAsyncGenerator)(t)){return(0,d.default)(t,e,r,n)}if((0,c.isAsyncIterable)(t)){return(0,d.default)(t[Symbol.asyncIterator](),e,r,n)}var s=(0,a.default)(t);var o=false;var u=false;var f=0;var p=false;function iterateeCallback(e,t){if(u)return;f-=1;if(e){o=true;n(e)}else if(e===false){o=true;u=true}else if(t===h.default||o&&f<=0){o=true;return n(null)}else if(!p){replenish()}}function replenish(){p=true;while(f<e&&!o){var t=s();if(t===null){o=true;if(f<=0){n(null)}return}f+=1;r(t.value,t.key,(0,l.default)(iterateeCallback))}p=false}replenish()};e.exports=t.default},7645:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()};e.exports=t.default},9658:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=function(e){return function(...t){var r=t.pop();return e.call(this,t,r)}};e.exports=t.default},7157:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=isArrayLike;function isArrayLike(e){return e&&typeof e.length==="number"&&e.length>=0&&e.length%1===0}e.exports=t.default},1420:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=createIterator;var n=r(7157);var i=_interopRequireDefault(n);var s=r(7645);var a=_interopRequireDefault(s);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function createArrayIterator(e){var t=-1;var r=e.length;return function next(){return++t<r?{value:e[t],key:t}:null}}function createES2015Iterator(e){var t=-1;return function next(){var r=e.next();if(r.done)return null;t++;return{value:r.value,key:t}}}function createObjectIterator(e){var t=e?Object.keys(e):[];var r=-1;var n=t.length;return function next(){var i=t[++r];if(i==="__proto__"){return next()}return r<n?{value:e[i],key:i}:null}}function createIterator(e){if((0,i.default)(e)){return createArrayIterator(e)}var t=(0,a.default)(e);return t?createES2015Iterator(t):createObjectIterator(e)}e.exports=t.default},7260:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=once;function once(e){function wrapper(...t){if(e===null)return;var r=e;e=null;r.apply(this,t)}Object.assign(wrapper,e);return wrapper}e.exports=t.default},1990:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=onlyOnce;function onlyOnce(e){return function(...t){if(e===null)throw new Error("Callback was already called.");var r=e;e=null;r.apply(this,t)}}e.exports=t.default},3221:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});var n=r(7157);var i=_interopRequireDefault(n);var s=r(7456);var a=_interopRequireDefault(s);var o=r(3887);var l=_interopRequireDefault(o);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t["default"]=(0,l.default)(((e,t,r)=>{var n=(0,i.default)(t)?[]:{};e(t,((e,t,r)=>{(0,a.default)(e)(((e,...i)=>{if(i.length<2){[i]=i}n[t]=i;r(e)}))}),(e=>r(e,n)))}),3);e.exports=t.default},729:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.fallback=fallback;t.wrap=wrap;var r=t.hasQueueMicrotask=typeof queueMicrotask==="function"&&queueMicrotask;var n=t.hasSetImmediate=typeof setImmediate==="function"&&setImmediate;var i=t.hasNextTick=typeof process==="object"&&typeof process.nextTick==="function";function fallback(e){setTimeout(e,0)}function wrap(e){return(t,...r)=>e((()=>t(...r)))}var s;if(r){s=queueMicrotask}else if(n){s=setImmediate}else if(i){s=process.nextTick}else{s=fallback}t["default"]=wrap(s)},4674:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=_withoutIndex;function _withoutIndex(e){return(t,r,n)=>e(t,n)}e.exports=t.default},7456:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.isAsyncIterable=t.isAsyncGenerator=t.isAsync=undefined;var n=r(991);var i=_interopRequireDefault(n);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function isAsync(e){return e[Symbol.toStringTag]==="AsyncFunction"}function isAsyncGenerator(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function isAsyncIterable(e){return typeof e[Symbol.asyncIterator]==="function"}function wrapAsync(e){if(typeof e!=="function")throw new Error("expected a function");return isAsync(e)?(0,i.default)(e):e}t["default"]=wrapAsync;t.isAsync=isAsync;t.isAsyncGenerator=isAsyncGenerator;t.isAsyncIterable=isAsyncIterable},9619:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=series;var n=r(3221);var i=_interopRequireDefault(n);var s=r(1336);var a=_interopRequireDefault(s);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function series(e,t){return(0,i.default)(a.default,e,t)}e.exports=t.default},8510:e=>{e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},1069:(e,t,r)=>{var n=r(8510);var i=r(8679);var s=Object.hasOwnProperty;var a=Object.create(null);for(var o in n){if(s.call(n,o)){a[n[o]]=o}}var l=e.exports={to:{},get:{}};l.get=function(e){var t=e.substring(0,3).toLowerCase();var r;var n;switch(t){case"hsl":r=l.get.hsl(e);n="hsl";break;case"hwb":r=l.get.hwb(e);n="hwb";break;default:r=l.get.rgb(e);n="rgb";break}if(!r){return null}return{model:n,value:r}};l.get.rgb=function(e){if(!e){return null}var t=/^#([a-f0-9]{3,4})$/i;var r=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i;var i=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/;var a=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/;var o=/^(\w+)$/;var l=[0,0,0,1];var c;var u;var d;if(c=e.match(r)){d=c[2];c=c[1];for(u=0;u<3;u++){var f=u*2;l[u]=parseInt(c.slice(f,f+2),16)}if(d){l[3]=parseInt(d,16)/255}}else if(c=e.match(t)){c=c[1];d=c[3];for(u=0;u<3;u++){l[u]=parseInt(c[u]+c[u],16)}if(d){l[3]=parseInt(d+d,16)/255}}else if(c=e.match(i)){for(u=0;u<3;u++){l[u]=parseInt(c[u+1],0)}if(c[4]){if(c[5]){l[3]=parseFloat(c[4])*.01}else{l[3]=parseFloat(c[4])}}}else if(c=e.match(a)){for(u=0;u<3;u++){l[u]=Math.round(parseFloat(c[u+1])*2.55)}if(c[4]){if(c[5]){l[3]=parseFloat(c[4])*.01}else{l[3]=parseFloat(c[4])}}}else if(c=e.match(o)){if(c[1]==="transparent"){return[0,0,0,0]}if(!s.call(n,c[1])){return null}l=n[c[1]];l[3]=1;return l}else{return null}for(u=0;u<3;u++){l[u]=clamp(l[u],0,255)}l[3]=clamp(l[3],0,1);return l};l.get.hsl=function(e){if(!e){return null}var t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;var r=e.match(t);if(r){var n=parseFloat(r[4]);var i=(parseFloat(r[1])%360+360)%360;var s=clamp(parseFloat(r[2]),0,100);var a=clamp(parseFloat(r[3]),0,100);var o=clamp(isNaN(n)?1:n,0,1);return[i,s,a,o]}return null};l.get.hwb=function(e){if(!e){return null}var t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;var r=e.match(t);if(r){var n=parseFloat(r[4]);var i=(parseFloat(r[1])%360+360)%360;var s=clamp(parseFloat(r[2]),0,100);var a=clamp(parseFloat(r[3]),0,100);var o=clamp(isNaN(n)?1:n,0,1);return[i,s,a,o]}return null};l.to.hex=function(){var e=i(arguments);return"#"+hexDouble(e[0])+hexDouble(e[1])+hexDouble(e[2])+(e[3]<1?hexDouble(Math.round(e[3]*255)):"")};l.to.rgb=function(){var e=i(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};l.to.rgb.percent=function(){var e=i(arguments);var t=Math.round(e[0]/255*100);var r=Math.round(e[1]/255*100);var n=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"};l.to.hsl=function(){var e=i(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};l.to.hwb=function(){var e=i(arguments);var t="";if(e.length>=4&&e[3]!==1){t=", "+e[3]}return"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"};l.to.keyword=function(e){return a[e.slice(0,3)]};function clamp(e,t,r){return Math.min(Math.max(t,e),r)}function hexDouble(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}},7177:(e,t,r)=>{var n=r(1069);var i=r(241);var s=[].slice;var a=["keyword","gray","hex"];var o={};Object.keys(i).forEach((function(e){o[s.call(i[e].labels).sort().join("")]=e}));var l={};function Color(e,t){if(!(this instanceof Color)){return new Color(e,t)}if(t&&t in a){t=null}if(t&&!(t in i)){throw new Error("Unknown model: "+t)}var r;var c;if(e==null){this.model="rgb";this.color=[0,0,0];this.valpha=1}else if(e instanceof Color){this.model=e.model;this.color=e.color.slice();this.valpha=e.valpha}else if(typeof e==="string"){var u=n.get(e);if(u===null){throw new Error("Unable to parse color from string: "+e)}this.model=u.model;c=i[this.model].channels;this.color=u.value.slice(0,c);this.valpha=typeof u.value[c]==="number"?u.value[c]:1}else if(e.length){this.model=t||"rgb";c=i[this.model].channels;var d=s.call(e,0,c);this.color=zeroArray(d,c);this.valpha=typeof e[c]==="number"?e[c]:1}else if(typeof e==="number"){e&=16777215;this.model="rgb";this.color=[e>>16&255,e>>8&255,e&255];this.valpha=1}else{this.valpha=1;var f=Object.keys(e);if("alpha"in e){f.splice(f.indexOf("alpha"),1);this.valpha=typeof e.alpha==="number"?e.alpha:0}var h=f.sort().join("");if(!(h in o)){throw new Error("Unable to parse color from object: "+JSON.stringify(e))}this.model=o[h];var p=i[this.model].labels;var g=[];for(r=0;r<p.length;r++){g.push(e[p[r]])}this.color=zeroArray(g)}if(l[this.model]){c=i[this.model].channels;for(r=0;r<c;r++){var m=l[this.model][r];if(m){this.color[r]=m(this.color[r])}}}this.valpha=Math.max(0,Math.min(1,this.valpha));if(Object.freeze){Object.freeze(this)}}Color.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in n.to?this:this.rgb();t=t.round(typeof e==="number"?e:1);var r=t.valpha===1?t.color:t.color.concat(this.valpha);return n.to[t.model](r)},percentString:function(e){var t=this.rgb().round(typeof e==="number"?e:1);var r=t.valpha===1?t.color:t.color.concat(this.valpha);return n.to.rgb.percent(r)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){var e={};var t=i[this.model].channels;var r=i[this.model].labels;for(var n=0;n<t;n++){e[r[n]]=this.color[n]}if(this.valpha!==1){e.alpha=this.valpha}return e},unitArray:function(){var e=this.rgb().color;e[0]/=255;e[1]/=255;e[2]/=255;if(this.valpha!==1){e.push(this.valpha)}return e},unitObject:function(){var e=this.rgb().object();e.r/=255;e.g/=255;e.b/=255;if(this.valpha!==1){e.alpha=this.valpha}return e},round:function(e){e=Math.max(e||0,0);return new Color(this.color.map(roundToPlace(e)).concat(this.valpha),this.model)},alpha:function(e){if(arguments.length){return new Color(this.color.concat(Math.max(0,Math.min(1,e))),this.model)}return this.valpha},red:getset("rgb",0,maxfn(255)),green:getset("rgb",1,maxfn(255)),blue:getset("rgb",2,maxfn(255)),hue:getset(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:getset("hsl",1,maxfn(100)),lightness:getset("hsl",2,maxfn(100)),saturationv:getset("hsv",1,maxfn(100)),value:getset("hsv",2,maxfn(100)),chroma:getset("hcg",1,maxfn(100)),gray:getset("hcg",2,maxfn(100)),white:getset("hwb",1,maxfn(100)),wblack:getset("hwb",2,maxfn(100)),cyan:getset("cmyk",0,maxfn(100)),magenta:getset("cmyk",1,maxfn(100)),yellow:getset("cmyk",2,maxfn(100)),black:getset("cmyk",3,maxfn(100)),x:getset("xyz",0,maxfn(100)),y:getset("xyz",1,maxfn(100)),z:getset("xyz",2,maxfn(100)),l:getset("lab",0,maxfn(100)),a:getset("lab",1),b:getset("lab",2),keyword:function(e){if(arguments.length){return new Color(e)}return i[this.model].keyword(this.color)},hex:function(e){if(arguments.length){return new Color(e)}return n.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity:function(){var e=this.rgb().color;var t=[];for(var r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity();var r=e.luminosity();if(t>r){return(t+.05)/(r+.05)}return(r+.05)/(t+.05)},level:function(e){var t=this.contrast(e);if(t>=7.1){return"AAA"}return t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;var t=(e[0]*299+e[1]*587+e[2]*114)/1e3;return t<128},isLight:function(){return!this.isDark()},negate:function(){var e=this.rgb();for(var t=0;t<3;t++){e.color[t]=255-e.color[t]}return e},lighten:function(e){var t=this.hsl();t.color[2]+=t.color[2]*e;return t},darken:function(e){var t=this.hsl();t.color[2]-=t.color[2]*e;return t},saturate:function(e){var t=this.hsl();t.color[1]+=t.color[1]*e;return t},desaturate:function(e){var t=this.hsl();t.color[1]-=t.color[1]*e;return t},whiten:function(e){var t=this.hwb();t.color[1]+=t.color[1]*e;return t},blacken:function(e){var t=this.hwb();t.color[2]+=t.color[2]*e;return t},grayscale:function(){var e=this.rgb().color;var t=e[0]*.3+e[1]*.59+e[2]*.11;return Color.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl();var r=t.color[0];r=(r+e)%360;r=r<0?360+r:r;t.color[0]=r;return t},mix:function(e,t){if(!e||!e.rgb){throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e)}var r=e.rgb();var n=this.rgb();var i=t===undefined?.5:t;var s=2*i-1;var a=r.alpha()-n.alpha();var o=((s*a===-1?s:(s+a)/(1+s*a))+1)/2;var l=1-o;return Color.rgb(o*r.red()+l*n.red(),o*r.green()+l*n.green(),o*r.blue()+l*n.blue(),r.alpha()*i+n.alpha()*(1-i))}};Object.keys(i).forEach((function(e){if(a.indexOf(e)!==-1){return}var t=i[e].channels;Color.prototype[e]=function(){if(this.model===e){return new Color(this)}if(arguments.length){return new Color(arguments,e)}var r=typeof arguments[t]==="number"?t:this.valpha;return new Color(assertArray(i[this.model][e].raw(this.color)).concat(r),e)};Color[e]=function(r){if(typeof r==="number"){r=zeroArray(s.call(arguments),t)}return new Color(r,e)}}));function roundTo(e,t){return Number(e.toFixed(t))}function roundToPlace(e){return function(t){return roundTo(t,e)}}function getset(e,t,r){e=Array.isArray(e)?e:[e];e.forEach((function(e){(l[e]||(l[e]=[]))[t]=r}));e=e[0];return function(n){var i;if(arguments.length){if(r){n=r(n)}i=this[e]();i.color[t]=n;return i}i=this[e]().color[t];if(r){i=r(i)}return i}}function maxfn(e){return function(t){return Math.max(0,Math.min(e,t))}}function assertArray(e){return Array.isArray(e)?e:[e]}function zeroArray(e,t){for(var r=0;r<t;r++){if(typeof e[r]!=="number"){e[r]=0}}return e}e.exports=Color},5479:(e,t,r)=>{var n=r(74);var i={};for(var s in n){if(n.hasOwnProperty(s)){i[n[s]]=s}}var a=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var o in a){if(a.hasOwnProperty(o)){if(!("channels"in a[o])){throw new Error("missing channels property: "+o)}if(!("labels"in a[o])){throw new Error("missing channel labels property: "+o)}if(a[o].labels.length!==a[o].channels){throw new Error("channel and label counts mismatch: "+o)}var l=a[o].channels;var c=a[o].labels;delete a[o].channels;delete a[o].labels;Object.defineProperty(a[o],"channels",{value:l});Object.defineProperty(a[o],"labels",{value:c})}}a.rgb.hsl=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;var i=Math.min(t,r,n);var s=Math.max(t,r,n);var a=s-i;var o;var l;var c;if(s===i){o=0}else if(t===s){o=(r-n)/a}else if(r===s){o=2+(n-t)/a}else if(n===s){o=4+(t-r)/a}o=Math.min(o*60,360);if(o<0){o+=360}c=(i+s)/2;if(s===i){l=0}else if(c<=.5){l=a/(s+i)}else{l=a/(2-s-i)}return[o,l*100,c*100]};a.rgb.hsv=function(e){var t;var r;var n;var i;var s;var a=e[0]/255;var o=e[1]/255;var l=e[2]/255;var c=Math.max(a,o,l);var u=c-Math.min(a,o,l);var diffc=function(e){return(c-e)/6/u+1/2};if(u===0){i=s=0}else{s=u/c;t=diffc(a);r=diffc(o);n=diffc(l);if(a===c){i=n-r}else if(o===c){i=1/3+t-n}else if(l===c){i=2/3+r-t}if(i<0){i+=1}else if(i>1){i-=1}}return[i*360,s*100,c*100]};a.rgb.hwb=function(e){var t=e[0];var r=e[1];var n=e[2];var i=a.rgb.hsl(e)[0];var s=1/255*Math.min(t,Math.min(r,n));n=1-1/255*Math.max(t,Math.max(r,n));return[i,s*100,n*100]};a.rgb.cmyk=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;var i;var s;var a;var o;o=Math.min(1-t,1-r,1-n);i=(1-t-o)/(1-o)||0;s=(1-r-o)/(1-o)||0;a=(1-n-o)/(1-o)||0;return[i*100,s*100,a*100,o*100]};function comparativeDistance(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2)}a.rgb.keyword=function(e){var t=i[e];if(t){return t}var r=Infinity;var s;for(var a in n){if(n.hasOwnProperty(a)){var o=n[a];var l=comparativeDistance(e,o);if(l<r){r=l;s=a}}}return s};a.keyword.rgb=function(e){return n[e]};a.rgb.xyz=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var i=t*.4124+r*.3576+n*.1805;var s=t*.2126+r*.7152+n*.0722;var a=t*.0193+r*.1192+n*.9505;return[i*100,s*100,a*100]};a.rgb.lab=function(e){var t=a.rgb.xyz(e);var r=t[0];var n=t[1];var i=t[2];var s;var o;var l;r/=95.047;n/=100;i/=108.883;r=r>.008856?Math.pow(r,1/3):7.787*r+16/116;n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;i=i>.008856?Math.pow(i,1/3):7.787*i+16/116;s=116*n-16;o=500*(r-n);l=200*(n-i);return[s,o,l]};a.hsl.rgb=function(e){var t=e[0]/360;var r=e[1]/100;var n=e[2]/100;var i;var s;var a;var o;var l;if(r===0){l=n*255;return[l,l,l]}if(n<.5){s=n*(1+r)}else{s=n+r-n*r}i=2*n-s;o=[0,0,0];for(var c=0;c<3;c++){a=t+1/3*-(c-1);if(a<0){a++}if(a>1){a--}if(6*a<1){l=i+(s-i)*6*a}else if(2*a<1){l=s}else if(3*a<2){l=i+(s-i)*(2/3-a)*6}else{l=i}o[c]=l*255}return o};a.hsl.hsv=function(e){var t=e[0];var r=e[1]/100;var n=e[2]/100;var i=r;var s=Math.max(n,.01);var a;var o;n*=2;r*=n<=1?n:2-n;i*=s<=1?s:2-s;o=(n+r)/2;a=n===0?2*i/(s+i):2*r/(n+r);return[t,a*100,o*100]};a.hsv.rgb=function(e){var t=e[0]/60;var r=e[1]/100;var n=e[2]/100;var i=Math.floor(t)%6;var s=t-Math.floor(t);var a=255*n*(1-r);var o=255*n*(1-r*s);var l=255*n*(1-r*(1-s));n*=255;switch(i){case 0:return[n,l,a];case 1:return[o,n,a];case 2:return[a,n,l];case 3:return[a,o,n];case 4:return[l,a,n];case 5:return[n,a,o]}};a.hsv.hsl=function(e){var t=e[0];var r=e[1]/100;var n=e[2]/100;var i=Math.max(n,.01);var s;var a;var o;o=(2-r)*n;s=(2-r)*i;a=r*i;a/=s<=1?s:2-s;a=a||0;o/=2;return[t,a*100,o*100]};a.hwb.rgb=function(e){var t=e[0]/360;var r=e[1]/100;var n=e[2]/100;var i=r+n;var s;var a;var o;var l;if(i>1){r/=i;n/=i}s=Math.floor(6*t);a=1-n;o=6*t-s;if((s&1)!==0){o=1-o}l=r+o*(a-r);var c;var u;var d;switch(s){default:case 6:case 0:c=a;u=l;d=r;break;case 1:c=l;u=a;d=r;break;case 2:c=r;u=a;d=l;break;case 3:c=r;u=l;d=a;break;case 4:c=l;u=r;d=a;break;case 5:c=a;u=r;d=l;break}return[c*255,u*255,d*255]};a.cmyk.rgb=function(e){var t=e[0]/100;var r=e[1]/100;var n=e[2]/100;var i=e[3]/100;var s;var a;var o;s=1-Math.min(1,t*(1-i)+i);a=1-Math.min(1,r*(1-i)+i);o=1-Math.min(1,n*(1-i)+i);return[s*255,a*255,o*255]};a.xyz.rgb=function(e){var t=e[0]/100;var r=e[1]/100;var n=e[2]/100;var i;var s;var a;i=t*3.2406+r*-1.5372+n*-.4986;s=t*-.9689+r*1.8758+n*.0415;a=t*.0557+r*-.204+n*1.057;i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*12.92;s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*12.92;a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*12.92;i=Math.min(Math.max(0,i),1);s=Math.min(Math.max(0,s),1);a=Math.min(Math.max(0,a),1);return[i*255,s*255,a*255]};a.xyz.lab=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var s;var a;t/=95.047;r/=100;n/=108.883;t=t>.008856?Math.pow(t,1/3):7.787*t+16/116;r=r>.008856?Math.pow(r,1/3):7.787*r+16/116;n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;i=116*r-16;s=500*(t-r);a=200*(r-n);return[i,s,a]};a.lab.xyz=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var s;var a;s=(t+16)/116;i=r/500+s;a=s-n/200;var o=Math.pow(s,3);var l=Math.pow(i,3);var c=Math.pow(a,3);s=o>.008856?o:(s-16/116)/7.787;i=l>.008856?l:(i-16/116)/7.787;a=c>.008856?c:(a-16/116)/7.787;i*=95.047;s*=100;a*=108.883;return[i,s,a]};a.lab.lch=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var s;var a;i=Math.atan2(n,r);s=i*360/2/Math.PI;if(s<0){s+=360}a=Math.sqrt(r*r+n*n);return[t,a,s]};a.lch.lab=function(e){var t=e[0];var r=e[1];var n=e[2];var i;var s;var a;a=n/360*2*Math.PI;i=r*Math.cos(a);s=r*Math.sin(a);return[t,i,s]};a.rgb.ansi16=function(e){var t=e[0];var r=e[1];var n=e[2];var i=1 in arguments?arguments[1]:a.rgb.hsv(e)[2];i=Math.round(i/50);if(i===0){return 30}var s=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));if(i===2){s+=60}return s};a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])};a.rgb.ansi256=function(e){var t=e[0];var r=e[1];var n=e[2];if(t===r&&r===n){if(t<8){return 16}if(t>248){return 231}return Math.round((t-8)/247*24)+232}var i=16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5);return i};a.ansi16.rgb=function(e){var t=e%10;if(t===0||t===7){if(e>50){t+=3.5}t=t/10.5*255;return[t,t,t]}var r=(~~(e>50)+1)*.5;var n=(t&1)*r*255;var i=(t>>1&1)*r*255;var s=(t>>2&1)*r*255;return[n,i,s]};a.ansi256.rgb=function(e){if(e>=232){var t=(e-232)*10+8;return[t,t,t]}e-=16;var r;var n=Math.floor(e/36)/5*255;var i=Math.floor((r=e%36)/6)/5*255;var s=r%6/5*255;return[n,i,s]};a.rgb.hex=function(e){var t=((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255);var r=t.toString(16).toUpperCase();return"000000".substring(r.length)+r};a.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t){return[0,0,0]}var r=t[0];if(t[0].length===3){r=r.split("").map((function(e){return e+e})).join("")}var n=parseInt(r,16);var i=n>>16&255;var s=n>>8&255;var a=n&255;return[i,s,a]};a.rgb.hcg=function(e){var t=e[0]/255;var r=e[1]/255;var n=e[2]/255;var i=Math.max(Math.max(t,r),n);var s=Math.min(Math.min(t,r),n);var a=i-s;var o;var l;if(a<1){o=s/(1-a)}else{o=0}if(a<=0){l=0}else if(i===t){l=(r-n)/a%6}else if(i===r){l=2+(n-t)/a}else{l=4+(t-r)/a+4}l/=6;l%=1;return[l*360,a*100,o*100]};a.hsl.hcg=function(e){var t=e[1]/100;var r=e[2]/100;var n=1;var i=0;if(r<.5){n=2*t*r}else{n=2*t*(1-r)}if(n<1){i=(r-.5*n)/(1-n)}return[e[0],n*100,i*100]};a.hsv.hcg=function(e){var t=e[1]/100;var r=e[2]/100;var n=t*r;var i=0;if(n<1){i=(r-n)/(1-n)}return[e[0],n*100,i*100]};a.hcg.rgb=function(e){var t=e[0]/360;var r=e[1]/100;var n=e[2]/100;if(r===0){return[n*255,n*255,n*255]}var i=[0,0,0];var s=t%1*6;var a=s%1;var o=1-a;var l=0;switch(Math.floor(s)){case 0:i[0]=1;i[1]=a;i[2]=0;break;case 1:i[0]=o;i[1]=1;i[2]=0;break;case 2:i[0]=0;i[1]=1;i[2]=a;break;case 3:i[0]=0;i[1]=o;i[2]=1;break;case 4:i[0]=a;i[1]=0;i[2]=1;break;default:i[0]=1;i[1]=0;i[2]=o}l=(1-r)*n;return[(r*i[0]+l)*255,(r*i[1]+l)*255,(r*i[2]+l)*255]};a.hcg.hsv=function(e){var t=e[1]/100;var r=e[2]/100;var n=t+r*(1-t);var i=0;if(n>0){i=t/n}return[e[0],i*100,n*100]};a.hcg.hsl=function(e){var t=e[1]/100;var r=e[2]/100;var n=r*(1-t)+.5*t;var i=0;if(n>0&&n<.5){i=t/(2*n)}else if(n>=.5&&n<1){i=t/(2*(1-n))}return[e[0],i*100,n*100]};a.hcg.hwb=function(e){var t=e[1]/100;var r=e[2]/100;var n=t+r*(1-t);return[e[0],(n-t)*100,(1-n)*100]};a.hwb.hcg=function(e){var t=e[1]/100;var r=e[2]/100;var n=1-r;var i=n-t;var s=0;if(i<1){s=(n-i)/(1-i)}return[e[0],i*100,s*100]};a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};a.gray.hsl=a.gray.hsv=function(e){return[0,0,e[0]]};a.gray.hwb=function(e){return[0,100,e[0]]};a.gray.cmyk=function(e){return[0,0,0,e[0]]};a.gray.lab=function(e){return[e[0],0,0]};a.gray.hex=function(e){var t=Math.round(e[0]/100*255)&255;var r=(t<<16)+(t<<8)+t;var n=r.toString(16).toUpperCase();return"000000".substring(n.length)+n};a.rgb.gray=function(e){var t=(e[0]+e[1]+e[2])/3;return[t/255*100]}},241:(e,t,r)=>{var n=r(5479);var i=r(8110);var s={};var a=Object.keys(n);function wrapRaw(e){var wrappedFn=function(t){if(t===undefined||t===null){return t}if(arguments.length>1){t=Array.prototype.slice.call(arguments)}return e(t)};if("conversion"in e){wrappedFn.conversion=e.conversion}return wrappedFn}function wrapRounded(e){var wrappedFn=function(t){if(t===undefined||t===null){return t}if(arguments.length>1){t=Array.prototype.slice.call(arguments)}var r=e(t);if(typeof r==="object"){for(var n=r.length,i=0;i<n;i++){r[i]=Math.round(r[i])}}return r};if("conversion"in e){wrappedFn.conversion=e.conversion}return wrappedFn}a.forEach((function(e){s[e]={};Object.defineProperty(s[e],"channels",{value:n[e].channels});Object.defineProperty(s[e],"labels",{value:n[e].labels});var t=i(e);var r=Object.keys(t);r.forEach((function(r){var n=t[r];s[e][r]=wrapRounded(n);s[e][r].raw=wrapRaw(n)}))}));e.exports=s},8110:(e,t,r)=>{var n=r(5479);function buildGraph(){var e={};var t=Object.keys(n);for(var r=t.length,i=0;i<r;i++){e[t[i]]={distance:-1,parent:null}}return e}function deriveBFS(e){var t=buildGraph();var r=[e];t[e].distance=0;while(r.length){var i=r.pop();var s=Object.keys(n[i]);for(var a=s.length,o=0;o<a;o++){var l=s[o];var c=t[l];if(c.distance===-1){c.distance=t[i].distance+1;c.parent=i;r.unshift(l)}}}return t}function link(e,t){return function(r){return t(e(r))}}function wrapConversion(e,t){var r=[t[e].parent,e];var i=n[t[e].parent][e];var s=t[e].parent;while(t[s].parent){r.unshift(t[s].parent);i=link(n[t[s].parent][s],i);s=t[s].parent}i.conversion=r;return i}e.exports=function(e){var t=deriveBFS(e);var r={};var n=Object.keys(t);for(var i=n.length,s=0;s<i;s++){var a=n[s];var o=t[a];if(o.parent===null){continue}r[a]=wrapConversion(a,t)}return r}},74:e=>{e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},5917:(e,t,r)=>{var n=r(7177),i=r(7014);e.exports=function colorspace(e,t){var r=e.split(t||":");var s=i(r[0]);if(!r.length)return s;for(var a=0,o=r.length-1;a<o;a++){s=n(s).mix(n(i(r[a+1]))).saturate(1).hex()}return s}},3495:e=>{e.exports=function enabled(e,t){if(!t)return false;var r=t.split(/[\s,]+/),n=0;for(;n<r.length;n++){t=r[n].replace("*",".*?");if("-"===t.charAt(0)){if(new RegExp("^"+t.substr(1)+"$").test(e)){return false}continue}if(new RegExp("^"+t+"$").test(e)){return true}}return false}},4513:function(e,t){(function(e,r){true?r(t):0})(this,(function(e){"use strict";var t=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g;var r="\\d\\d?";var n="\\d\\d";var i="\\d{3}";var s="\\d{4}";var a="[^\\s]+";var o=/\[([^]*?)\]/gm;function shorten(e,t){var r=[];for(var n=0,i=e.length;n<i;n++){r.push(e[n].substr(0,t))}return r}var monthUpdate=function(e){return function(t,r){var n=r[e].map((function(e){return e.toLowerCase()}));var i=n.indexOf(t.toLowerCase());if(i>-1){return i}return null}};function assign(e){var t=[];for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}for(var n=0,i=t;n<i.length;n++){var s=i[n];for(var a in s){e[a]=s[a]}}return e}var l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var c=["January","February","March","April","May","June","July","August","September","October","November","December"];var u=shorten(c,3);var d=shorten(l,3);var f={dayNamesShort:d,dayNames:l,monthNamesShort:u,monthNames:c,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!==10?1:0)*e%10]}};var h=assign({},f);var setGlobalDateI18n=function(e){return h=assign(h,e)};var regexEscape=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")};var pad=function(e,t){if(t===void 0){t=2}e=String(e);while(e.length<t){e="0"+e}return e};var p={D:function(e){return String(e.getDate())},DD:function(e){return pad(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return pad(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return pad(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return pad(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return pad(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return pad(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return pad(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return pad(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return pad(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return pad(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return pad(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+pad(Math.floor(Math.abs(t)/60)*100+Math.abs(t)%60,4)},Z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+pad(Math.floor(Math.abs(t)/60),2)+":"+pad(Math.abs(t)%60,2)}};var monthParse=function(e){return+e-1};var g=[null,r];var m=[null,a];var v=["isPm",a,function(e,t){var r=e.toLowerCase();if(r===t.amPm[0]){return 0}else if(r===t.amPm[1]){return 1}return null}];var y=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var t=(e+"").match(/([+-]|\d\d)/gi);if(t){var r=+t[1]*60+parseInt(t[2],10);return t[0]==="+"?r:-r}return 0}];var b={D:["day",r],DD:["day",n],Do:["day",r+a,function(e){return parseInt(e,10)}],M:["month",r,monthParse],MM:["month",n,monthParse],YY:["year",n,function(e){var t=new Date;var r=+(""+t.getFullYear()).substr(0,2);return+(""+(+e>68?r-1:r)+e)}],h:["hour",r,undefined,"isPm"],hh:["hour",n,undefined,"isPm"],H:["hour",r],HH:["hour",n],m:["minute",r],mm:["minute",n],s:["second",r],ss:["second",n],YYYY:["year",s],S:["millisecond","\\d",function(e){return+e*100}],SS:["millisecond",n,function(e){return+e*10}],SSS:["millisecond",i],d:g,dd:g,ddd:m,dddd:m,MMM:["month",a,monthUpdate("monthNamesShort")],MMMM:["month",a,monthUpdate("monthNames")],a:v,A:v,ZZ:y,Z:y};var S={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"};var setGlobalDateMasks=function(e){return assign(S,e)};var format=function(e,r,n){if(r===void 0){r=S["default"]}if(n===void 0){n={}}if(typeof e==="number"){e=new Date(e)}if(Object.prototype.toString.call(e)!=="[object Date]"||isNaN(e.getTime())){throw new Error("Invalid Date pass to format")}r=S[r]||r;var i=[];r=r.replace(o,(function(e,t){i.push(t);return"@@@"}));var s=assign(assign({},h),n);r=r.replace(t,(function(t){return p[t](e,s)}));return r.replace(/@@@/g,(function(){return i.shift()}))};function parse(e,r,n){if(n===void 0){n={}}if(typeof r!=="string"){throw new Error("Invalid format in fecha parse")}r=S[r]||r;if(e.length>1e3){return null}var i=new Date;var s={year:i.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null};var a=[];var l=[];var c=r.replace(o,(function(e,t){l.push(regexEscape(t));return"@@@"}));var u={};var d={};c=regexEscape(c).replace(t,(function(e){var t=b[e];var r=t[0],n=t[1],i=t[3];if(u[r]){throw new Error("Invalid format. "+r+" specified twice in format")}u[r]=true;if(i){d[i]=true}a.push(t);return"("+n+")"}));Object.keys(d).forEach((function(e){if(!u[e]){throw new Error("Invalid format. "+e+" is required in specified format")}}));c=c.replace(/@@@/g,(function(){return l.shift()}));var f=e.match(new RegExp(c,"i"));if(!f){return null}var p=assign(assign({},h),n);for(var g=1;g<f.length;g++){var m=a[g-1],v=m[0],y=m[2];var _=y?y(f[g],p):+f[g];if(_==null){return null}s[v]=_}if(s.isPm===1&&s.hour!=null&&+s.hour!==12){s.hour=+s.hour+12}else if(s.isPm===0&&+s.hour===12){s.hour=0}var w;if(s.timezoneOffset==null){w=new Date(s.year,s.month,s.day,s.hour,s.minute,s.second,s.millisecond);var C=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]];for(var g=0,E=C.length;g<E;g++){if(u[C[g][0]]&&s[C[g][0]]!==w[C[g][1]]()){return null}}}else{w=new Date(Date.UTC(s.year,s.month,s.day,s.hour,s.minute-s.timezoneOffset,s.second,s.millisecond));if(s.month>11||s.month<0||s.day>31||s.day<1||s.hour>23||s.hour<0||s.minute>59||s.minute<0||s.second>59||s.second<0){return null}}return w}var _={format:format,parse:parse,defaultI18n:f,setGlobalDateI18n:setGlobalDateI18n,setGlobalDateMasks:setGlobalDateMasks};e.assign=assign;e.default=_;e.format=format;e.parse=parse;e.defaultI18n=f;e.setGlobalDateI18n=setGlobalDateI18n;e.setGlobalDateMasks=setGlobalDateMasks;Object.defineProperty(e,"__esModule",{value:true})}))},2743:e=>{var t=Object.prototype.toString;e.exports=function name(e){if("string"===typeof e.displayName&&e.constructor.name){return e.displayName}else if("string"===typeof e.name&&e.name){return e.name}if("object"===typeof e&&e.constructor&&"string"===typeof e.constructor.name)return e.constructor.name;var r=e.toString(),n=t.call(e).slice(8,-1);if("Function"===n){r=r.substring(r.indexOf("(")+1,r.indexOf(")"))}else{r=n}return r||"anonymous"}},4124:(e,t,r)=>{try{var n=r(3837);if(typeof n.inherits!=="function")throw"";e.exports=n.inherits}catch(t){e.exports=r(8544)}},8544:e=>{if(typeof Object.create==="function"){e.exports=function inherits(e,t){if(t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}}else{e.exports=function inherits(e,t){if(t){e.super_=t;var TempCtor=function(){};TempCtor.prototype=t.prototype;e.prototype=new TempCtor;e.prototype.constructor=e}}}},1554:e=>{const isStream=e=>e!==null&&typeof e==="object"&&typeof e.pipe==="function";isStream.writable=e=>isStream(e)&&e.writable!==false&&typeof e._write==="function"&&typeof e._writableState==="object";isStream.readable=e=>isStream(e)&&e.readable!==false&&typeof e._read==="function"&&typeof e._readableState==="object";isStream.duplex=e=>isStream.writable(e)&&isStream.readable(e);isStream.transform=e=>isStream.duplex(e)&&typeof e._transform==="function";e.exports=isStream},6287:e=>{function Kuler(e,t){if(t)return new Kuler(e).style(t);if(!(this instanceof Kuler))return new Kuler(e);this.text=e}Kuler.prototype.prefix="[";Kuler.prototype.suffix="m";Kuler.prototype.hex=function hex(e){e=e[0]==="#"?e.substring(1):e;if(e.length===3){e=e.split("");e[5]=e[2];e[4]=e[2];e[3]=e[1];e[2]=e[1];e[1]=e[0];e=e.join("")}var t=e.substring(0,2),r=e.substring(2,4),n=e.substring(4,6);return[parseInt(t,16),parseInt(r,16),parseInt(n,16)]};Kuler.prototype.rgb=function rgb(e,t,r){var n=e/255*5,i=t/255*5,s=r/255*5;return this.ansi(n,i,s)};Kuler.prototype.ansi=function ansi(e,t,r){var n=Math.round(e),i=Math.round(t),s=Math.round(r);return 16+n*36+i*6+s};Kuler.prototype.reset=function reset(){return this.prefix+"39;49"+this.suffix};Kuler.prototype.style=function style(e){return this.prefix+"38;5;"+this.rgb.apply(this,this.hex(e))+this.suffix+this.text+this.reset()};e.exports=Kuler},7994:e=>{var t=1/0;var r="[object Symbol]";var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var i=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;var s="\\ud800-\\udfff",a="\\u0300-\\u036f\\ufe20-\\ufe23",o="\\u20d0-\\u20f0",l="\\u2700-\\u27bf",c="a-z\\xdf-\\xf6\\xf8-\\xff",u="\\xac\\xb1\\xd7\\xf7",d="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",f="\\u2000-\\u206f",h=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",p="A-Z\\xc0-\\xd6\\xd8-\\xde",g="\\ufe0e\\ufe0f",m=u+d+f+h;var v="[']",y="["+s+"]",b="["+m+"]",S="["+a+o+"]",_="\\d+",w="["+l+"]",C="["+c+"]",E="[^"+s+m+_+l+c+p+"]",T="\\ud83c[\\udffb-\\udfff]",R="(?:"+S+"|"+T+")",k="[^"+s+"]",O="(?:\\ud83c[\\udde6-\\uddff]){2}",M="[\\ud800-\\udbff][\\udc00-\\udfff]",x="["+p+"]",A="\\u200d";var P="(?:"+C+"|"+E+")",N="(?:"+x+"|"+E+")",I="(?:"+v+"(?:d|ll|m|re|s|t|ve))?",D="(?:"+v+"(?:D|LL|M|RE|S|T|VE))?",L=R+"?",j="["+g+"]?",B="(?:"+A+"(?:"+[k,O,M].join("|")+")"+j+L+")*",F=j+L+B,U="(?:"+[w,O,M].join("|")+")"+F,z="(?:"+[k+S+"?",S,O,M,y].join("|")+")";var H=RegExp(v,"g");var W=RegExp(S,"g");var q=RegExp(T+"(?="+T+")|"+z+F,"g");var $=RegExp([x+"?"+C+"+"+I+"(?="+[b,x,"$"].join("|")+")",N+"+"+D+"(?="+[b,x+P,"$"].join("|")+")",x+"?"+P+"+"+I,x+"+"+D,_,U].join("|"),"g");var G=RegExp("["+A+s+a+o+g+"]");var V=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Y={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"ss"};var K=typeof global=="object"&&global&&global.Object===Object&&global;var J=typeof self=="object"&&self&&self.Object===Object&&self;var X=K||J||Function("return this")();function arrayReduce(e,t,r,n){var i=-1,s=e?e.length:0;if(n&&s){r=e[++i]}while(++i<s){r=t(r,e[i],i,e)}return r}function asciiToArray(e){return e.split("")}function asciiWords(e){return e.match(n)||[]}function basePropertyOf(e){return function(t){return e==null?undefined:e[t]}}var Z=basePropertyOf(Y);function hasUnicode(e){return G.test(e)}function hasUnicodeWord(e){return V.test(e)}function stringToArray(e){return hasUnicode(e)?unicodeToArray(e):asciiToArray(e)}function unicodeToArray(e){return e.match(q)||[]}function unicodeWords(e){return e.match($)||[]}var Q=Object.prototype;var ee=Q.toString;var te=X.Symbol;var re=te?te.prototype:undefined,ne=re?re.toString:undefined;function baseSlice(e,t,r){var n=-1,i=e.length;if(t<0){t=-t>i?0:i+t}r=r>i?i:r;if(r<0){r+=i}i=t>r?0:r-t>>>0;t>>>=0;var s=Array(i);while(++n<i){s[n]=e[n+t]}return s}function baseToString(e){if(typeof e=="string"){return e}if(isSymbol(e)){return ne?ne.call(e):""}var r=e+"";return r=="0"&&1/e==-t?"-0":r}function castSlice(e,t,r){var n=e.length;r=r===undefined?n:r;return!t&&r>=n?e:baseSlice(e,t,r)}function createCaseFirst(e){return function(t){t=toString(t);var r=hasUnicode(t)?stringToArray(t):undefined;var n=r?r[0]:t.charAt(0);var i=r?castSlice(r,1).join(""):t.slice(1);return n[e]()+i}}function createCompounder(e){return function(t){return arrayReduce(words(deburr(t).replace(H,"")),e,"")}}function isObjectLike(e){return!!e&&typeof e=="object"}function isSymbol(e){return typeof e=="symbol"||isObjectLike(e)&&ee.call(e)==r}function toString(e){return e==null?"":baseToString(e)}var ie=createCompounder((function(e,t,r){t=t.toLowerCase();return e+(r?capitalize(t):t)}));function capitalize(e){return se(toString(e).toLowerCase())}function deburr(e){e=toString(e);return e&&e.replace(i,Z).replace(W,"")}var se=createCaseFirst("toUpperCase");function words(e,t,r){e=toString(e);t=r?undefined:t;if(t===undefined){return hasUnicodeWord(e)?unicodeWords(e):asciiWords(e)}return e.match(t)||[]}e.exports=ie},9748:(e,t,r)=>{const n=r(3791);e.exports=n((e=>{e.message=`\t${e.message}`;return e}))},6811:(e,t,r)=>{const{Colorizer:n}=r(3848);const{Padder:i}=r(7033);const{configs:s,MESSAGE:a}=r(3937);class CliFormat{constructor(e={}){if(!e.levels){e.levels=s.cli.levels}this.colorizer=new n(e);this.padder=new i(e);this.options=e}transform(e,t){this.colorizer.transform(this.padder.transform(e,t),t);e[a]=`${e.level}:${e.message}`;return e}}e.exports=e=>new CliFormat(e);e.exports.Format=CliFormat},3848:(e,t,r)=>{const n=r(6009);const{LEVEL:i,MESSAGE:s}=r(3937);n.enabled=true;const a=/\s+/;class Colorizer{constructor(e={}){if(e.colors){this.addColors(e.colors)}this.options=e}static addColors(e){const t=Object.keys(e).reduce(((t,r)=>{t[r]=a.test(e[r])?e[r].split(a):e[r];return t}),{});Colorizer.allColors=Object.assign({},Colorizer.allColors||{},t);return Colorizer.allColors}addColors(e){return Colorizer.addColors(e)}colorize(e,t,r){if(typeof r==="undefined"){r=t}if(!Array.isArray(Colorizer.allColors[e])){return n[Colorizer.allColors[e]](r)}for(let t=0,i=Colorizer.allColors[e].length;t<i;t++){r=n[Colorizer.allColors[e][t]](r)}return r}transform(e,t){if(t.all&&typeof e[s]==="string"){e[s]=this.colorize(e[i],e.level,e[s])}if(t.level||t.all||!t.message){e.level=this.colorize(e[i],e.level)}if(t.all||t.message){e.message=this.colorize(e[i],e.level,e.message)}return e}}e.exports=e=>new Colorizer(e);e.exports.Colorizer=e.exports.Format=Colorizer},7315:(e,t,r)=>{const n=r(3791);function cascade(e){if(!e.every(isValidFormat)){return}return t=>{let r=t;for(let t=0;t<e.length;t++){r=e[t].transform(r,e[t].options);if(!r){return false}}return r}}function isValidFormat(e){if(typeof e.transform!=="function"){throw new Error(["No transform function found on format. Did you create a format instance?","const myFormat = format(formatFn);","const instance = myFormat();"].join("\n"))}return true}e.exports=(...e)=>{const t=n(cascade(e));const r=t();r.Format=t.Format;return r};e.exports.cascade=cascade},2397:(e,t,r)=>{const n=r(3791);const{LEVEL:i,MESSAGE:s}=r(3937);e.exports=n(((e,{stack:t,cause:r})=>{if(e instanceof Error){const n=Object.assign({},e,{level:e.level,[i]:e[i]||e.level,message:e.message,[s]:e[s]||e.message});if(t)n.stack=e.stack;if(r)n.cause=e.cause;return n}if(!(e.message instanceof Error))return e;const n=e.message;Object.assign(e,n);e.message=n.message;e[s]=n.message;if(t)e.stack=n.stack;if(r)e.cause=n.cause;return e}))},3791:e=>{class InvalidFormatError extends Error{constructor(e){super(`Format functions must be synchronous taking a two arguments: (info, opts)\nFound: ${e.toString().split("\n")[0]}\n`);Error.captureStackTrace(this,InvalidFormatError)}}e.exports=e=>{if(e.length>2){throw new InvalidFormatError(e)}function Format(e={}){this.options=e}Format.prototype.transform=e;function createFormatWrap(e){return new Format(e)}createFormatWrap.Format=Format;return createFormatWrap}},2955:(e,t,r)=>{const n=t.format=r(3791);t.levels=r(3180);function exposeFormat(e,t){Object.defineProperty(n,e,{get(){return t()},configurable:true})}exposeFormat("align",(function(){return r(9748)}));exposeFormat("errors",(function(){return r(2397)}));exposeFormat("cli",(function(){return r(6811)}));exposeFormat("combine",(function(){return r(7315)}));exposeFormat("colorize",(function(){return r(3848)}));exposeFormat("json",(function(){return r(5669)}));exposeFormat("label",(function(){return r(6941)}));exposeFormat("logstash",(function(){return r(4772)}));exposeFormat("metadata",(function(){return r(9760)}));exposeFormat("ms",(function(){return r(4734)}));exposeFormat("padLevels",(function(){return r(7033)}));exposeFormat("prettyPrint",(function(){return r(6182)}));exposeFormat("printf",(function(){return r(1843)}));exposeFormat("simple",(function(){return r(5313)}));exposeFormat("splat",(function(){return r(7081)}));exposeFormat("timestamp",(function(){return r(8381)}));exposeFormat("uncolorize",(function(){return r(6420)}))},5669:(e,t,r)=>{const n=r(3791);const{MESSAGE:i}=r(3937);const s=r(7560);function replacer(e,t){if(typeof t==="bigint")return t.toString();return t}e.exports=n(((e,t)=>{const r=s.configure(t);e[i]=r(e,t.replacer||replacer,t.space);return e}))},6941:(e,t,r)=>{const n=r(3791);e.exports=n(((e,t)=>{if(t.message){e.message=`[${t.label}] ${e.message}`;return e}e.label=t.label;return e}))},3180:(e,t,r)=>{const{Colorizer:n}=r(3848);e.exports=e=>{n.addColors(e.colors||e);return e}},4772:(e,t,r)=>{const n=r(3791);const{MESSAGE:i}=r(3937);const s=r(7560);e.exports=n((e=>{const t={};if(e.message){t["@message"]=e.message;delete e.message}if(e.timestamp){t["@timestamp"]=e.timestamp;delete e.timestamp}t["@fields"]=e;e[i]=s(t);return e}))},9760:(e,t,r)=>{const n=r(3791);function fillExcept(e,t,r){const n=t.reduce(((t,r)=>{t[r]=e[r];delete e[r];return t}),{});const i=Object.keys(e).reduce(((t,r)=>{t[r]=e[r];delete e[r];return t}),{});Object.assign(e,n,{[r]:i});return e}function fillWith(e,t,r){e[r]=t.reduce(((t,r)=>{t[r]=e[r];delete e[r];return t}),{});return e}e.exports=n(((e,t={})=>{let r="metadata";if(t.key){r=t.key}let n=[];if(!t.fillExcept&&!t.fillWith){n.push("level");n.push("message")}if(t.fillExcept){n=t.fillExcept}if(n.length>0){return fillExcept(e,n,r)}if(t.fillWith){return fillWith(e,t.fillWith,r)}return e}))},4734:function(e,t,r){const n=r(3791);const i=r(900);e.exports=n((e=>{const t=+new Date;this.diff=t-(this.prevTime||t);this.prevTime=t;e.ms=`+${i(this.diff)}`;return e}))},1101:(e,t,r)=>{var n={};e["exports"]=n;n.themes={};var i=r(3837);var s=n.styles=r(8802);var a=Object.defineProperties;var o=new RegExp(/[\r\n]+/g);n.supportsColor=r(5758).supportsColor;if(typeof n.enabled==="undefined"){n.enabled=n.supportsColor()!==false}n.enable=function(){n.enabled=true};n.disable=function(){n.enabled=false};n.stripColors=n.strip=function(e){return(""+e).replace(/\x1B\[\d+m/g,"")};var l=n.stylize=function stylize(e,t){if(!n.enabled){return e+""}var r=s[t];if(!r&&t in n){return n[t](e)}return r.open+e+r.close};var c=/[|\\{}()[\]^$+*?.]/g;var escapeStringRegexp=function(e){if(typeof e!=="string"){throw new TypeError("Expected a string")}return e.replace(c,"\\$&")};function build(e){var t=function builder(){return applyStyle.apply(builder,arguments)};t._styles=e;t.__proto__=d;return t}var u=function(){var e={};s.grey=s.gray;Object.keys(s).forEach((function(t){s[t].closeRe=new RegExp(escapeStringRegexp(s[t].close),"g");e[t]={get:function(){return build(this._styles.concat(t))}}}));return e}();var d=a((function colors(){}),u);function applyStyle(){var e=Array.prototype.slice.call(arguments);var t=e.map((function(e){if(e!=null&&e.constructor===String){return e}else{return i.inspect(e)}})).join(" ");if(!n.enabled||!t){return t}var r=t.indexOf("\n")!=-1;var a=this._styles;var l=a.length;while(l--){var c=s[a[l]];t=c.open+t.replace(c.closeRe,c.open)+c.close;if(r){t=t.replace(o,(function(e){return c.close+e+c.open}))}}return t}n.setTheme=function(e){if(typeof e==="string"){console.log("colors.setTheme now only accepts an object, not a string.  "+"If you are trying to set a theme from a file, it is now your (the "+"caller's) responsibility to require the file.  The old syntax "+"looked like colors.setTheme(__dirname + "+"'/../themes/generic-logging.js'); The new syntax looks like "+"colors.setTheme(require(__dirname + "+"'/../themes/generic-logging.js'));");return}for(var t in e){(function(t){n[t]=function(r){if(typeof e[t]==="object"){var i=r;for(var s in e[t]){i=n[e[t][s]](i)}return i}return n[e[t]](r)}})(t)}};function init(){var e={};Object.keys(u).forEach((function(t){e[t]={get:function(){return build([t])}}}));return e}var f=function sequencer(e,t){var r=t.split("");r=r.map(e);return r.join("")};n.trap=r(9859);n.zalgo=r(1958);n.maps={};n.maps.america=r(581)(n);n.maps.zebra=r(5623)(n);n.maps.rainbow=r(7569)(n);n.maps.random=r(5179)(n);for(var h in n.maps){(function(e){n[e]=function(t){return f(n.maps[e],t)}})(h)}a(n,init())},9859:e=>{e["exports"]=function runTheTrap(e,t){var r="";e=e||"Run the trap, drop the bass";e=e.split("");var n={a:["@","","","","","",""],b:["","","","","",""],c:["","",""],d:["","","","","",""],e:["","","","","","","",""],f:[""],g:[""],h:["","","","","",""],i:[""],j:[""],k:["","","",""],l:[""],m:["","","","","",""],n:["","","","","",""],o:["","","","","","","","",""],p:["",""],q:[""],r:["","","","","",""],s:["","","",""],t:["","",""],u:["",""],v:[""],w:["","","",""],x:["","","",""],y:["","",""],z:["",""]};e.forEach((function(e){e=e.toLowerCase();var t=n[e]||[" "];var i=Math.floor(Math.random()*t.length);if(typeof n[e]!=="undefined"){r+=n[e][i]}else{r+=e}}));return r}},1958:e=>{e["exports"]=function zalgo(e,t){e=e||"   he is here   ";var r={up:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],down:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],mid:["","","","","","","","","","","","","","","","","","","","",""," "]};var n=[].concat(r.up,r.down,r.mid);function randomNumber(e){var t=Math.floor(Math.random()*e);return t}function isChar(e){var t=false;n.filter((function(r){t=r===e}));return t}function heComes(e,t){var n="";var i;var s;t=t||{};t["up"]=typeof t["up"]!=="undefined"?t["up"]:true;t["mid"]=typeof t["mid"]!=="undefined"?t["mid"]:true;t["down"]=typeof t["down"]!=="undefined"?t["down"]:true;t["size"]=typeof t["size"]!=="undefined"?t["size"]:"maxi";e=e.split("");for(s in e){if(isChar(s)){continue}n=n+e[s];i={up:0,down:0,mid:0};switch(t.size){case"mini":i.up=randomNumber(8);i.mid=randomNumber(2);i.down=randomNumber(8);break;case"maxi":i.up=randomNumber(16)+3;i.mid=randomNumber(4)+1;i.down=randomNumber(64)+3;break;default:i.up=randomNumber(8)+1;i.mid=randomNumber(6)/2;i.down=randomNumber(8)+1;break}var a=["up","mid","down"];for(var o in a){var l=a[o];for(var c=0;c<=i[l];c++){if(t[l]){n=n+r[l][randomNumber(r[l].length)]}}}}return n}return heComes(e,t)}},581:e=>{e["exports"]=function(e){return function(t,r,n){if(t===" ")return t;switch(r%3){case 0:return e.red(t);case 1:return e.white(t);case 2:return e.blue(t)}}}},7569:e=>{e["exports"]=function(e){var t=["red","yellow","green","blue","magenta"];return function(r,n,i){if(r===" "){return r}else{return e[t[n++%t.length]](r)}}}},5179:e=>{e["exports"]=function(e){var t=["underline","inverse","grey","yellow","red","green","blue","white","cyan","magenta","brightYellow","brightRed","brightGreen","brightBlue","brightWhite","brightCyan","brightMagenta"];return function(r,n,i){return r===" "?r:e[t[Math.round(Math.random()*(t.length-2))]](r)}}},5623:e=>{e["exports"]=function(e){return function(t,r,n){return r%2===0?t:e.inverse(t)}}},8802:e=>{var t={};e["exports"]=t;var r={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],grey:[90,39],brightRed:[91,39],brightGreen:[92,39],brightYellow:[93,39],brightBlue:[94,39],brightMagenta:[95,39],brightCyan:[96,39],brightWhite:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgGray:[100,49],bgGrey:[100,49],bgBrightRed:[101,49],bgBrightGreen:[102,49],bgBrightYellow:[103,49],bgBrightBlue:[104,49],bgBrightMagenta:[105,49],bgBrightCyan:[106,49],bgBrightWhite:[107,49],blackBG:[40,49],redBG:[41,49],greenBG:[42,49],yellowBG:[43,49],blueBG:[44,49],magentaBG:[45,49],cyanBG:[46,49],whiteBG:[47,49]};Object.keys(r).forEach((function(e){var n=r[e];var i=t[e]=[];i.open="["+n[0]+"m";i.close="["+n[1]+"m"}))},817:e=>{e.exports=function(e,t){t=t||process.argv||[];var r=t.indexOf("--");var n=/^-{1,2}/.test(e)?"":"--";var i=t.indexOf(n+e);return i!==-1&&(r===-1?true:i<r)}},5758:(e,t,r)=>{var n=r(2037);var i=r(817);var s=process.env;var a=void 0;if(i("no-color")||i("no-colors")||i("color=false")){a=false}else if(i("color")||i("colors")||i("color=true")||i("color=always")){a=true}if("FORCE_COLOR"in s){a=s.FORCE_COLOR.length===0||parseInt(s.FORCE_COLOR,10)!==0}function translateLevel(e){if(e===0){return false}return{level:e,hasBasic:true,has256:e>=2,has16m:e>=3}}function supportsColor(e){if(a===false){return 0}if(i("color=16m")||i("color=full")||i("color=truecolor")){return 3}if(i("color=256")){return 2}if(e&&!e.isTTY&&a!==true){return 0}var t=a?1:0;if(process.platform==="win32"){var r=n.release().split(".");if(Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586){return Number(r[2])>=14931?3:2}return 1}if("CI"in s){if(["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((function(e){return e in s}))||s.CI_NAME==="codeship"){return 1}return t}if("TEAMCITY_VERSION"in s){return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0}if("TERM_PROGRAM"in s){var o=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return o>=3?3:2;case"Hyper":return 3;case"Apple_Terminal":return 2}}if(/-256(color)?$/i.test(s.TERM)){return 2}if(/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)){return 1}if("COLORTERM"in s){return 1}if(s.TERM==="dumb"){return t}return t}function getSupportLevel(e){var t=supportsColor(e);return translateLevel(t)}e.exports={supportsColor:getSupportLevel,stdout:getSupportLevel(process.stdout),stderr:getSupportLevel(process.stderr)}},6009:(e,t,r)=>{var n=r(1101);e["exports"]=n},7033:(e,t,r)=>{const{configs:n,LEVEL:i,MESSAGE:s}=r(3937);class Padder{constructor(e={levels:n.npm.levels}){this.paddings=Padder.paddingForLevels(e.levels,e.filler);this.options=e}static getLongestLevel(e){const t=Object.keys(e).map((e=>e.length));return Math.max(...t)}static paddingForLevel(e,t,r){const n=r+1-e.length;const i=Math.floor(n/t.length);const s=`${t}${t.repeat(i)}`;return s.slice(0,n)}static paddingForLevels(e,t=" "){const r=Padder.getLongestLevel(e);return Object.keys(e).reduce(((e,n)=>{e[n]=Padder.paddingForLevel(n,t,r);return e}),{})}transform(e,t){e.message=`${this.paddings[e[i]]}${e.message}`;if(e[s]){e[s]=`${this.paddings[e[i]]}${e[s]}`}return e}}e.exports=e=>new Padder(e);e.exports.Padder=e.exports.Format=Padder},6182:(e,t,r)=>{const n=r(3837).inspect;const i=r(3791);const{LEVEL:s,MESSAGE:a,SPLAT:o}=r(3937);e.exports=i(((e,t={})=>{const r=Object.assign({},e);delete r[s];delete r[a];delete r[o];e[a]=n(r,false,t.depth||null,t.colorize);return e}))},1843:(e,t,r)=>{const{MESSAGE:n}=r(3937);class Printf{constructor(e){this.template=e}transform(e){e[n]=this.template(e);return e}}e.exports=e=>new Printf(e);e.exports.Printf=e.exports.Format=Printf},5313:(e,t,r)=>{const n=r(3791);const{MESSAGE:i}=r(3937);const s=r(7560);e.exports=n((e=>{const t=s(Object.assign({},e,{level:undefined,message:undefined,splat:undefined}));const r=e.padding&&e.padding[e.level]||"";if(t!=="{}"){e[i]=`${e.level}:${r} ${e.message} ${t}`}else{e[i]=`${e.level}:${r} ${e.message}`}return e}))},7081:(e,t,r)=>{const n=r(3837);const{SPLAT:i}=r(3937);const s=/%[scdjifoO%]/g;const a=/%%/g;class Splatter{constructor(e){this.options=e}_splat(e,t){const r=e.message;const s=e[i]||e.splat||[];const o=r.match(a);const l=o&&o.length||0;const c=t.length-l;const u=c-s.length;const d=u<0?s.splice(u,-1*u):[];const f=d.length;if(f){for(let t=0;t<f;t++){Object.assign(e,d[t])}}e.message=n.format(r,...s);return e}transform(e){const t=e.message;const r=e[i]||e.splat;if(!r||!r.length){return e}const n=t&&t.match&&t.match(s);if(!n&&(r||r.length)){const t=r.length>1?r.splice(0):r;const n=t.length;if(n){for(let r=0;r<n;r++){Object.assign(e,t[r])}}return e}if(n){return this._splat(e,n)}return e}}e.exports=e=>new Splatter(e)},8381:(e,t,r)=>{const n=r(4513);const i=r(3791);e.exports=i(((e,t={})=>{if(t.format){e.timestamp=typeof t.format==="function"?t.format():n.format(new Date,t.format)}if(!e.timestamp){e.timestamp=(new Date).toISOString()}if(t.alias){e[t.alias]=e.timestamp}return e}))},6420:(e,t,r)=>{const n=r(6009);const i=r(3791);const{MESSAGE:s}=r(3937);e.exports=i(((e,t)=>{if(t.level!==false){e.level=n.strip(e.level)}if(t.message!==false){e.message=n.strip(String(e.message))}if(t.raw!==false&&e[s]){e[s]=n.strip(String(e[s]))}return e}))},900:e=>{var t=1e3;var r=t*60;var n=r*60;var i=n*24;var s=i*7;var a=i*365.25;e.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0){return parse(e)}else if(r==="number"&&isFinite(e)){return t.long?fmtLong(e):fmtShort(e)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){e=String(e);if(e.length>100){return}var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!o){return}var l=parseFloat(o[1]);var c=(o[2]||"ms").toLowerCase();switch(c){case"years":case"year":case"yrs":case"yr":case"y":return l*a;case"weeks":case"week":case"w":return l*s;case"days":case"day":case"d":return l*i;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return l*r;case"seconds":case"second":case"secs":case"sec":case"s":return l*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return undefined}}function fmtShort(e){var s=Math.abs(e);if(s>=i){return Math.round(e/i)+"d"}if(s>=n){return Math.round(e/n)+"h"}if(s>=r){return Math.round(e/r)+"m"}if(s>=t){return Math.round(e/t)+"s"}return e+"ms"}function fmtLong(e){var s=Math.abs(e);if(s>=i){return plural(e,s,i,"day")}if(s>=n){return plural(e,s,n,"hour")}if(s>=r){return plural(e,s,r,"minute")}if(s>=t){return plural(e,s,t,"second")}return e+" ms"}function plural(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}},4118:(e,t,r)=>{var n=r(2743);e.exports=function one(e){var t=0,r;function onetime(){if(t)return r;t=1;r=e.apply(this,arguments);e=null;return r}onetime.displayName=n(e);return onetime}},1629:(e,t,r)=>{var n=r(5881);e.exports=t=n.descriptor=n.Root.fromJSON(r(3571)).lookup(".google.protobuf");var i=n.Namespace,s=n.Root,a=n.Enum,o=n.Type,l=n.Field,c=n.MapField,u=n.OneOf,d=n.Service,f=n.Method;s.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.FileDescriptorSet.decode(e);var r=new s;if(e.file){var n,i;for(var c=0,u;c<e.file.length;++c){i=r;if((n=e.file[c])["package"]&&n["package"].length)i=r.define(n["package"]);if(n.name&&n.name.length)r.files.push(i.filename=n.name);if(n.messageType)for(u=0;u<n.messageType.length;++u)i.add(o.fromDescriptor(n.messageType[u],n.syntax));if(n.enumType)for(u=0;u<n.enumType.length;++u)i.add(a.fromDescriptor(n.enumType[u]));if(n.extension)for(u=0;u<n.extension.length;++u)i.add(l.fromDescriptor(n.extension[u]));if(n.service)for(u=0;u<n.service.length;++u)i.add(d.fromDescriptor(n.service[u]));var f=fromDescriptorOptions(n.options,t.FileOptions);if(f){var h=Object.keys(f);for(u=0;u<h.length;++u)i.setOption(h[u],f[h[u]])}}}return r};s.prototype.toDescriptor=function toDescriptor(e){var r=t.FileDescriptorSet.create();Root_toDescriptorRecursive(this,r.file,e);return r};function Root_toDescriptorRecursive(e,r,n){var c=t.FileDescriptorProto.create({name:e.filename||(e.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});if(n)c.syntax=n;if(!(e instanceof s))c["package"]=e.fullName.substring(1);for(var u=0,f;u<e.nestedArray.length;++u)if((f=e._nestedArray[u])instanceof o)c.messageType.push(f.toDescriptor(n));else if(f instanceof a)c.enumType.push(f.toDescriptor());else if(f instanceof l)c.extension.push(f.toDescriptor(n));else if(f instanceof d)c.service.push(f.toDescriptor());else if(f instanceof i)Root_toDescriptorRecursive(f,r,n);c.options=toDescriptorOptions(e.options,t.FileOptions);if(c.messageType.length+c.enumType.length+c.extension.length+c.service.length)r.push(c)}var h=0;o.fromDescriptor=function fromDescriptor(e,r){if(typeof e.length==="number")e=t.DescriptorProto.decode(e);var n=new o(e.name.length?e.name:"Type"+h++,fromDescriptorOptions(e.options,t.MessageOptions)),i;if(e.oneofDecl)for(i=0;i<e.oneofDecl.length;++i)n.add(u.fromDescriptor(e.oneofDecl[i]));if(e.field)for(i=0;i<e.field.length;++i){var s=l.fromDescriptor(e.field[i],r);n.add(s);if(e.field[i].hasOwnProperty("oneofIndex"))n.oneofsArray[e.field[i].oneofIndex].add(s)}if(e.extension)for(i=0;i<e.extension.length;++i)n.add(l.fromDescriptor(e.extension[i],r));if(e.nestedType)for(i=0;i<e.nestedType.length;++i){n.add(o.fromDescriptor(e.nestedType[i],r));if(e.nestedType[i].options&&e.nestedType[i].options.mapEntry)n.setOption("map_entry",true)}if(e.enumType)for(i=0;i<e.enumType.length;++i)n.add(a.fromDescriptor(e.enumType[i]));if(e.extensionRange&&e.extensionRange.length){n.extensions=[];for(i=0;i<e.extensionRange.length;++i)n.extensions.push([e.extensionRange[i].start,e.extensionRange[i].end])}if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){n.reserved=[];if(e.reservedRange)for(i=0;i<e.reservedRange.length;++i)n.reserved.push([e.reservedRange[i].start,e.reservedRange[i].end]);if(e.reservedName)for(i=0;i<e.reservedName.length;++i)n.reserved.push(e.reservedName[i])}return n};o.prototype.toDescriptor=function toDescriptor(e){var r=t.DescriptorProto.create({name:this.name}),n;for(n=0;n<this.fieldsArray.length;++n){var i;r.field.push(i=this._fieldsArray[n].toDescriptor(e));if(this._fieldsArray[n]instanceof c){var s=toDescriptorType(this._fieldsArray[n].keyType,this._fieldsArray[n].resolvedKeyType),u=toDescriptorType(this._fieldsArray[n].type,this._fieldsArray[n].resolvedType),d=u===11||u===14?this._fieldsArray[n].resolvedType&&shortname(this.parent,this._fieldsArray[n].resolvedType)||this._fieldsArray[n].type:undefined;r.nestedType.push(t.DescriptorProto.create({name:i.typeName,field:[t.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),t.FieldDescriptorProto.create({name:"value",number:2,label:1,type:u,typeName:d})],options:t.MessageOptions.create({mapEntry:true})}))}}for(n=0;n<this.oneofsArray.length;++n)r.oneofDecl.push(this._oneofsArray[n].toDescriptor());for(n=0;n<this.nestedArray.length;++n){if(this._nestedArray[n]instanceof l)r.field.push(this._nestedArray[n].toDescriptor(e));else if(this._nestedArray[n]instanceof o)r.nestedType.push(this._nestedArray[n].toDescriptor(e));else if(this._nestedArray[n]instanceof a)r.enumType.push(this._nestedArray[n].toDescriptor())}if(this.extensions)for(n=0;n<this.extensions.length;++n)r.extensionRange.push(t.DescriptorProto.ExtensionRange.create({start:this.extensions[n][0],end:this.extensions[n][1]}));if(this.reserved)for(n=0;n<this.reserved.length;++n)if(typeof this.reserved[n]==="string")r.reservedName.push(this.reserved[n]);else r.reservedRange.push(t.DescriptorProto.ReservedRange.create({start:this.reserved[n][0],end:this.reserved[n][1]}));r.options=toDescriptorOptions(this.options,t.MessageOptions);return r};var p=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function fromDescriptor(e,r){if(typeof e.length==="number")e=t.DescriptorProto.decode(e);if(typeof e.number!=="number")throw Error("missing field id");var n;if(e.typeName&&e.typeName.length)n=e.typeName;else n=fromDescriptorType(e.type);var i;switch(e.label){case 1:i=undefined;break;case 2:i="required";break;case 3:i="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;if(e.extendee!==undefined){s=s.length?s:undefined}var a=new l(e.name.length?e.name:"field"+e.number,e.number,n,i,s);a.options=fromDescriptorOptions(e.options,t.FieldOptions);if(e.defaultValue&&e.defaultValue.length){var o=e.defaultValue;switch(o){case"true":case"TRUE":o=true;break;case"false":case"FALSE":o=false;break;default:var c=p.exec(o);if(c)o=parseInt(o);break}a.setOption("default",o)}if(packableDescriptorType(e.type)){if(r==="proto3"){if(e.options&&!e.options.packed)a.setOption("packed",false)}else if(!(e.options&&e.options.packed))a.setOption("packed",false)}return a};l.prototype.toDescriptor=function toDescriptor(e){var r=t.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map){r.type=11;r.typeName=n.util.ucFirst(this.name);r.label=3}else{switch(r.type=toDescriptorType(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:r.typeName=this.resolvedType?shortname(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":r.label=3;break;case"required":r.label=2;break;default:r.label=1;break}}r.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend;if(this.partOf)if((r.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");if(this.options){r.options=toDescriptorOptions(this.options,t.FieldOptions);if(this.options["default"]!=null)r.defaultValue=String(this.options["default"])}if(e==="proto3"){if(!this.packed)(r.options||(r.options=t.FieldOptions.create())).packed=false}else if(this.packed)(r.options||(r.options=t.FieldOptions.create())).packed=true;return r};var g=0;a.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.EnumDescriptorProto.decode(e);var r={};if(e.value)for(var n=0;n<e.value.length;++n){var i=e.value[n].name,s=e.value[n].number||0;r[i&&i.length?i:"NAME"+s]=s}return new a(e.name&&e.name.length?e.name:"Enum"+g++,r,fromDescriptorOptions(e.options,t.EnumOptions))};a.prototype.toDescriptor=function toDescriptor(){var e=[];for(var r=0,n=Object.keys(this.values);r<n.length;++r)e.push(t.EnumValueDescriptorProto.create({name:n[r],number:this.values[n[r]]}));return t.EnumDescriptorProto.create({name:this.name,value:e,options:toDescriptorOptions(this.options,t.EnumOptions)})};var m=0;u.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.OneofDescriptorProto.decode(e);return new u(e.name&&e.name.length?e.name:"oneof"+m++)};u.prototype.toDescriptor=function toDescriptor(){return t.OneofDescriptorProto.create({name:this.name})};var v=0;d.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.ServiceDescriptorProto.decode(e);var r=new d(e.name&&e.name.length?e.name:"Service"+v++,fromDescriptorOptions(e.options,t.ServiceOptions));if(e.method)for(var n=0;n<e.method.length;++n)r.add(f.fromDescriptor(e.method[n]));return r};d.prototype.toDescriptor=function toDescriptor(){var e=[];for(var r=0;r<this.methodsArray.length;++r)e.push(this._methodsArray[r].toDescriptor());return t.ServiceDescriptorProto.create({name:this.name,method:e,options:toDescriptorOptions(this.options,t.ServiceOptions)})};var y=0;f.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.MethodDescriptorProto.decode(e);return new f(e.name&&e.name.length?e.name:"Method"+y++,"rpc",e.inputType,e.outputType,Boolean(e.clientStreaming),Boolean(e.serverStreaming),fromDescriptorOptions(e.options,t.MethodOptions))};f.prototype.toDescriptor=function toDescriptor(){return t.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:toDescriptorOptions(this.options,t.MethodOptions)})};function fromDescriptorType(e){switch(e){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+e)}function packableDescriptorType(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return true}return false}function toDescriptorType(e,t){switch(e){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(t instanceof a)return 14;if(t instanceof o)return t.group?10:11;throw Error("illegal type: "+e)}function fromDescriptorOptions(e,t){if(!e)return undefined;var r=[];for(var i=0,s,o,l;i<t.fieldsArray.length;++i)if((o=(s=t._fieldsArray[i]).name)!=="uninterpretedOption")if(e.hasOwnProperty(o)){l=e[o];if(s.resolvedType instanceof a&&typeof l==="number"&&s.resolvedType.valuesById[l]!==undefined)l=s.resolvedType.valuesById[l];r.push(underScore(o),l)}return r.length?n.util.toObject(r):undefined}function toDescriptorOptions(e,t){if(!e)return undefined;var r=[];for(var i=0,s=Object.keys(e),a,o;i<s.length;++i){o=e[a=s[i]];if(a==="default")continue;var l=t.fields[a];if(!l&&!(l=t.fields[a=n.util.camelCase(a)]))continue;r.push(a,o)}return r.length?t.fromObject(n.util.toObject(r)):undefined}function shortname(e,t){var r=e.fullName.split("."),n=t.fullName.split("."),a=0,o=0,l=n.length-1;if(!(e instanceof s)&&t instanceof i)while(a<r.length&&o<l&&r[a]===n[o]){var c=t.lookup(r[a++],true);if(c!==null&&c!==t)break;++o}else for(;a<r.length&&o<l&&r[a]===n[o];++a,++o);return n.slice(o).join(".")}function underScore(e){return e.substring(0,1)+e.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,(function(e,t){return"_"+t.toLowerCase()}))}},5881:(e,t,r)=>{e.exports=r(5360)},2134:e=>{e.exports=common;var t=/\/|\./;function common(e,r){if(!t.test(e)){e="google/protobuf/"+e+".proto";r={nested:{google:{nested:{protobuf:{nested:r}}}}}}common[e]=r}common("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var r;common("duration",{Duration:r={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});common("timestamp",{Timestamp:r});common("empty",{Empty:{fields:{}}});common("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});common("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});common("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});common.get=function get(e){return common[e]||null}},3617:(e,t,r)=>{var n=t;var i=r(7732),s=r(7174);function genValuePartial_fromObject(e,t,r,n){var s=false;if(t.resolvedType){if(t.resolvedType instanceof i){e("switch(d%s){",n);for(var a=t.resolvedType.values,o=Object.keys(a),l=0;l<o.length;++l){if(a[o[l]]===t.typeDefault&&!s){e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n);if(!t.repeated)e("break");s=true}e("case%j:",o[l])("case %i:",a[o[l]])("m%s=%j",n,a[o[l]])("break")}e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n)}else{var c=false;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":c=true;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,c)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n);break}}return e}n.fromObject=function fromObject(e){var t=e.fieldsArray;var r=s.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var n=0;n<t.length;++n){var a=t[n].resolve(),o=s.safeProp(a.name);if(a.map){r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o);genValuePartial_fromObject(r,a,n,o+"[ks[i]]")("}")("}")}else if(a.repeated){r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o);genValuePartial_fromObject(r,a,n,o+"[i]")("}")("}")}else{if(!(a.resolvedType instanceof i))r("if(d%s!=null){",o);genValuePartial_fromObject(r,a,n,o);if(!(a.resolvedType instanceof i))r("}")}}return r("return m")};function genValuePartial_toObject(e,t,r,n){if(t.resolvedType){if(t.resolvedType instanceof i)e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,r,n,n,r,n,n);else e("d%s=types[%i].toObject(m%s,o)",n,r,n)}else{var s=false;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":s=true;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,s?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n);break}}return e}n.toObject=function toObject(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()("return {}");var r=s.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}");var n=[],a=[],o=[],l=0;for(;l<t.length;++l)if(!t[l].partOf)(t[l].resolve().repeated?n:t[l].map?a:o).push(t[l]);if(n.length){r("if(o.arrays||o.defaults){");for(l=0;l<n.length;++l)r("d%s=[]",s.safeProp(n[l].name));r("}")}if(a.length){r("if(o.objects||o.defaults){");for(l=0;l<a.length;++l)r("d%s={}",s.safeProp(a[l].name));r("}")}if(o.length){r("if(o.defaults){");for(l=0;l<o.length;++l){var c=o[l],u=s.safeProp(c.name);if(c.resolvedType instanceof i)r("d%s=o.enums===String?%j:%j",u,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",u)("}else")("d%s=o.longs===String?%j:%i",u,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var d="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",u,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",u,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",u,u)("}")}else r("d%s=%j",u,c.typeDefault)}r("}")}var f=false;for(l=0;l<t.length;++l){var c=t[l],h=e._fieldsArray.indexOf(c),u=s.safeProp(c.name);if(c.map){if(!f){f=true;r("var ks2")}r("if(m%s&&(ks2=Object.keys(m%s)).length){",u,u)("d%s={}",u)("for(var j=0;j<ks2.length;++j){");genValuePartial_toObject(r,c,h,u+"[ks2[j]]")("}")}else if(c.repeated){r("if(m%s&&m%s.length){",u,u)("d%s=[]",u)("for(var j=0;j<m%s.length;++j){",u);genValuePartial_toObject(r,c,h,u+"[j]")("}")}else{r("if(m%s!=null&&m.hasOwnProperty(%j)){",u,c.name);genValuePartial_toObject(r,c,h,u);if(c.partOf)r("if(o.oneofs)")("d%s=%j",s.safeProp(c.partOf.name),c.name)}r("}")}return r("return d")}},5871:(e,t,r)=>{e.exports=decoder;var n=r(7732),i=r(288),s=r(7174);function missing(e){return"missing required '"+e.name+"'"}function decoder(e){var t=s.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");if(e.group)t("if((t&7)===4)")("break");t("switch(t>>>3){");var r=0;for(;r<e.fieldsArray.length;++r){var a=e._fieldsArray[r].resolve(),o=a.resolvedType instanceof n?"int32":a.type,l="m"+s.safeProp(a.name);t("case %i: {",a.id);if(a.map){t("if(%s===util.emptyObject)",l)("%s={}",l)("var c2 = r.uint32()+r.pos");if(i.defaults[a.keyType]!==undefined)t("k=%j",i.defaults[a.keyType]);else t("k=null");if(i.defaults[o]!==undefined)t("value=%j",i.defaults[o]);else t("value=null");t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",a.keyType)("case 2:");if(i.basic[o]===undefined)t("value=types[%i].decode(r,r.uint32())",r);else t("value=r.%s()",o);t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}");if(i.long[a.keyType]!==undefined)t('%s[typeof k==="object"?util.longToHash(k):k]=value',l);else t("%s[k]=value",l)}else if(a.repeated){t("if(!(%s&&%s.length))",l,l)("%s=[]",l);if(i.packed[o]!==undefined)t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,o)("}else");if(i.basic[o]===undefined)t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",l,r);else t("%s.push(r.%s())",l,o)}else if(i.basic[o]===undefined)t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",l,r);else t("%s=r.%s()",l,o);t("break")("}")}t("default:")("r.skipType(t&7)")("break")("}")("}");for(r=0;r<e._fieldsArray.length;++r){var c=e._fieldsArray[r];if(c.required)t("if(!m.hasOwnProperty(%j))",c.name)("throw util.ProtocolError(%j,{instance:m})",missing(c))}return t("return m")}},3072:(e,t,r)=>{e.exports=encoder;var n=r(7732),i=r(288),s=r(7174);function genTypePartial(e,t,r,n){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(t.id<<3|2)>>>0)}function encoder(e){var t=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()");var r,a;var o=e.fieldsArray.slice().sort(s.compareFieldsById);for(var r=0;r<o.length;++r){var l=o[r].resolve(),c=e._fieldsArray.indexOf(l),u=l.resolvedType instanceof n?"int32":l.type,d=i.basic[u];a="m"+s.safeProp(l.name);if(l.map){t("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",a,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",a)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|i.mapKey[l.keyType],l.keyType);if(d===undefined)t("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",c,a);else t(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|d,u,a);t("}")("}")}else if(l.repeated){t("if(%s!=null&&%s.length){",a,a);if(l.packed&&i.packed[u]!==undefined){t("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",a)("w.%s(%s[i])",u,a)("w.ldelim()")}else{t("for(var i=0;i<%s.length;++i)",a);if(d===undefined)genTypePartial(t,l,c,a+"[i]");else t("w.uint32(%i).%s(%s[i])",(l.id<<3|d)>>>0,u,a)}t("}")}else{if(l.optional)t("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",a,l.name);if(d===undefined)genTypePartial(t,l,c,a);else t("w.uint32(%i).%s(%s)",(l.id<<3|d)>>>0,u,a)}}return t("return w")}},7732:(e,t,r)=>{e.exports=Enum;var n=r(3575);((Enum.prototype=Object.create(n.prototype)).constructor=Enum).className="Enum";var i=r(6189),s=r(7174);function Enum(e,t,r,i,s,a){n.call(this,e,r);if(t&&typeof t!=="object")throw TypeError("values must be an object");this.valuesById={};this.values=Object.create(this.valuesById);this.comment=i;this.comments=s||{};this.valuesOptions=a;this.reserved=undefined;if(t)for(var o=Object.keys(t),l=0;l<o.length;++l)if(typeof t[o[l]]==="number")this.valuesById[this.values[o[l]]=t[o[l]]]=o[l]}Enum.fromJSON=function fromJSON(e,t){var r=new Enum(e,t.values,t.options,t.comment,t.comments);r.reserved=t.reserved;return r};Enum.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return s.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"comment",t?this.comment:undefined,"comments",t?this.comments:undefined])};Enum.prototype.add=function add(e,t,r,n){if(!s.isString(e))throw TypeError("name must be a string");if(!s.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==undefined)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==undefined){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;if(n){if(this.valuesOptions===undefined)this.valuesOptions={};this.valuesOptions[e]=n||null}this.comments[e]=r||null;return this};Enum.prototype.remove=function remove(e){if(!s.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);delete this.valuesById[t];delete this.values[e];delete this.comments[e];if(this.valuesOptions)delete this.valuesOptions[e];return this};Enum.prototype.isReservedId=function isReservedId(e){return i.isReservedId(this.reserved,e)};Enum.prototype.isReservedName=function isReservedName(e){return i.isReservedName(this.reserved,e)}},8213:(e,t,r)=>{e.exports=Field;var n=r(3575);((Field.prototype=Object.create(n.prototype)).constructor=Field).className="Field";var i=r(7732),s=r(288),a=r(7174);var o;var l=/^required|optional|repeated$/;Field.fromJSON=function fromJSON(e,t){return new Field(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function Field(e,t,r,i,o,c,u){if(a.isObject(i)){u=o;c=i;i=o=undefined}else if(a.isObject(o)){u=c;c=o;o=undefined}n.call(this,e,c);if(!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(r))throw TypeError("type must be a string");if(i!==undefined&&!l.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(o!==undefined&&!a.isString(o))throw TypeError("extend must be a string");if(i==="proto3_optional"){i="optional"}this.rule=i&&i!=="optional"?i:undefined;this.type=r;this.id=t;this.extend=o||undefined;this.required=i==="required";this.optional=!this.required;this.repeated=i==="repeated";this.map=false;this.message=null;this.partOf=null;this.typeDefault=null;this.defaultValue=null;this.long=a.Long?s.long[r]!==undefined:false;this.bytes=r==="bytes";this.resolvedType=null;this.extensionField=null;this.declaringField=null;this._packed=null;this.comment=u}Object.defineProperty(Field.prototype,"packed",{get:function(){if(this._packed===null)this._packed=this.getOption("packed")!==false;return this._packed}});Field.prototype.setOption=function setOption(e,t,r){if(e==="packed")this._packed=null;return n.prototype.setOption.call(this,e,t,r)};Field.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return a.toObject(["rule",this.rule!=="optional"&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])};Field.prototype.resolve=function resolve(){if(this.resolved)return this;if((this.typeDefault=s.defaults[this.type])===undefined){this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type);if(this.resolvedType instanceof o)this.typeDefault=null;else this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]}else if(this.options&&this.options.proto3_optional){this.typeDefault=null}if(this.options&&this.options["default"]!=null){this.typeDefault=this.options["default"];if(this.resolvedType instanceof i&&typeof this.typeDefault==="string")this.typeDefault=this.resolvedType.values[this.typeDefault]}if(this.options){if(this.options.packed===true||this.options.packed!==undefined&&this.resolvedType&&!(this.resolvedType instanceof i))delete this.options.packed;if(!Object.keys(this.options).length)this.options=undefined}if(this.long){this.typeDefault=a.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u");if(Object.freeze)Object.freeze(this.typeDefault)}else if(this.bytes&&typeof this.typeDefault==="string"){var e;if(a.base64.test(this.typeDefault))a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0);else a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0);this.typeDefault=e}if(this.map)this.defaultValue=a.emptyObject;else if(this.repeated)this.defaultValue=a.emptyArray;else this.defaultValue=this.typeDefault;if(this.parent instanceof o)this.parent.ctor.prototype[this.name]=this.defaultValue;return n.prototype.resolve.call(this)};Field.d=function decorateField(e,t,r,n){if(typeof t==="function")t=a.decorateType(t).name;else if(t&&typeof t==="object")t=a.decorateEnum(t).name;return function fieldDecorator(i,s){a.decorateType(i.constructor).add(new Field(s,e,t,r,{default:n}))}};Field._configure=function configure(e){o=e}},6119:(e,t,r)=>{var n=e.exports=r(3242);n.build="light";function load(e,t,r){if(typeof t==="function"){r=t;t=new n.Root}else if(!t)t=new n.Root;return t.load(e,r)}n.load=load;function loadSync(e,t){if(!t)t=new n.Root;return t.loadSync(e)}n.loadSync=loadSync;n.encoder=r(3072);n.decoder=r(5871);n.verifier=r(4334);n.converter=r(3617);n.ReflectionObject=r(3575);n.Namespace=r(6189);n.Root=r(2614);n.Enum=r(7732);n.Type=r(8520);n.Field=r(8213);n.OneOf=r(4408);n.MapField=r(7777);n.Service=r(6178);n.Method=r(7771);n.Message=r(8027);n.wrappers=r(3216);n.types=r(288);n.util=r(7174);n.ReflectionObject._configure(n.Root);n.Namespace._configure(n.Type,n.Service,n.Enum);n.Root._configure(n.Type);n.Field._configure(n.Type)},3242:(e,t,r)=>{var n=t;n.build="minimal";n.Writer=r(3098);n.BufferWriter=r(1863);n.Reader=r(1011);n.BufferReader=r(339);n.util=r(1241);n.rpc=r(6444);n.roots=r(73);n.configure=configure;function configure(){n.util._configure();n.Writer._configure(n.BufferWriter);n.Reader._configure(n.BufferReader)}configure()},5360:(e,t,r)=>{var n=e.exports=r(6119);n.build="full";n.tokenize=r(1157);n.parse=r(2137);n.common=r(2134);n.Root._configure(n.Type,n.parse,n.common)},7777:(e,t,r)=>{e.exports=MapField;var n=r(8213);((MapField.prototype=Object.create(n.prototype)).constructor=MapField).className="MapField";var i=r(288),s=r(7174);function MapField(e,t,r,i,a,o){n.call(this,e,t,i,undefined,undefined,a,o);if(!s.isString(r))throw TypeError("keyType must be a string");this.keyType=r;this.resolvedKeyType=null;this.map=true}MapField.fromJSON=function fromJSON(e,t){return new MapField(e,t.id,t.keyType,t.type,t.options,t.comment)};MapField.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])};MapField.prototype.resolve=function resolve(){if(this.resolved)return this;if(i.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)};MapField.d=function decorateMapField(e,t,r){if(typeof r==="function")r=s.decorateType(r).name;else if(r&&typeof r==="object")r=s.decorateEnum(r).name;return function mapFieldDecorator(n,i){s.decorateType(n.constructor).add(new MapField(i,e,t,r))}}},8027:(e,t,r)=>{e.exports=Message;var n=r(1241);function Message(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}Message.create=function create(e){return this.$type.create(e)};Message.encode=function encode(e,t){return this.$type.encode(e,t)};Message.encodeDelimited=function encodeDelimited(e,t){return this.$type.encodeDelimited(e,t)};Message.decode=function decode(e){return this.$type.decode(e)};Message.decodeDelimited=function decodeDelimited(e){return this.$type.decodeDelimited(e)};Message.verify=function verify(e){return this.$type.verify(e)};Message.fromObject=function fromObject(e){return this.$type.fromObject(e)};Message.toObject=function toObject(e,t){return this.$type.toObject(e,t)};Message.prototype.toJSON=function toJSON(){return this.$type.toObject(this,n.toJSONOptions)}},7771:(e,t,r)=>{e.exports=Method;var n=r(3575);((Method.prototype=Object.create(n.prototype)).constructor=Method).className="Method";var i=r(7174);function Method(e,t,r,s,a,o,l,c,u){if(i.isObject(a)){l=a;a=o=undefined}else if(i.isObject(o)){l=o;o=undefined}if(!(t===undefined||i.isString(t)))throw TypeError("type must be a string");if(!i.isString(r))throw TypeError("requestType must be a string");if(!i.isString(s))throw TypeError("responseType must be a string");n.call(this,e,l);this.type=t||"rpc";this.requestType=r;this.requestStream=a?true:undefined;this.responseType=s;this.responseStream=o?true:undefined;this.resolvedRequestType=null;this.resolvedResponseType=null;this.comment=c;this.parsedOptions=u}Method.fromJSON=function fromJSON(e,t){return new Method(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};Method.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return i.toObject(["type",this.type!=="rpc"&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:undefined,"parsedOptions",this.parsedOptions])};Method.prototype.resolve=function resolve(){if(this.resolved)return this;this.resolvedRequestType=this.parent.lookupType(this.requestType);this.resolvedResponseType=this.parent.lookupType(this.responseType);return n.prototype.resolve.call(this)}},6189:(e,t,r)=>{e.exports=Namespace;var n=r(3575);((Namespace.prototype=Object.create(n.prototype)).constructor=Namespace).className="Namespace";var i=r(8213),s=r(7174),a=r(4408);var o,l,c;Namespace.fromJSON=function fromJSON(e,t){return new Namespace(e,t.options).addJSON(t.nested)};function arrayToJSON(e,t){if(!(e&&e.length))return undefined;var r={};for(var n=0;n<e.length;++n)r[e[n].name]=e[n].toJSON(t);return r}Namespace.arrayToJSON=arrayToJSON;Namespace.isReservedId=function isReservedId(e,t){if(e)for(var r=0;r<e.length;++r)if(typeof e[r]!=="string"&&e[r][0]<=t&&e[r][1]>t)return true;return false};Namespace.isReservedName=function isReservedName(e,t){if(e)for(var r=0;r<e.length;++r)if(e[r]===t)return true;return false};function Namespace(e,t){n.call(this,e,t);this.nested=undefined;this._nestedArray=null}function clearCache(e){e._nestedArray=null;return e}Object.defineProperty(Namespace.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=s.toArray(this.nested))}});Namespace.prototype.toJSON=function toJSON(e){return s.toObject(["options",this.options,"nested",arrayToJSON(this.nestedArray,e)])};Namespace.prototype.addJSON=function addJSON(e){var t=this;if(e){for(var r=Object.keys(e),n=0,s;n<r.length;++n){s=e[r[n]];t.add((s.fields!==undefined?o.fromJSON:s.values!==undefined?c.fromJSON:s.methods!==undefined?l.fromJSON:s.id!==undefined?i.fromJSON:Namespace.fromJSON)(r[n],s))}}return this};Namespace.prototype.get=function get(e){return this.nested&&this.nested[e]||null};Namespace.prototype.getEnum=function getEnum(e){if(this.nested&&this.nested[e]instanceof c)return this.nested[e].values;throw Error("no such enum: "+e)};Namespace.prototype.add=function add(e){if(!(e instanceof i&&e.extend!==undefined||e instanceof o||e instanceof a||e instanceof c||e instanceof l||e instanceof Namespace))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t){if(t instanceof Namespace&&e instanceof Namespace&&!(t instanceof o||t instanceof l)){var r=t.nestedArray;for(var n=0;n<r.length;++n)e.add(r[n]);this.remove(t);if(!this.nested)this.nested={};e.setOptions(t.options,true)}else throw Error("duplicate name '"+e.name+"' in "+this)}}this.nested[e.name]=e;e.onAdd(this);return clearCache(this)};Namespace.prototype.remove=function remove(e){if(!(e instanceof n))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);delete this.nested[e.name];if(!Object.keys(this.nested).length)this.nested=undefined;e.onRemove(this);return clearCache(this)};Namespace.prototype.define=function define(e,t){if(s.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");var r=this;while(e.length>0){var n=e.shift();if(r.nested&&r.nested[n]){r=r.nested[n];if(!(r instanceof Namespace))throw Error("path conflicts with non-namespace objects")}else r.add(r=new Namespace(n))}if(t)r.addJSON(t);return r};Namespace.prototype.resolveAll=function resolveAll(){var e=this.nestedArray,t=0;while(t<e.length)if(e[t]instanceof Namespace)e[t++].resolveAll();else e[t++].resolve();return this.resolve()};Namespace.prototype.lookup=function lookup(e,t,r){if(typeof t==="boolean"){r=t;t=undefined}else if(t&&!Array.isArray(t))t=[t];if(s.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(e.length===1){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof Namespace&&(n=n.lookup(e.slice(1),t,true)))return n}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof Namespace&&(n=this._nestedArray[i].lookup(e,t,true)))return n;if(this.parent===null||r)return null;return this.parent.lookup(e,t)};Namespace.prototype.lookupType=function lookupType(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such type: "+e);return t};Namespace.prototype.lookupEnum=function lookupEnum(e){var t=this.lookup(e,[c]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};Namespace.prototype.lookupTypeOrEnum=function lookupTypeOrEnum(e){var t=this.lookup(e,[o,c]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};Namespace.prototype.lookupService=function lookupService(e){var t=this.lookup(e,[l]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};Namespace._configure=function(e,t,r){o=e;l=t;c=r}},3575:(e,t,r)=>{e.exports=ReflectionObject;ReflectionObject.className="ReflectionObject";var n=r(7174);var i;function ReflectionObject(e,t){if(!n.isString(e))throw TypeError("name must be a string");if(t&&!n.isObject(t))throw TypeError("options must be an object");this.options=t;this.parsedOptions=null;this.name=e;this.parent=null;this.resolved=false;this.comment=null;this.filename=null}Object.defineProperties(ReflectionObject.prototype,{root:{get:function(){var e=this;while(e.parent!==null)e=e.parent;return e}},fullName:{get:function(){var e=[this.name],t=this.parent;while(t){e.unshift(t.name);t=t.parent}return e.join(".")}}});ReflectionObject.prototype.toJSON=function toJSON(){throw Error()};ReflectionObject.prototype.onAdd=function onAdd(e){if(this.parent&&this.parent!==e)this.parent.remove(this);this.parent=e;this.resolved=false;var t=e.root;if(t instanceof i)t._handleAdd(this)};ReflectionObject.prototype.onRemove=function onRemove(e){var t=e.root;if(t instanceof i)t._handleRemove(this);this.parent=null;this.resolved=false};ReflectionObject.prototype.resolve=function resolve(){if(this.resolved)return this;if(this.root instanceof i)this.resolved=true;return this};ReflectionObject.prototype.getOption=function getOption(e){if(this.options)return this.options[e];return undefined};ReflectionObject.prototype.setOption=function setOption(e,t,r){if(!r||!this.options||this.options[e]===undefined)(this.options||(this.options={}))[e]=t;return this};ReflectionObject.prototype.setParsedOption=function setParsedOption(e,t,r){if(!this.parsedOptions){this.parsedOptions=[]}var i=this.parsedOptions;if(r){var s=i.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(s){var a=s[e];n.setProperty(a,r,t)}else{s={};s[e]=n.setProperty({},r,t);i.push(s)}}else{var o={};o[e]=t;i.push(o)}return this};ReflectionObject.prototype.setOptions=function setOptions(e,t){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)this.setOption(r[n],e[r[n]],t);return this};ReflectionObject.prototype.toString=function toString(){var e=this.constructor.className,t=this.fullName;if(t.length)return e+" "+t;return e};ReflectionObject._configure=function(e){i=e}},4408:(e,t,r)=>{e.exports=OneOf;var n=r(3575);((OneOf.prototype=Object.create(n.prototype)).constructor=OneOf).className="OneOf";var i=r(8213),s=r(7174);function OneOf(e,t,r,i){if(!Array.isArray(t)){r=t;t=undefined}n.call(this,e,r);if(!(t===undefined||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[];this.fieldsArray=[];this.comment=i}OneOf.fromJSON=function fromJSON(e,t){return new OneOf(e,t.oneof,t.options,t.comment)};OneOf.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return s.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:undefined])};function addFieldsToParent(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)if(!e.fieldsArray[t].parent)e.parent.add(e.fieldsArray[t])}OneOf.prototype.add=function add(e){if(!(e instanceof i))throw TypeError("field must be a Field");if(e.parent&&e.parent!==this.parent)e.parent.remove(e);this.oneof.push(e.name);this.fieldsArray.push(e);e.partOf=this;addFieldsToParent(this);return this};OneOf.prototype.remove=function remove(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);this.fieldsArray.splice(t,1);t=this.oneof.indexOf(e.name);if(t>-1)this.oneof.splice(t,1);e.partOf=null;return this};OneOf.prototype.onAdd=function onAdd(e){n.prototype.onAdd.call(this,e);var t=this;for(var r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);if(i&&!i.partOf){i.partOf=t;t.fieldsArray.push(i)}}addFieldsToParent(this)};OneOf.prototype.onRemove=function onRemove(e){for(var t=0,r;t<this.fieldsArray.length;++t)if((r=this.fieldsArray[t]).parent)r.parent.remove(r);n.prototype.onRemove.call(this,e)};OneOf.d=function decorateOneOf(){var e=new Array(arguments.length),t=0;while(t<arguments.length)e[t]=arguments[t++];return function oneOfDecorator(t,r){s.decorateType(t.constructor).add(new OneOf(r,e));Object.defineProperty(t,r,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},2137:(e,t,r)=>{e.exports=parse;parse.filename=null;parse.defaults={keepCase:false};var n=r(1157),i=r(2614),s=r(8520),a=r(8213),o=r(7777),l=r(4408),c=r(7732),u=r(6178),d=r(7771),f=r(288),h=r(7174);var p=/^[1-9][0-9]*$/,g=/^-?[1-9][0-9]*$/,m=/^0[x][0-9a-fA-F]+$/,v=/^-?0[x][0-9a-fA-F]+$/,y=/^0[0-7]+$/,b=/^-?0[0-7]+$/,S=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,_=/^[a-zA-Z_][a-zA-Z_0-9]*$/,w=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,C=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function parse(e,t,r){if(!(t instanceof i)){r=t;t=new i}if(!r)r=parse.defaults;var E=r.preferTrailingComment||false;var T=n(e,r.alternateCommentMode||false),R=T.next,k=T.push,O=T.peek,M=T.skip,x=T.cmnt;var A=true,P,N,I,D,L=false;var j=t;var B=r.keepCase?function(e){return e}:h.camelCase;function illegal(e,t,r){var n=parse.filename;if(!r)parse.filename=null;return Error("illegal "+(t||"token")+" '"+e+"' ("+(n?n+", ":"")+"line "+T.line+")")}function readString(){var e=[],t;do{if((t=R())!=='"'&&t!=="'")throw illegal(t);e.push(R());M(t);t=O()}while(t==='"'||t==="'");return e.join("")}function readValue(e){var t=R();switch(t){case"'":case'"':k(t);return readString();case"true":case"TRUE":return true;case"false":case"FALSE":return false}try{return parseNumber(t,true)}catch(r){if(e&&w.test(t))return t;throw illegal(t,"value")}}function readRanges(e,t){var r,n;do{if(t&&((r=O())==='"'||r==="'"))e.push(readString());else e.push([n=parseId(R()),M("to",true)?parseId(R()):n])}while(M(",",true));M(";")}function parseNumber(e,t){var r=1;if(e.charAt(0)==="-"){r=-1;e=e.substring(1)}switch(e){case"inf":case"INF":case"Inf":return r*Infinity;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return r*parseInt(e,10);if(m.test(e))return r*parseInt(e,16);if(y.test(e))return r*parseInt(e,8);if(S.test(e))return r*parseFloat(e);throw illegal(e,"number",t)}function parseId(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&e.charAt(0)==="-")throw illegal(e,"id");if(g.test(e))return parseInt(e,10);if(v.test(e))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw illegal(e,"id")}function parsePackage(){if(P!==undefined)throw illegal("package");P=R();if(!w.test(P))throw illegal(P,"name");j=j.define(P);M(";")}function parseImport(){var e=O();var t;switch(e){case"weak":t=I||(I=[]);R();break;case"public":R();default:t=N||(N=[]);break}e=readString();M(";");t.push(e)}function parseSyntax(){M("=");D=readString();L=D==="proto3";if(!L&&D!=="proto2")throw illegal(D,"syntax");M(";")}function parseCommon(e,t){switch(t){case"option":parseOption(e,t);M(";");return true;case"message":parseType(e,t);return true;case"enum":parseEnum(e,t);return true;case"service":parseService(e,t);return true;case"extend":parseExtension(e,t);return true}return false}function ifBlock(e,t,r){var n=T.line;if(e){if(typeof e.comment!=="string"){e.comment=x()}e.filename=parse.filename}if(M("{",true)){var i;while((i=R())!=="}")t(i);M(";",true)}else{if(r)r();M(";");if(e&&(typeof e.comment!=="string"||E))e.comment=x(n)||e.comment}}function parseType(e,t){if(!_.test(t=R()))throw illegal(t,"type name");var r=new s(t);ifBlock(r,(function parseType_block(e){if(parseCommon(r,e))return;switch(e){case"map":parseMapField(r,e);break;case"required":case"repeated":parseField(r,e);break;case"optional":if(L){parseField(r,"proto3_optional")}else{parseField(r,"optional")}break;case"oneof":parseOneOf(r,e);break;case"extensions":readRanges(r.extensions||(r.extensions=[]));break;case"reserved":readRanges(r.reserved||(r.reserved=[]),true);break;default:if(!L||!w.test(e))throw illegal(e);k(e);parseField(r,"optional");break}}));e.add(r)}function parseField(e,t,r){var n=R();if(n==="group"){parseGroup(e,t);return}while(n.endsWith(".")||O().startsWith(".")){n+=R()}if(!w.test(n))throw illegal(n,"type");var i=R();if(!_.test(i))throw illegal(i,"name");i=B(i);M("=");var s=new a(i,parseId(R()),n,t,r);ifBlock(s,(function parseField_block(e){if(e==="option"){parseOption(s,e);M(";")}else throw illegal(e)}),(function parseField_line(){parseInlineOptions(s)}));if(t==="proto3_optional"){var o=new l("_"+i);s.setOption("proto3_optional",true);o.add(s);e.add(o)}else{e.add(s)}if(!L&&s.repeated&&(f.packed[n]!==undefined||f.basic[n]===undefined))s.setOption("packed",false,true)}function parseGroup(e,t){var r=R();if(!_.test(r))throw illegal(r,"name");var n=h.lcFirst(r);if(r===n)r=h.ucFirst(r);M("=");var i=parseId(R());var o=new s(r);o.group=true;var l=new a(n,i,r,t);l.filename=parse.filename;ifBlock(o,(function parseGroup_block(e){switch(e){case"option":parseOption(o,e);M(";");break;case"required":case"repeated":parseField(o,e);break;case"optional":if(L){parseField(o,"proto3_optional")}else{parseField(o,"optional")}break;case"message":parseType(o,e);break;case"enum":parseEnum(o,e);break;default:throw illegal(e)}}));e.add(o).add(l)}function parseMapField(e){M("<");var t=R();if(f.mapKey[t]===undefined)throw illegal(t,"type");M(",");var r=R();if(!w.test(r))throw illegal(r,"type");M(">");var n=R();if(!_.test(n))throw illegal(n,"name");M("=");var i=new o(B(n),parseId(R()),t,r);ifBlock(i,(function parseMapField_block(e){if(e==="option"){parseOption(i,e);M(";")}else throw illegal(e)}),(function parseMapField_line(){parseInlineOptions(i)}));e.add(i)}function parseOneOf(e,t){if(!_.test(t=R()))throw illegal(t,"name");var r=new l(B(t));ifBlock(r,(function parseOneOf_block(e){if(e==="option"){parseOption(r,e);M(";")}else{k(e);parseField(r,"optional")}}));e.add(r)}function parseEnum(e,t){if(!_.test(t=R()))throw illegal(t,"name");var r=new c(t);ifBlock(r,(function parseEnum_block(e){switch(e){case"option":parseOption(r,e);M(";");break;case"reserved":readRanges(r.reserved||(r.reserved=[]),true);break;default:parseEnumValue(r,e)}}));e.add(r)}function parseEnumValue(e,t){if(!_.test(t))throw illegal(t,"name");M("=");var r=parseId(R(),true),n={options:undefined};n.setOption=function(e,t){if(this.options===undefined)this.options={};this.options[e]=t};ifBlock(n,(function parseEnumValue_block(e){if(e==="option"){parseOption(n,e);M(";")}else throw illegal(e)}),(function parseEnumValue_line(){parseInlineOptions(n)}));e.add(t,r,n.comment,n.options)}function parseOption(e,t){var r=M("(",true);if(!w.test(t=R()))throw illegal(t,"name");var n=t;var i=n;var s;if(r){M(")");n="("+n+")";i=n;t=O();if(C.test(t)){s=t.slice(1);n+=t;R()}}M("=");var a=parseOptionValue(e,n);setParsedOption(e,i,a,s)}function parseOptionValue(e,t){if(M("{",true)){var r={};while(!M("}",true)){if(!_.test(F=R())){throw illegal(F,"name")}if(F===null){throw illegal(F,"end of input")}var n;var i=F;M(":",true);if(O()==="{")n=parseOptionValue(e,t+"."+F);else if(O()==="["){n=[];var s;if(M("[",true)){do{s=readValue(true);n.push(s)}while(M(",",true));M("]");if(typeof s!=="undefined"){setOption(e,t+"."+F,s)}}}else{n=readValue(true);setOption(e,t+"."+F,n)}var a=r[i];if(a)n=[].concat(a).concat(n);r[i]=n;M(",",true);M(";",true)}return r}var o=readValue(true);setOption(e,t,o);return o}function setOption(e,t,r){if(e.setOption)e.setOption(t,r)}function setParsedOption(e,t,r,n){if(e.setParsedOption)e.setParsedOption(t,r,n)}function parseInlineOptions(e){if(M("[",true)){do{parseOption(e,"option")}while(M(",",true));M("]")}return e}function parseService(e,t){if(!_.test(t=R()))throw illegal(t,"service name");var r=new u(t);ifBlock(r,(function parseService_block(e){if(parseCommon(r,e))return;if(e==="rpc")parseMethod(r,e);else throw illegal(e)}));e.add(r)}function parseMethod(e,t){var r=x();var n=t;if(!_.test(t=R()))throw illegal(t,"name");var i=t,s,a,o,l;M("(");if(M("stream",true))a=true;if(!w.test(t=R()))throw illegal(t);s=t;M(")");M("returns");M("(");if(M("stream",true))l=true;if(!w.test(t=R()))throw illegal(t);o=t;M(")");var c=new d(i,n,s,o,a,l);c.comment=r;ifBlock(c,(function parseMethod_block(e){if(e==="option"){parseOption(c,e);M(";")}else throw illegal(e)}));e.add(c)}function parseExtension(e,t){if(!w.test(t=R()))throw illegal(t,"reference");var r=t;ifBlock(null,(function parseExtension_block(t){switch(t){case"required":case"repeated":parseField(e,t,r);break;case"optional":if(L){parseField(e,"proto3_optional",r)}else{parseField(e,"optional",r)}break;default:if(!L||!w.test(t))throw illegal(t);k(t);parseField(e,"optional",r);break}}))}var F;while((F=R())!==null){switch(F){case"package":if(!A)throw illegal(F);parsePackage();break;case"import":if(!A)throw illegal(F);parseImport();break;case"syntax":if(!A)throw illegal(F);parseSyntax();break;case"option":parseOption(j,F);M(";");break;default:if(parseCommon(j,F)){A=false;continue}throw illegal(F)}}parse.filename=null;return{package:P,imports:N,weakImports:I,syntax:D,root:t}}},1011:(e,t,r)=>{e.exports=Reader;var n=r(1241);var i;var s=n.LongBits,a=n.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e;this.pos=0;this.len=e.length}var o=typeof Uint8Array!=="undefined"?function create_typed_array(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function create_array(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")};var l=function create(){return n.Buffer?function create_buffer_setup(e){return(Reader.create=function create_buffer(e){return n.Buffer.isBuffer(e)?new i(e):o(e)})(e)}:o};Reader.create=l();Reader.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice;Reader.prototype.uint32=function read_uint32_setup(){var e=4294967295;return function read_uint32(){e=(this.buf[this.pos]&127)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&127)<<7)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&127)<<14)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&127)<<21)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&15)<<28)>>>0;if(this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len){this.pos=this.len;throw indexOutOfRange(this,10)}return e}}();Reader.prototype.int32=function read_int32(){return this.uint32()|0};Reader.prototype.sint32=function read_sint32(){var e=this.uint32();return e>>>1^-(e&1)|0};function readLongVarint(){var e=new s(0,0);var t=0;if(this.len-this.pos>4){for(;t<4;++t){e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0;e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0;if(this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0;return e}if(this.len-this.pos>4){for(;t<5;++t){e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}else{for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}throw Error("invalid varint encoding")}Reader.prototype.bool=function read_bool(){return this.uint32()!==0};function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Reader.prototype.fixed32=function read_fixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader.prototype.sfixed32=function read_sfixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new s(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.prototype.float=function read_float(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=n.float.readFloatLE(this.buf,this.pos);this.pos+=4;return e};Reader.prototype.double=function read_double(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);this.pos+=8;return e};Reader.prototype.bytes=function read_bytes(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw indexOutOfRange(this,e);this.pos+=e;if(Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var i=n.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)};Reader.prototype.string=function read_string(){var e=this.bytes();return a.read(e,0,e.length)};Reader.prototype.skip=function skip(e){if(typeof e==="number"){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else{do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(this.buf[this.pos++]&128)}return this};Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:while((e=this.uint32()&7)!==4){this.skipType(e)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Reader._configure=function(e){i=e;Reader.create=l();i._configure();var t=n.Long?"toLong":"toNumber";n.merge(Reader.prototype,{int64:function read_int64(){return readLongVarint.call(this)[t](false)},uint64:function read_uint64(){return readLongVarint.call(this)[t](true)},sint64:function read_sint64(){return readLongVarint.call(this).zzDecode()[t](false)},fixed64:function read_fixed64(){return readFixed64.call(this)[t](true)},sfixed64:function read_sfixed64(){return readFixed64.call(this)[t](false)}})}},339:(e,t,r)=>{e.exports=BufferReader;var n=r(1011);(BufferReader.prototype=Object.create(n.prototype)).constructor=BufferReader;var i=r(1241);function BufferReader(e){n.call(this,e)}BufferReader._configure=function(){if(i.Buffer)BufferReader.prototype._slice=i.Buffer.prototype.slice};BufferReader.prototype.string=function read_string_buffer(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};BufferReader._configure()},2614:(e,t,r)=>{e.exports=Root;var n=r(6189);((Root.prototype=Object.create(n.prototype)).constructor=Root).className="Root";var i=r(8213),s=r(7732),a=r(4408),o=r(7174);var l,c,u;function Root(e){n.call(this,"",e);this.deferred=[];this.files=[]}Root.fromJSON=function fromJSON(e,t){if(!t)t=new Root;if(e.options)t.setOptions(e.options);return t.addJSON(e.nested)};Root.prototype.resolvePath=o.path.resolve;Root.prototype.fetch=o.fetch;function SYNC(){}Root.prototype.load=function load(e,t,r){if(typeof t==="function"){r=t;t=undefined}var n=this;if(!r)return o.asPromise(load,n,e,t);var i=r===SYNC;function finish(e,t){if(!r)return;if(i)throw e;var n=r;r=null;n(e,t)}function getBundledFileName(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var r=e.substring(t);if(r in u)return r}return null}function process(e,r){try{if(o.isString(r)&&r.charAt(0)==="{")r=JSON.parse(r);if(!o.isString(r))n.setOptions(r.options).addJSON(r.nested);else{c.filename=e;var a=c(r,n,t),l,u=0;if(a.imports)for(;u<a.imports.length;++u)if(l=getBundledFileName(a.imports[u])||n.resolvePath(e,a.imports[u]))fetch(l);if(a.weakImports)for(u=0;u<a.weakImports.length;++u)if(l=getBundledFileName(a.weakImports[u])||n.resolvePath(e,a.weakImports[u]))fetch(l,true)}}catch(e){finish(e)}if(!i&&!s)finish(null,n)}function fetch(e,t){e=getBundledFileName(e)||e;if(n.files.indexOf(e)>-1)return;n.files.push(e);if(e in u){if(i)process(e,u[e]);else{++s;setTimeout((function(){--s;process(e,u[e])}))}return}if(i){var a;try{a=o.fs.readFileSync(e).toString("utf8")}catch(e){if(!t)finish(e);return}process(e,a)}else{++s;n.fetch(e,(function(i,a){--s;if(!r)return;if(i){if(!t)finish(i);else if(!s)finish(null,n);return}process(e,a)}))}}var s=0;if(o.isString(e))e=[e];for(var a=0,l;a<e.length;++a)if(l=n.resolvePath("",e[a]))fetch(l);if(i)return n;if(!s)finish(null,n);return undefined};Root.prototype.loadSync=function loadSync(e,t){if(!o.isNode)throw Error("not supported");return this.load(e,t,SYNC)};Root.prototype.resolveAll=function resolveAll(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return n.prototype.resolveAll.call(this)};var d=/^[A-Z]/;function tryHandleExtension(e,t){var r=t.parent.lookup(t.extend);if(r){var n=new i(t.fullName,t.id,t.type,t.rule,undefined,t.options);if(r.get(n.name)){return true}n.declaringField=t;t.extensionField=n;r.add(n);return true}return false}Root.prototype._handleAdd=function _handleAdd(e){if(e instanceof i){if(e.extend!==undefined&&!e.extensionField)if(!tryHandleExtension(this,e))this.deferred.push(e)}else if(e instanceof s){if(d.test(e.name))e.parent[e.name]=e.values}else if(!(e instanceof a)){if(e instanceof l)for(var t=0;t<this.deferred.length;)if(tryHandleExtension(this,this.deferred[t]))this.deferred.splice(t,1);else++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);if(d.test(e.name))e.parent[e.name]=e}};Root.prototype._handleRemove=function _handleRemove(e){if(e instanceof i){if(e.extend!==undefined){if(e.extensionField){e.extensionField.parent.remove(e.extensionField);e.extensionField=null}else{var t=this.deferred.indexOf(e);if(t>-1)this.deferred.splice(t,1)}}}else if(e instanceof s){if(d.test(e.name))delete e.parent[e.name]}else if(e instanceof n){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);if(d.test(e.name))delete e.parent[e.name]}};Root._configure=function(e,t,r){l=e;c=t;u=r}},73:e=>{e.exports={}},6444:(e,t,r)=>{var n=t;n.Service=r(2439)},2439:(e,t,r)=>{e.exports=Service;var n=r(1241);(Service.prototype=Object.create(n.EventEmitter.prototype)).constructor=Service;function Service(e,t,r){if(typeof e!=="function")throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this);this.rpcImpl=e;this.requestDelimited=Boolean(t);this.responseDelimited=Boolean(r)}Service.prototype.rpcCall=function rpcCall(e,t,r,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return n.asPromise(rpcCall,a,e,t,r,i);if(!a.rpcImpl){setTimeout((function(){s(Error("already ended"))}),0);return undefined}try{return a.rpcImpl(e,t[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function rpcCallback(t,n){if(t){a.emit("error",t,e);return s(t)}if(n===null){a.end(true);return undefined}if(!(n instanceof r)){try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){a.emit("error",t,e);return s(t)}}a.emit("data",n,e);return s(null,n)}))}catch(t){a.emit("error",t,e);setTimeout((function(){s(t)}),0);return undefined}};Service.prototype.end=function end(e){if(this.rpcImpl){if(!e)this.rpcImpl(null,null,null);this.rpcImpl=null;this.emit("end").off()}return this}},6178:(e,t,r)=>{e.exports=Service;var n=r(6189);((Service.prototype=Object.create(n.prototype)).constructor=Service).className="Service";var i=r(7771),s=r(7174),a=r(6444);function Service(e,t){n.call(this,e,t);this.methods={};this._methodsArray=null}Service.fromJSON=function fromJSON(e,t){var r=new Service(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),s=0;s<n.length;++s)r.add(i.fromJSON(n[s],t.methods[n[s]]));if(t.nested)r.addJSON(t.nested);r.comment=t.comment;return r};Service.prototype.toJSON=function toJSON(e){var t=n.prototype.toJSON.call(this,e);var r=e?Boolean(e.keepComments):false;return s.toObject(["options",t&&t.options||undefined,"methods",n.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||undefined,"comment",r?this.comment:undefined])};Object.defineProperty(Service.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}});function clearCache(e){e._methodsArray=null;return e}Service.prototype.get=function get(e){return this.methods[e]||n.prototype.get.call(this,e)};Service.prototype.resolveAll=function resolveAll(){var e=this.methodsArray;for(var t=0;t<e.length;++t)e[t].resolve();return n.prototype.resolve.call(this)};Service.prototype.add=function add(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof i){this.methods[e.name]=e;e.parent=this;return clearCache(this)}return n.prototype.add.call(this,e)};Service.prototype.remove=function remove(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);delete this.methods[e.name];e.parent=null;return clearCache(this)}return n.prototype.remove.call(this,e)};Service.prototype.create=function create(e,t,r){var n=new a.Service(e,t,r);for(var i=0,o;i<this.methodsArray.length;++i){var l=s.lcFirst((o=this._methodsArray[i]).resolve().name).replace(/[^$\w_]/g,"");n[l]=s.codegen(["r","c"],s.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return n}},1157:e=>{e.exports=tokenize;var t=/[\s{}=;:[\],'"()<>]/g,r=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,n=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g;var i=/^ *[*/]+ */,s=/^\s*\*?\/*/,a=/\n/g,o=/\s/,l=/\\(.?)/g;var c={0:"\0",r:"\r",n:"\n",t:"\t"};function unescape(e){return e.replace(l,(function(e,t){switch(t){case"\\":case"":return t;default:return c[t]||""}}))}tokenize.unescape=unescape;function tokenize(e,l){e=e.toString();var c=0,u=e.length,d=1,f=0,h={};var p=[];var g=null;function illegal(e){return Error("illegal "+e+" (line "+d+")")}function readString(){var t=g==="'"?n:r;t.lastIndex=c-1;var i=t.exec(e);if(!i)throw illegal("string");c=t.lastIndex;push(g);g=null;return unescape(i[1])}function charAt(t){return e.charAt(t)}function setComment(t,r,n){var o={type:e.charAt(t++),lineEmpty:false,leading:n};var c;if(l){c=2}else{c=3}var u=t-c,p;do{if(--u<0||(p=e.charAt(u))==="\n"){o.lineEmpty=true;break}}while(p===" "||p==="\t");var g=e.substring(t,r).split(a);for(var m=0;m<g.length;++m)g[m]=g[m].replace(l?s:i,"").trim();o.text=g.join("\n").trim();h[d]=o;f=d}function isDoubleSlashCommentLine(t){var r=findEndOfLine(t);var n=e.substring(t,r);var i=/^\s*\/\//.test(n);return i}function findEndOfLine(e){var t=e;while(t<u&&charAt(t)!=="\n"){t++}return t}function next(){if(p.length>0)return p.shift();if(g)return readString();var r,n,i,s,a,f=c===0;do{if(c===u)return null;r=false;while(o.test(i=charAt(c))){if(i==="\n"){f=true;++d}if(++c===u)return null}if(charAt(c)==="/"){if(++c===u){throw illegal("comment")}if(charAt(c)==="/"){if(!l){a=charAt(s=c+1)==="/";while(charAt(++c)!=="\n"){if(c===u){return null}}++c;if(a){setComment(s,c-1,f);f=true}++d;r=true}else{s=c;a=false;if(isDoubleSlashCommentLine(c-1)){a=true;do{c=findEndOfLine(c);if(c===u){break}c++;if(!f){break}}while(isDoubleSlashCommentLine(c))}else{c=Math.min(u,findEndOfLine(c)+1)}if(a){setComment(s,c,f);f=true}d++;r=true}}else if((i=charAt(c))==="*"){s=c+1;a=l||charAt(s)==="*";do{if(i==="\n"){++d}if(++c===u){throw illegal("comment")}n=i;i=charAt(c)}while(n!=="*"||i!=="/");++c;if(a){setComment(s,c-2,f);f=true}r=true}else{return"/"}}}while(r);var h=c;t.lastIndex=0;var m=t.test(charAt(h++));if(!m)while(h<u&&!t.test(charAt(h)))++h;var v=e.substring(c,c=h);if(v==='"'||v==="'")g=v;return v}function push(e){p.push(e)}function peek(){if(!p.length){var e=next();if(e===null)return null;push(e)}return p[0]}function skip(e,t){var r=peek(),n=r===e;if(n){next();return true}if(!t)throw illegal("token '"+r+"', '"+e+"' expected");return false}function cmnt(e){var t=null;var r;if(e===undefined){r=h[d-1];delete h[d-1];if(r&&(l||r.type==="*"||r.lineEmpty)){t=r.leading?r.text:null}}else{if(f<e){peek()}r=h[e];delete h[e];if(r&&!r.lineEmpty&&(l||r.type==="/")){t=r.leading?null:r.text}}return t}return Object.defineProperty({next:next,peek:peek,push:push,skip:skip,cmnt:cmnt},"line",{get:function(){return d}})}},8520:(e,t,r)=>{e.exports=Type;var n=r(6189);((Type.prototype=Object.create(n.prototype)).constructor=Type).className="Type";var i=r(7732),s=r(4408),a=r(8213),o=r(7777),l=r(6178),c=r(8027),u=r(1011),d=r(3098),f=r(7174),h=r(3072),p=r(5871),g=r(4334),m=r(3617),v=r(3216);function Type(e,t){n.call(this,e,t);this.fields={};this.oneofs=undefined;this.extensions=undefined;this.reserved=undefined;this.group=undefined;this._fieldsById=null;this._fieldsArray=null;this._oneofsArray=null;this._ctor=null}Object.defineProperties(Type.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var r=this.fields[e[t]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=f.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=f.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Type.generateConstructor(this)())},set:function(e){var t=e.prototype;if(!(t instanceof c)){(e.prototype=new c).constructor=e;f.merge(e.prototype,t)}e.$type=e.prototype.$type=this;f.merge(e,c,true);this._ctor=e;var r=0;for(;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:f.oneOfGetter(this._oneofsArray[r].oneof),set:f.oneOfSetter(this._oneofsArray[r].oneof)};if(r)Object.defineProperties(e.prototype,n)}}});Type.generateConstructor=function generateConstructor(e){var t=f.codegen(["p"],e.name);for(var r=0,n;r<e.fieldsArray.length;++r)if((n=e._fieldsArray[r]).map)t("this%s={}",f.safeProp(n.name));else if(n.repeated)t("this%s=[]",f.safeProp(n.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function clearCache(e){e._fieldsById=e._fieldsArray=e._oneofsArray=null;delete e.encode;delete e.decode;delete e.verify;return e}Type.fromJSON=function fromJSON(e,t){var r=new Type(e,t.options);r.extensions=t.extensions;r.reserved=t.reserved;var c=Object.keys(t.fields),u=0;for(;u<c.length;++u)r.add((typeof t.fields[c[u]].keyType!=="undefined"?o.fromJSON:a.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)r.add(s.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var d=t.nested[c[u]];r.add((d.id!==undefined?a.fromJSON:d.fields!==undefined?Type.fromJSON:d.values!==undefined?i.fromJSON:d.methods!==undefined?l.fromJSON:n.fromJSON)(c[u],d))}if(t.extensions&&t.extensions.length)r.extensions=t.extensions;if(t.reserved&&t.reserved.length)r.reserved=t.reserved;if(t.group)r.group=true;if(t.comment)r.comment=t.comment;return r};Type.prototype.toJSON=function toJSON(e){var t=n.prototype.toJSON.call(this,e);var r=e?Boolean(e.keepComments):false;return f.toObject(["options",t&&t.options||undefined,"oneofs",n.arrayToJSON(this.oneofsArray,e),"fields",n.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",t&&t.nested||undefined,"comment",r?this.comment:undefined])};Type.prototype.resolveAll=function resolveAll(){var e=this.fieldsArray,t=0;while(t<e.length)e[t++].resolve();var r=this.oneofsArray;t=0;while(t<r.length)r[t++].resolve();return n.prototype.resolveAll.call(this)};Type.prototype.get=function get(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Type.prototype.add=function add(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&e.extend===undefined){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);if(e.parent)e.parent.remove(e);this.fields[e.name]=e;e.message=this;e.onAdd(this);return clearCache(this)}if(e instanceof s){if(!this.oneofs)this.oneofs={};this.oneofs[e.name]=e;e.onAdd(this);return clearCache(this)}return n.prototype.add.call(this,e)};Type.prototype.remove=function remove(e){if(e instanceof a&&e.extend===undefined){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);delete this.fields[e.name];e.parent=null;e.onRemove(this);return clearCache(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);delete this.oneofs[e.name];e.parent=null;e.onRemove(this);return clearCache(this)}return n.prototype.remove.call(this,e)};Type.prototype.isReservedId=function isReservedId(e){return n.isReservedId(this.reserved,e)};Type.prototype.isReservedName=function isReservedName(e){return n.isReservedName(this.reserved,e)};Type.prototype.create=function create(e){return new this.ctor(e)};Type.prototype.setup=function setup(){var e=this.fullName,t=[];for(var r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=h(this)({Writer:d,types:t,util:f});this.decode=p(this)({Reader:u,types:t,util:f});this.verify=g(this)({types:t,util:f});this.fromObject=m.fromObject(this)({types:t,util:f});this.toObject=m.toObject(this)({types:t,util:f});var n=v[e];if(n){var i=Object.create(this);i.fromObject=this.fromObject;this.fromObject=n.fromObject.bind(i);i.toObject=this.toObject;this.toObject=n.toObject.bind(i)}return this};Type.prototype.encode=function encode_setup(e,t){return this.setup().encode(e,t)};Type.prototype.encodeDelimited=function encodeDelimited(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};Type.prototype.decode=function decode_setup(e,t){return this.setup().decode(e,t)};Type.prototype.decodeDelimited=function decodeDelimited(e){if(!(e instanceof u))e=u.create(e);return this.decode(e,e.uint32())};Type.prototype.verify=function verify_setup(e){return this.setup().verify(e)};Type.prototype.fromObject=function fromObject(e){return this.setup().fromObject(e)};Type.prototype.toObject=function toObject(e,t){return this.setup().toObject(e,t)};Type.d=function decorateType(e){return function typeDecorator(t){f.decorateType(t,e)}}},288:(e,t,r)=>{var n=t;var i=r(7174);var s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function bake(e,t){var r=0,n={};t|=0;while(r<e.length)n[s[r+t]]=e[r++];return n}n.basic=bake([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);n.defaults=bake([0,0,0,0,0,0,0,0,0,0,0,0,false,"",i.emptyArray,null]);n.long=bake([0,0,0,1,1],7);n.mapKey=bake([0,0,0,5,5,0,0,0,1,1,0,2],2);n.packed=bake([1,5,0,0,0,5,5,0,0,0,1,1,0])},7174:(e,t,r)=>{var n=e.exports=r(1241);var i=r(73);var s,a;n.codegen=r(8882);n.fetch=r(663);n.path=r(4761);n.fs=n.inquire("fs");n.toArray=function toArray(e){if(e){var t=Object.keys(e),r=new Array(t.length),n=0;while(n<t.length)r[n]=e[t[n++]];return r}return[]};n.toObject=function toObject(e){var t={},r=0;while(r<e.length){var n=e[r++],i=e[r++];if(i!==undefined)t[n]=i}return t};var o=/\\/g,l=/"/g;n.isReserved=function isReserved(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};n.safeProp=function safeProp(e){if(!/^[$\w_]+$/.test(e)||n.isReserved(e))return'["'+e.replace(o,"\\\\").replace(l,'\\"')+'"]';return"."+e};n.ucFirst=function ucFirst(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;n.camelCase=function camelCase(e){return e.substring(0,1)+e.substring(1).replace(c,(function(e,t){return t.toUpperCase()}))};n.compareFieldsById=function compareFieldsById(e,t){return e.id-t.id};n.decorateType=function decorateType(e,t){if(e.$type){if(t&&e.$type.name!==t){n.decorateRoot.remove(e.$type);e.$type.name=t;n.decorateRoot.add(e.$type)}return e.$type}if(!s)s=r(8520);var i=new s(t||e.name);n.decorateRoot.add(i);i.ctor=e;Object.defineProperty(e,"$type",{value:i,enumerable:false});Object.defineProperty(e.prototype,"$type",{value:i,enumerable:false});return i};var u=0;n.decorateEnum=function decorateEnum(e){if(e.$type)return e.$type;if(!a)a=r(7732);var t=new a("Enum"+u++,e);n.decorateRoot.add(t);Object.defineProperty(e,"$type",{value:t,enumerable:false});return t};n.setProperty=function setProperty(e,t,r){function setProp(e,t,r){var n=t.shift();if(n==="__proto__"||n==="prototype"){return e}if(t.length>0){e[n]=setProp(e[n]||{},t,r)}else{var i=e[n];if(i)r=[].concat(i).concat(r);e[n]=r}return e}if(typeof e!=="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");t=t.split(".");return setProp(e,t,r)};Object.defineProperty(n,"decorateRoot",{get:function(){return i["decorated"]||(i["decorated"]=new(r(2614)))}})},8374:(e,t,r)=>{e.exports=LongBits;var n=r(1241);function LongBits(e,t){this.lo=e>>>0;this.hi=t>>>0}var i=LongBits.zero=new LongBits(0,0);i.toNumber=function(){return 0};i.zzEncode=i.zzDecode=function(){return this};i.length=function(){return 1};var s=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function fromNumber(e){if(e===0)return i;var t=e<0;if(t)e=-e;var r=e>>>0,n=(e-r)/4294967296>>>0;if(t){n=~n>>>0;r=~r>>>0;if(++r>4294967295){r=0;if(++n>4294967295)n=0}}return new LongBits(r,n)};LongBits.from=function from(e){if(typeof e==="number")return LongBits.fromNumber(e);if(n.isString(e)){if(n.Long)e=n.Long.fromString(e);else return LongBits.fromNumber(parseInt(e,10))}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):i};LongBits.prototype.toNumber=function toNumber(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;if(!t)r=r+1>>>0;return-(t+r*4294967296)}return this.lo+this.hi*4294967296};LongBits.prototype.toLong=function toLong(e){return n.Long?new n.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;LongBits.fromHash=function fromHash(e){if(e===s)return i;return new LongBits((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)};LongBits.prototype.toHash=function toHash(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};LongBits.prototype.zzEncode=function zzEncode(){var e=this.hi>>31;this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0;this.lo=(this.lo<<1^e)>>>0;return this};LongBits.prototype.zzDecode=function zzDecode(){var e=-(this.lo&1);this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0;this.hi=(this.hi>>>1^e)>>>0;return this};LongBits.prototype.length=function length(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},1241:function(e,t,r){var n=t;n.asPromise=r(252);n.base64=r(6718);n.EventEmitter=r(6850);n.float=r(3182);n.inquire=r(94);n.utf8=r(9049);n.pool=r(7743);n.LongBits=r(8374);n.isNode=Boolean(typeof global!=="undefined"&&global&&global.process&&global.process.versions&&global.process.versions.node);n.global=n.isNode&&global||typeof window!=="undefined"&&window||typeof self!=="undefined"&&self||this;n.emptyArray=Object.freeze?Object.freeze([]):[];n.emptyObject=Object.freeze?Object.freeze({}):{};n.isInteger=Number.isInteger||function isInteger(e){return typeof e==="number"&&isFinite(e)&&Math.floor(e)===e};n.isString=function isString(e){return typeof e==="string"||e instanceof String};n.isObject=function isObject(e){return e&&typeof e==="object"};n.isset=n.isSet=function isSet(e,t){var r=e[t];if(r!=null&&e.hasOwnProperty(t))return typeof r!=="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0;return false};n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}();n._Buffer_from=null;n._Buffer_allocUnsafe=null;n.newBuffer=function newBuffer(e){return typeof e==="number"?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):typeof Uint8Array==="undefined"?e:new Uint8Array(e)};n.Array=typeof Uint8Array!=="undefined"?Uint8Array:Array;n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long");n.key2Re=/^true|false|0|1$/;n.key32Re=/^-?(?:0|[1-9][0-9]*)$/;n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;n.longToHash=function longToHash(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash};n.longFromHash=function longFromHash(e,t){var r=n.LongBits.fromHash(e);if(n.Long)return n.Long.fromBits(r.lo,r.hi,t);return r.toNumber(Boolean(t))};function merge(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)if(e[n[i]]===undefined||!r)e[n[i]]=t[n[i]];return e}n.merge=merge;n.lcFirst=function lcFirst(e){return e.charAt(0).toLowerCase()+e.substring(1)};function newError(e){function CustomError(e,t){if(!(this instanceof CustomError))return new CustomError(e,t);Object.defineProperty(this,"message",{get:function(){return e}});if(Error.captureStackTrace)Error.captureStackTrace(this,CustomError);else Object.defineProperty(this,"stack",{value:(new Error).stack||""});if(t)merge(this,t)}CustomError.prototype=Object.create(Error.prototype,{constructor:{value:CustomError,writable:true,enumerable:false,configurable:true},name:{get:function get(){return e},set:undefined,enumerable:false,configurable:true},toString:{value:function value(){return this.name+": "+this.message},writable:true,enumerable:false,configurable:true}});return CustomError}n.newError=newError;n.ProtocolError=newError("ProtocolError");n.oneOfGetter=function getOneOf(e){var t={};for(var r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(t[e[r]]===1&&this[e[r]]!==undefined&&this[e[r]]!==null)return e[r]}};n.oneOfSetter=function setOneOf(e){return function(t){for(var r=0;r<e.length;++r)if(e[r]!==t)delete this[e[r]]}};n.toJSONOptions={longs:String,enums:String,bytes:String,json:true};n._configure=function(){var e=n.Buffer;if(!e){n._Buffer_from=n._Buffer_allocUnsafe=null;return}n._Buffer_from=e.from!==Uint8Array.from&&e.from||function Buffer_from(t,r){return new e(t,r)};n._Buffer_allocUnsafe=e.allocUnsafe||function Buffer_allocUnsafe(t){return new e(t)}}},4334:(e,t,r)=>{e.exports=verifier;var n=r(7732),i=r(7174);function invalid(e,t){return e.name+": "+t+(e.repeated&&t!=="array"?"[]":e.map&&t!=="object"?"{k:"+e.keyType+"}":"")+" expected"}function genVerifyValue(e,t,r,i){if(t.resolvedType){if(t.resolvedType instanceof n){e("switch(%s){",i)("default:")("return%j",invalid(t,"enum value"));for(var s=Object.keys(t.resolvedType.values),a=0;a<s.length;++a)e("case %i:",t.resolvedType.values[s[a]]);e("break")("}")}else{e("{")("var e=types[%i].verify(%s);",r,i)("if(e)")("return%j+e",t.name+".")("}")}}else{switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",invalid(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",invalid(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",invalid(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",invalid(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",invalid(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",invalid(t,"buffer"));break}}return e}function genVerifyKey(e,t,r){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",r)("return%j",invalid(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",r)("return%j",invalid(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",r)("return%j",invalid(t,"boolean key"));break}return e}function verifier(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected");var r=e.oneofsArray,n={};if(r.length)t("var p={}");for(var s=0;s<e.fieldsArray.length;++s){var a=e._fieldsArray[s].resolve(),o="m"+i.safeProp(a.name);if(a.optional)t("if(%s!=null&&m.hasOwnProperty(%j)){",o,a.name);if(a.map){t("if(!util.isObject(%s))",o)("return%j",invalid(a,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){");genVerifyKey(t,a,"k[i]");genVerifyValue(t,a,s,o+"[k[i]]")("}")}else if(a.repeated){t("if(!Array.isArray(%s))",o)("return%j",invalid(a,"array"))("for(var i=0;i<%s.length;++i){",o);genVerifyValue(t,a,s,o+"[i]")("}")}else{if(a.partOf){var l=i.safeProp(a.partOf.name);if(n[a.partOf.name]===1)t("if(p%s===1)",l)("return%j",a.partOf.name+": multiple values");n[a.partOf.name]=1;t("p%s=1",l)}genVerifyValue(t,a,s,o)}if(a.optional)t("}")}return t("return null")}},3216:(e,t,r)=>{var n=t;var i=r(8027);n[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1);var r=this.lookup(t);if(r){var n=e["@type"].charAt(0)==="."?e["@type"].slice(1):e["@type"];if(n.indexOf("/")===-1){n="/"+n}return this.create({type_url:n,value:r.encode(r.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var r="type.googleapis.com/";var n="";var s="";if(t&&t.json&&e.type_url&&e.value){s=e.type_url.substring(e.type_url.lastIndexOf("/")+1);n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var a=this.lookup(s);if(a)e=a.decode(e.value)}if(!(e instanceof this.ctor)&&e instanceof i){var o=e.$type.toObject(e,t);var l=e.$type.fullName[0]==="."?e.$type.fullName.slice(1):e.$type.fullName;if(n===""){n=r}s=n+l;o["@type"]=s;return o}return this.toObject(e,t)}}},3098:(e,t,r)=>{e.exports=Writer;var n=r(1241);var i;var s=n.LongBits,a=n.base64,o=n.utf8;function Op(e,t,r){this.fn=e;this.len=t;this.next=undefined;this.val=r}function noop(){}function State(e){this.head=e.head;this.tail=e.tail;this.len=e.len;this.next=e.states}function Writer(){this.len=0;this.head=new Op(noop,0,0);this.tail=this.head;this.states=null}var l=function create(){return n.Buffer?function create_buffer_setup(){return(Writer.create=function create_buffer(){return new i})()}:function create_array(){return new Writer}};Writer.create=l();Writer.alloc=function alloc(e){return new n.Array(e)};if(n.Array!==Array)Writer.alloc=n.pool(Writer.alloc,n.Array.prototype.subarray);Writer.prototype._push=function push(e,t,r){this.tail=this.tail.next=new Op(e,t,r);this.len+=t;return this};function writeByte(e,t,r){t[r]=e&255}function writeVarint32(e,t,r){while(e>127){t[r++]=e&127|128;e>>>=7}t[r]=e}function VarintOp(e,t){this.len=e;this.next=undefined;this.val=t}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer.prototype.uint32=function write_uint32(e){this.len+=(this.tail=this.tail.next=new VarintOp((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len;return this};Writer.prototype.int32=function write_int32(e){return e<0?this._push(writeVarint64,10,s.fromNumber(e)):this.uint32(e)};Writer.prototype.sint32=function write_sint32(e){return this.uint32((e<<1^e>>31)>>>0)};function writeVarint64(e,t,r){while(e.hi){t[r++]=e.lo&127|128;e.lo=(e.lo>>>7|e.hi<<25)>>>0;e.hi>>>=7}while(e.lo>127){t[r++]=e.lo&127|128;e.lo=e.lo>>>7}t[r++]=e.lo}Writer.prototype.uint64=function write_uint64(e){var t=s.from(e);return this._push(writeVarint64,t.length(),t)};Writer.prototype.int64=Writer.prototype.uint64;Writer.prototype.sint64=function write_sint64(e){var t=s.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)};Writer.prototype.bool=function write_bool(e){return this._push(writeByte,1,e?1:0)};function writeFixed32(e,t,r){t[r]=e&255;t[r+1]=e>>>8&255;t[r+2]=e>>>16&255;t[r+3]=e>>>24}Writer.prototype.fixed32=function write_fixed32(e){return this._push(writeFixed32,4,e>>>0)};Writer.prototype.sfixed32=Writer.prototype.fixed32;Writer.prototype.fixed64=function write_fixed64(e){var t=s.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)};Writer.prototype.sfixed64=Writer.prototype.fixed64;Writer.prototype.float=function write_float(e){return this._push(n.float.writeFloatLE,4,e)};Writer.prototype.double=function write_double(e){return this._push(n.float.writeDoubleLE,8,e)};var c=n.Array.prototype.set?function writeBytes_set(e,t,r){t.set(e,r)}:function writeBytes_for(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};Writer.prototype.bytes=function write_bytes(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(n.isString(e)){var r=Writer.alloc(t=a.length(e));a.decode(e,r,0);e=r}return this.uint32(t)._push(c,t,e)};Writer.prototype.string=function write_string(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(writeByte,1,0)};Writer.prototype.fork=function fork(){this.states=new State(this);this.head=this.tail=new Op(noop,0,0);this.len=0;return this};Writer.prototype.reset=function reset(){if(this.states){this.head=this.states.head;this.tail=this.states.tail;this.len=this.states.len;this.states=this.states.next}else{this.head=this.tail=new Op(noop,0,0);this.len=0}return this};Writer.prototype.ldelim=function ldelim(){var e=this.head,t=this.tail,r=this.len;this.reset().uint32(r);if(r){this.tail.next=e.next;this.tail=t;this.len+=r}return this};Writer.prototype.finish=function finish(){var e=this.head.next,t=this.constructor.alloc(this.len),r=0;while(e){e.fn(e.val,t,r);r+=e.len;e=e.next}return t};Writer._configure=function(e){i=e;Writer.create=l();i._configure()}},1863:(e,t,r)=>{e.exports=BufferWriter;var n=r(3098);(BufferWriter.prototype=Object.create(n.prototype)).constructor=BufferWriter;var i=r(1241);function BufferWriter(){n.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=i._Buffer_allocUnsafe;BufferWriter.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&i.Buffer.prototype.set.name==="set"?function writeBytesBuffer_set(e,t,r){t.set(e,r)}:function writeBytesBuffer_copy(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}};BufferWriter.prototype.bytes=function write_bytes_buffer(e){if(i.isString(e))e=i._Buffer_from(e,"base64");var t=e.length>>>0;this.uint32(t);if(t)this._push(BufferWriter.writeBytesBuffer,t,e);return this};function writeStringBuffer(e,t,r){if(e.length<40)i.utf8.write(e,t,r);else if(t.utf8Write)t.utf8Write(e,r);else t.write(e,r)}BufferWriter.prototype.string=function write_string_buffer(e){var t=i.Buffer.byteLength(e);this.uint32(t);if(t)this._push(writeStringBuffer,t,e);return this};BufferWriter._configure()},1867:(e,t,r)=>{var n=r(4300);var i=n.Buffer;function copyProps(e,t){for(var r in e){t[r]=e[r]}}if(i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow){e.exports=n}else{copyProps(n,t);t.Buffer=SafeBuffer}function SafeBuffer(e,t,r){return i(e,t,r)}copyProps(i,SafeBuffer);SafeBuffer.from=function(e,t,r){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return i(e,t,r)};SafeBuffer.alloc=function(e,t,r){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var n=i(e);if(t!==undefined){if(typeof r==="string"){n.fill(t,r)}else{n.fill(t)}}else{n.fill(0)}return n};SafeBuffer.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return i(e)};SafeBuffer.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return n.SlowBuffer(e)}},7560:(e,t)=>{const{hasOwnProperty:r}=Object.prototype;const n=configure();n.configure=configure;n.stringify=n;n.default=n;t.stringify=n;t.configure=configure;e.exports=n;const i=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/;function strEscape(e){if(e.length<5e3&&!i.test(e)){return`"${e}"`}return JSON.stringify(e)}function insertSort(e){if(e.length>200){return e.sort()}for(let t=1;t<e.length;t++){const r=e[t];let n=t;while(n!==0&&e[n-1]>r){e[n]=e[n-1];n--}e[n]=r}return e}const s=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function isTypedArrayWithEntries(e){return s.call(e)!==undefined&&e.length!==0}function stringifyTypedArray(e,t,r){if(e.length<r){r=e.length}const n=t===","?"":" ";let i=`"0":${n}${e[0]}`;for(let s=1;s<r;s++){i+=`${t}"${s}":${n}${e[s]}`}return i}function getCircularValueOption(e){if(r.call(e,"circularValue")){const t=e.circularValue;if(typeof t==="string"){return`"${t}"`}if(t==null){return t}if(t===Error||t===TypeError){return{toString(){throw new TypeError("Converting circular structure to JSON")}}}throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function getBooleanOption(e,t){let n;if(r.call(e,t)){n=e[t];if(typeof n!=="boolean"){throw new TypeError(`The "${t}" argument must be of type boolean`)}}return n===undefined?true:n}function getPositiveIntegerOption(e,t){let n;if(r.call(e,t)){n=e[t];if(typeof n!=="number"){throw new TypeError(`The "${t}" argument must be of type number`)}if(!Number.isInteger(n)){throw new TypeError(`The "${t}" argument must be an integer`)}if(n<1){throw new RangeError(`The "${t}" argument must be >= 1`)}}return n===undefined?Infinity:n}function getItemCount(e){if(e===1){return"1 item"}return`${e} items`}function getUniqueReplacerSet(e){const t=new Set;for(const r of e){if(typeof r==="string"||typeof r==="number"){t.add(String(r))}}return t}function getStrictOption(e){if(r.call(e,"strict")){const t=e.strict;if(typeof t!=="boolean"){throw new TypeError('The "strict" argument must be of type boolean')}if(t){return e=>{let t=`Object can not safely be stringified. Received type ${typeof e}`;if(typeof e!=="function")t+=` (${e.toString()})`;throw new Error(t)}}}}function configure(e){e={...e};const t=getStrictOption(e);if(t){if(e.bigint===undefined){e.bigint=false}if(!("circularValue"in e)){e.circularValue=Error}}const r=getCircularValueOption(e);const n=getBooleanOption(e,"bigint");const i=getBooleanOption(e,"deterministic");const s=getPositiveIntegerOption(e,"maximumDepth");const a=getPositiveIntegerOption(e,"maximumBreadth");function stringifyFnReplacer(e,o,l,c,u,d){let f=o[e];if(typeof f==="object"&&f!==null&&typeof f.toJSON==="function"){f=f.toJSON(e)}f=c.call(o,e,f);switch(typeof f){case"string":return strEscape(f);case"object":{if(f===null){return"null"}if(l.indexOf(f)!==-1){return r}let e="";let t=",";const n=d;if(Array.isArray(f)){if(f.length===0){return"[]"}if(s<l.length+1){return'"[Array]"'}l.push(f);if(u!==""){d+=u;e+=`\n${d}`;t=`,\n${d}`}const r=Math.min(f.length,a);let i=0;for(;i<r-1;i++){const r=stringifyFnReplacer(String(i),f,l,c,u,d);e+=r!==undefined?r:"null";e+=t}const o=stringifyFnReplacer(String(i),f,l,c,u,d);e+=o!==undefined?o:"null";if(f.length-1>a){const r=f.length-a-1;e+=`${t}"... ${getItemCount(r)} not stringified"`}if(u!==""){e+=`\n${n}`}l.pop();return`[${e}]`}let o=Object.keys(f);const h=o.length;if(h===0){return"{}"}if(s<l.length+1){return'"[Object]"'}let p="";let g="";if(u!==""){d+=u;t=`,\n${d}`;p=" "}const m=Math.min(h,a);if(i&&!isTypedArrayWithEntries(f)){o=insertSort(o)}l.push(f);for(let r=0;r<m;r++){const n=o[r];const i=stringifyFnReplacer(n,f,l,c,u,d);if(i!==undefined){e+=`${g}${strEscape(n)}:${p}${i}`;g=t}}if(h>a){const r=h-a;e+=`${g}"...":${p}"${getItemCount(r)} not stringified"`;g=t}if(u!==""&&g.length>1){e=`\n${d}${e}\n${n}`}l.pop();return`{${e}}`}case"number":return isFinite(f)?String(f):t?t(f):"null";case"boolean":return f===true?"true":"false";case"undefined":return undefined;case"bigint":if(n){return String(f)}default:return t?t(f):undefined}}function stringifyArrayReplacer(e,i,o,l,c,u){if(typeof i==="object"&&i!==null&&typeof i.toJSON==="function"){i=i.toJSON(e)}switch(typeof i){case"string":return strEscape(i);case"object":{if(i===null){return"null"}if(o.indexOf(i)!==-1){return r}const e=u;let t="";let n=",";if(Array.isArray(i)){if(i.length===0){return"[]"}if(s<o.length+1){return'"[Array]"'}o.push(i);if(c!==""){u+=c;t+=`\n${u}`;n=`,\n${u}`}const r=Math.min(i.length,a);let d=0;for(;d<r-1;d++){const e=stringifyArrayReplacer(String(d),i[d],o,l,c,u);t+=e!==undefined?e:"null";t+=n}const f=stringifyArrayReplacer(String(d),i[d],o,l,c,u);t+=f!==undefined?f:"null";if(i.length-1>a){const e=i.length-a-1;t+=`${n}"... ${getItemCount(e)} not stringified"`}if(c!==""){t+=`\n${e}`}o.pop();return`[${t}]`}o.push(i);let d="";if(c!==""){u+=c;n=`,\n${u}`;d=" "}let f="";for(const e of l){const r=stringifyArrayReplacer(e,i[e],o,l,c,u);if(r!==undefined){t+=`${f}${strEscape(e)}:${d}${r}`;f=n}}if(c!==""&&f.length>1){t=`\n${u}${t}\n${e}`}o.pop();return`{${t}}`}case"number":return isFinite(i)?String(i):t?t(i):"null";case"boolean":return i===true?"true":"false";case"undefined":return undefined;case"bigint":if(n){return String(i)}default:return t?t(i):undefined}}function stringifyIndent(e,o,l,c,u){switch(typeof o){case"string":return strEscape(o);case"object":{if(o===null){return"null"}if(typeof o.toJSON==="function"){o=o.toJSON(e);if(typeof o!=="object"){return stringifyIndent(e,o,l,c,u)}if(o===null){return"null"}}if(l.indexOf(o)!==-1){return r}const t=u;if(Array.isArray(o)){if(o.length===0){return"[]"}if(s<l.length+1){return'"[Array]"'}l.push(o);u+=c;let e=`\n${u}`;const r=`,\n${u}`;const n=Math.min(o.length,a);let i=0;for(;i<n-1;i++){const t=stringifyIndent(String(i),o[i],l,c,u);e+=t!==undefined?t:"null";e+=r}const d=stringifyIndent(String(i),o[i],l,c,u);e+=d!==undefined?d:"null";if(o.length-1>a){const t=o.length-a-1;e+=`${r}"... ${getItemCount(t)} not stringified"`}e+=`\n${t}`;l.pop();return`[${e}]`}let n=Object.keys(o);const d=n.length;if(d===0){return"{}"}if(s<l.length+1){return'"[Object]"'}u+=c;const f=`,\n${u}`;let h="";let p="";let g=Math.min(d,a);if(isTypedArrayWithEntries(o)){h+=stringifyTypedArray(o,f,a);n=n.slice(o.length);g-=o.length;p=f}if(i){n=insertSort(n)}l.push(o);for(let e=0;e<g;e++){const t=n[e];const r=stringifyIndent(t,o[t],l,c,u);if(r!==undefined){h+=`${p}${strEscape(t)}: ${r}`;p=f}}if(d>a){const e=d-a;h+=`${p}"...": "${getItemCount(e)} not stringified"`;p=f}if(p!==""){h=`\n${u}${h}\n${t}`}l.pop();return`{${h}}`}case"number":return isFinite(o)?String(o):t?t(o):"null";case"boolean":return o===true?"true":"false";case"undefined":return undefined;case"bigint":if(n){return String(o)}default:return t?t(o):undefined}}function stringifySimple(e,o,l){switch(typeof o){case"string":return strEscape(o);case"object":{if(o===null){return"null"}if(typeof o.toJSON==="function"){o=o.toJSON(e);if(typeof o!=="object"){return stringifySimple(e,o,l)}if(o===null){return"null"}}if(l.indexOf(o)!==-1){return r}let t="";if(Array.isArray(o)){if(o.length===0){return"[]"}if(s<l.length+1){return'"[Array]"'}l.push(o);const e=Math.min(o.length,a);let r=0;for(;r<e-1;r++){const e=stringifySimple(String(r),o[r],l);t+=e!==undefined?e:"null";t+=","}const n=stringifySimple(String(r),o[r],l);t+=n!==undefined?n:"null";if(o.length-1>a){const e=o.length-a-1;t+=`,"... ${getItemCount(e)} not stringified"`}l.pop();return`[${t}]`}let n=Object.keys(o);const c=n.length;if(c===0){return"{}"}if(s<l.length+1){return'"[Object]"'}let u="";let d=Math.min(c,a);if(isTypedArrayWithEntries(o)){t+=stringifyTypedArray(o,",",a);n=n.slice(o.length);d-=o.length;u=","}if(i){n=insertSort(n)}l.push(o);for(let e=0;e<d;e++){const r=n[e];const i=stringifySimple(r,o[r],l);if(i!==undefined){t+=`${u}${strEscape(r)}:${i}`;u=","}}if(c>a){const e=c-a;t+=`${u}"...":"${getItemCount(e)} not stringified"`}l.pop();return`{${t}}`}case"number":return isFinite(o)?String(o):t?t(o):"null";case"boolean":return o===true?"true":"false";case"undefined":return undefined;case"bigint":if(n){return String(o)}default:return t?t(o):undefined}}function stringify(e,t,r){if(arguments.length>1){let n="";if(typeof r==="number"){n=" ".repeat(Math.min(r,10))}else if(typeof r==="string"){n=r.slice(0,10)}if(t!=null){if(typeof t==="function"){return stringifyFnReplacer("",{"":e},[],t,n,"")}if(Array.isArray(t)){return stringifyArrayReplacer("",e,[],getUniqueReplacerSet(t),n,"")}}if(n.length!==0){return stringifyIndent("",e,[],n,"")}}return stringifySimple("",e,[])}return stringify}},8679:(e,t,r)=>{var n=r(8542);var i=Array.prototype.concat;var s=Array.prototype.slice;var a=e.exports=function swizzle(e){var t=[];for(var r=0,a=e.length;r<a;r++){var o=e[r];if(n(o)){t=i.call(t,s.call(o))}else{t.push(o)}}return t};a.wrap=function(e){return function(){return e(a(arguments))}}},8542:e=>{e.exports=function isArrayish(e){if(!e||typeof e==="string"){return false}return e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}},5315:(e,t)=>{t.get=function(e){var r=Error.stackTraceLimit;Error.stackTraceLimit=Infinity;var n={};var i=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t};Error.captureStackTrace(n,e||t.get);var s=n.stack;Error.prepareStackTrace=i;Error.stackTraceLimit=r;return s};t.parse=function(e){if(!e.stack){return[]}var t=this;var r=e.stack.split("\n").slice(1);return r.map((function(e){if(e.match(/^\s*[-]{4,}$/)){return t._createParsedCallSite({fileName:e,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null})}var r=e.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(!r){return}var n=null;var i=null;var s=null;var a=null;var o=null;var l=r[5]==="native";if(r[1]){s=r[1];var c=s.lastIndexOf(".");if(s[c-1]==".")c--;if(c>0){n=s.substr(0,c);i=s.substr(c+1);var u=n.indexOf(".Module");if(u>0){s=s.substr(u+1);n=n.substr(0,u)}}a=null}if(i){a=n;o=i}if(i==="<anonymous>"){o=null;s=null}var d={fileName:r[2]||null,lineNumber:parseInt(r[3],10)||null,functionName:s,typeName:a,methodName:o,columnNumber:parseInt(r[4],10)||null,native:l};return t._createParsedCallSite(d)})).filter((function(e){return!!e}))};function CallSite(e){for(var t in e){this[t]=e[t]}}var r=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"];var n=["topLevel","eval","native","constructor"];r.forEach((function(e){CallSite.prototype[e]=null;CallSite.prototype["get"+e[0].toUpperCase()+e.substr(1)]=function(){return this[e]}}));n.forEach((function(e){CallSite.prototype[e]=false;CallSite.prototype["is"+e[0].toUpperCase()+e.substr(1)]=function(){return this[e]}}));t._createParsedCallSite=function(e){return new CallSite(e)}},4841:(e,t,r)=>{var n=r(1867).Buffer;var i=n.isEncoding||function(e){e=""+e;switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function _normalizeEncoding(e){if(!e)return"utf8";var t;while(true){switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase();t=true}}}function normalizeEncoding(e){var t=_normalizeEncoding(e);if(typeof t!=="string"&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}t.s=StringDecoder;function StringDecoder(e){this.encoding=normalizeEncoding(e);var t;switch(this.encoding){case"utf16le":this.text=utf16Text;this.end=utf16End;t=4;break;case"utf8":this.fillLast=utf8FillLast;t=4;break;case"base64":this.text=base64Text;this.end=base64End;t=3;break;default:this.write=simpleWrite;this.end=simpleEnd;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=n.allocUnsafe(t)}StringDecoder.prototype.write=function(e){if(e.length===0)return"";var t;var r;if(this.lastNeed){t=this.fillLast(e);if(t===undefined)return"";r=this.lastNeed;this.lastNeed=0}else{r=0}if(r<e.length)return t?t+this.text(e,r):this.text(e,r);return t||""};StringDecoder.prototype.end=utf8End;StringDecoder.prototype.text=utf8Text;StringDecoder.prototype.fillLast=function(e){if(this.lastNeed<=e.length){e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length);this.lastNeed-=e.length};function utf8CheckByte(e){if(e<=127)return 0;else if(e>>5===6)return 2;else if(e>>4===14)return 3;else if(e>>3===30)return 4;return e>>6===2?-1:-2}function utf8CheckIncomplete(e,t,r){var n=t.length-1;if(n<r)return 0;var i=utf8CheckByte(t[n]);if(i>=0){if(i>0)e.lastNeed=i-1;return i}if(--n<r||i===-2)return 0;i=utf8CheckByte(t[n]);if(i>=0){if(i>0)e.lastNeed=i-2;return i}if(--n<r||i===-2)return 0;i=utf8CheckByte(t[n]);if(i>=0){if(i>0){if(i===2)i=0;else e.lastNeed=i-3}return i}return 0}function utf8CheckExtraBytes(e,t,r){if((t[0]&192)!==128){e.lastNeed=0;return""}if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128){e.lastNeed=1;return""}if(e.lastNeed>2&&t.length>2){if((t[2]&192)!==128){e.lastNeed=2;return""}}}}function utf8FillLast(e){var t=this.lastTotal-this.lastNeed;var r=utf8CheckExtraBytes(this,e,t);if(r!==undefined)return r;if(this.lastNeed<=e.length){e.copy(this.lastChar,t,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,t,0,e.length);this.lastNeed-=e.length}function utf8Text(e,t){var r=utf8CheckIncomplete(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);e.copy(this.lastChar,0,n);return e.toString("utf8",t,n)}function utf8End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+"";return t}function utf16Text(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1];return r.slice(0,-1)}}return r}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=e[e.length-1];return e.toString("utf16le",t,e.length-1)}function utf16End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function base64Text(e,t){var r=(e.length-t)%3;if(r===0)return e.toString("base64",t);this.lastNeed=3-r;this.lastTotal=3;if(r===1){this.lastChar[0]=e[e.length-1]}else{this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1]}return e.toString("base64",t,e.length-r)}function base64End(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+this.lastChar.toString("base64",0,3-this.lastNeed);return t}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}},7014:e=>{e.exports=function hex(e){for(var t=0,r=0;t<e.length;r=e.charCodeAt(t++)+((r<<5)-r));var n=Math.floor(Math.abs(Math.sin(r)*1e4%1*16777216)).toString(16);return"#"+Array(6-n.length+1).join("0")+n}},1416:(e,t)=>{t.levels={error:0,warn:1,help:2,data:3,info:4,debug:5,prompt:6,verbose:7,input:8,silly:9};t.colors={error:"red",warn:"yellow",help:"cyan",data:"grey",info:"green",debug:"blue",prompt:"grey",verbose:"cyan",input:"grey",silly:"magenta"}},7113:(e,t,r)=>{Object.defineProperty(t,"cli",{value:r(1416)});Object.defineProperty(t,"npm",{value:r(3568)});Object.defineProperty(t,"syslog",{value:r(6990)})},3568:(e,t)=>{t.levels={error:0,warn:1,info:2,http:3,verbose:4,debug:5,silly:6};t.colors={error:"red",warn:"yellow",info:"green",http:"green",verbose:"cyan",debug:"blue",silly:"magenta"}},6990:(e,t)=>{t.levels={emerg:0,alert:1,crit:2,error:3,warning:4,notice:5,info:6,debug:7};t.colors={emerg:"red",alert:"yellow",crit:"red",error:"red",warning:"red",notice:"yellow",info:"green",debug:"blue"}},3937:(e,t,r)=>{Object.defineProperty(t,"LEVEL",{value:Symbol.for("level")});Object.defineProperty(t,"MESSAGE",{value:Symbol.for("message")});Object.defineProperty(t,"SPLAT",{value:Symbol.for("splat")});Object.defineProperty(t,"configs",{value:r(7113)})},5278:(e,t,r)=>{e.exports=r(3837).deprecate},7281:(e,t,r)=>{e.exports=r(2429);e.exports.LegacyTransportStream=r(6201)},6201:(e,t,r)=>{const n=r(3837);const{LEVEL:i}=r(3937);const s=r(2429);const a=e.exports=function LegacyTransportStream(e={}){s.call(this,e);if(!e.transport||typeof e.transport.log!=="function"){throw new Error("Invalid transport, must be an object with a log method.")}this.transport=e.transport;this.level=this.level||e.transport.level;this.handleExceptions=this.handleExceptions||e.transport.handleExceptions;this._deprecated();function transportError(e){this.emit("error",e,this.transport)}if(!this.transport.__winstonError){this.transport.__winstonError=transportError.bind(this);this.transport.on("error",this.transport.__winstonError)}};n.inherits(a,s);a.prototype._write=function _write(e,t,r){if(this.silent||e.exception===true&&!this.handleExceptions){return r(null)}if(!this.level||this.levels[this.level]>=this.levels[e[i]]){this.transport.log(e[i],e.message,e,this._nop)}r(null)};a.prototype._writev=function _writev(e,t){for(let t=0;t<e.length;t++){if(this._accept(e[t])){this.transport.log(e[t].chunk[i],e[t].chunk.message,e[t].chunk,this._nop);e[t].callback()}}return t(null)};a.prototype._deprecated=function _deprecated(){console.error([`${this.transport.name} is a legacy winston transport. Consider upgrading: `,"- Upgrade docs: https://github.com/winstonjs/winston/blob/master/UPGRADE-3.0.md"].join("\n"))};a.prototype.close=function close(){if(this.transport.close){this.transport.close()}if(this.transport.__winstonError){this.transport.removeListener("error",this.transport.__winstonError);this.transport.__winstonError=null}}},2429:(e,t,r)=>{const n=r(3837);const i=r(6137);const{LEVEL:s}=r(3937);const a=e.exports=function TransportStream(e={}){i.call(this,{objectMode:true,highWaterMark:e.highWaterMark});this.format=e.format;this.level=e.level;this.handleExceptions=e.handleExceptions;this.handleRejections=e.handleRejections;this.silent=e.silent;if(e.log)this.log=e.log;if(e.logv)this.logv=e.logv;if(e.close)this.close=e.close;this.once("pipe",(e=>{this.levels=e.levels;this.parent=e}));this.once("unpipe",(e=>{if(e===this.parent){this.parent=null;if(this.close){this.close()}}}))};n.inherits(a,i);a.prototype._write=function _write(e,t,r){if(this.silent||e.exception===true&&!this.handleExceptions){return r(null)}const n=this.level||this.parent&&this.parent.level;if(!n||this.levels[n]>=this.levels[e[s]]){if(e&&!this.format){return this.log(e,r)}let t;let n;try{n=this.format.transform(Object.assign({},e),this.format.options)}catch(e){t=e}if(t||!n){r();if(t)throw t;return}return this.log(n,r)}this._writableState.sync=false;return r(null)};a.prototype._writev=function _writev(e,t){if(this.logv){const r=e.filter(this._accept,this);if(!r.length){return t(null)}return this.logv(r,t)}for(let r=0;r<e.length;r++){if(!this._accept(e[r]))continue;if(e[r].chunk&&!this.format){this.log(e[r].chunk,e[r].callback);continue}let n;let i;try{i=this.format.transform(Object.assign({},e[r].chunk),this.format.options)}catch(e){n=e}if(n||!i){e[r].callback();if(n){t(null);throw n}}else{this.log(i,e[r].callback)}}return t(null)};a.prototype._accept=function _accept(e){const t=e.chunk;if(this.silent){return false}const r=this.level||this.parent&&this.parent.level;if(t.exception===true||!r||this.levels[r]>=this.levels[t[s]]){if(this.handleExceptions||t.exception!==true){return true}}return false};a.prototype._nop=function _nop(){return void undefined}},5238:e=>{const t={};function createErrorType(e,r,n){if(!n){n=Error}function getMessage(e,t,n){if(typeof r==="string"){return r}else{return r(e,t,n)}}class NodeError extends n{constructor(e,t,r){super(getMessage(e,t,r))}}NodeError.prototype.name=n.name;NodeError.prototype.code=e;t[e]=NodeError}function oneOf(e,t){if(Array.isArray(e)){const r=e.length;e=e.map((e=>String(e)));if(r>2){return`one of ${t} ${e.slice(0,r-1).join(", ")}, or `+e[r-1]}else if(r===2){return`one of ${t} ${e[0]} or ${e[1]}`}else{return`of ${t} ${e[0]}`}}else{return`of ${t} ${String(e)}`}}function startsWith(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function endsWith(e,t,r){if(r===undefined||r>e.length){r=e.length}return e.substring(r-t.length,r)===t}function includes(e,t,r){if(typeof r!=="number"){r=0}if(r+t.length>e.length){return false}else{return e.indexOf(t,r)!==-1}}createErrorType("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError);createErrorType("ERR_INVALID_ARG_TYPE",(function(e,t,r){let n;if(typeof t==="string"&&startsWith(t,"not ")){n="must not be";t=t.replace(/^not /,"")}else{n="must be"}let i;if(endsWith(e," argument")){i=`The ${e} ${n} ${oneOf(t,"type")}`}else{const r=includes(e,".")?"property":"argument";i=`The "${e}" ${r} ${n} ${oneOf(t,"type")}`}i+=`. Received type ${typeof r}`;return i}),TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"}));createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"}));createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");e.exports.q=t},5135:(e,t,r)=>{var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=Duplex;var i=r(1646);var s=r(6137);r(4124)(Duplex,i);{var a=n(s.prototype);for(var o=0;o<a.length;o++){var l=a[o];if(!Duplex.prototype[l])Duplex.prototype[l]=s.prototype[l]}}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);i.call(this,e);s.call(this,e);this.allowHalfOpen=true;if(e){if(e.readable===false)this.readable=false;if(e.writable===false)this.writable=false;if(e.allowHalfOpen===false){this.allowHalfOpen=false;this.once("end",onend)}}}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function onend(){if(this._writableState.ended)return;process.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function set(e){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=e;this._writableState.destroyed=e}})},1646:(e,t,r)=>{e.exports=Readable;var n;Readable.ReadableState=ReadableState;var i=r(2361).EventEmitter;var s=function EElistenerCount(e,t){return e.listeners(t).length};var a=r(3917);var o=r(4300).Buffer;var l=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(e){return o.from(e)}function _isUint8Array(e){return o.isBuffer(e)||e instanceof l}var c=r(3837);var u;if(c&&c.debuglog){u=c.debuglog("stream")}else{u=function debug(){}}var d=r(8233);var f=r(1061);var h=r(318),p=h.getHighWaterMark;var g=r(5238).q,m=g.ERR_INVALID_ARG_TYPE,v=g.ERR_STREAM_PUSH_AFTER_EOF,y=g.ERR_METHOD_NOT_IMPLEMENTED,b=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;var S;var _;var w;r(4124)(Readable,a);var C=f.errorOrDestroy;var E=["error","close","destroy","pause","resume"];function prependListener(e,t,r){if(typeof e.prependListener==="function")return e.prependListener(t,r);if(!e._events||!e._events[t])e.on(t,r);else if(Array.isArray(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}function ReadableState(e,t,i){n=n||r(5135);e=e||{};if(typeof i!=="boolean")i=t instanceof n;this.objectMode=!!e.objectMode;if(i)this.objectMode=this.objectMode||!!e.readableObjectMode;this.highWaterMark=p(this,e,"readableHighWaterMark",i);this.buffer=new d;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.paused=true;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.destroyed=false;this.defaultEncoding=e.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(e.encoding){if(!S)S=r(4841).s;this.decoder=new S(e.encoding);this.encoding=e.encoding}}function Readable(e){n=n||r(5135);if(!(this instanceof Readable))return new Readable(e);var t=this instanceof n;this._readableState=new ReadableState(e,this,t);this.readable=true;if(e){if(typeof e.read==="function")this._read=e.read;if(typeof e.destroy==="function")this._destroy=e.destroy}a.call(this)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function set(e){if(!this._readableState){return}this._readableState.destroyed=e}});Readable.prototype.destroy=f.destroy;Readable.prototype._undestroy=f.undestroy;Readable.prototype._destroy=function(e,t){t(e)};Readable.prototype.push=function(e,t){var r=this._readableState;var n;if(!r.objectMode){if(typeof e==="string"){t=t||r.defaultEncoding;if(t!==r.encoding){e=o.from(e,t);t=""}n=true}}else{n=true}return readableAddChunk(this,e,t,false,n)};Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,true,false)};function readableAddChunk(e,t,r,n,i){u("readableAddChunk",t);var s=e._readableState;if(t===null){s.reading=false;onEofChunk(e,s)}else{var a;if(!i)a=chunkInvalid(s,t);if(a){C(e,a)}else if(s.objectMode||t&&t.length>0){if(typeof t!=="string"&&!s.objectMode&&Object.getPrototypeOf(t)!==o.prototype){t=_uint8ArrayToBuffer(t)}if(n){if(s.endEmitted)C(e,new b);else addChunk(e,s,t,true)}else if(s.ended){C(e,new v)}else if(s.destroyed){return false}else{s.reading=false;if(s.decoder&&!r){t=s.decoder.write(t);if(s.objectMode||t.length!==0)addChunk(e,s,t,false);else maybeReadMore(e,s)}else{addChunk(e,s,t,false)}}}else if(!n){s.reading=false;maybeReadMore(e,s)}}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function addChunk(e,t,r,n){if(t.flowing&&t.length===0&&!t.sync){t.awaitDrain=0;e.emit("data",r)}else{t.length+=t.objectMode?1:r.length;if(n)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)emitReadable(e)}maybeReadMore(e,t)}function chunkInvalid(e,t){var r;if(!_isUint8Array(t)&&typeof t!=="string"&&t!==undefined&&!e.objectMode){r=new m("chunk",["string","Buffer","Uint8Array"],t)}return r}Readable.prototype.isPaused=function(){return this._readableState.flowing===false};Readable.prototype.setEncoding=function(e){if(!S)S=r(4841).s;var t=new S(e);this._readableState.decoder=t;this._readableState.encoding=this._readableState.decoder.encoding;var n=this._readableState.buffer.head;var i="";while(n!==null){i+=t.write(n.data);n=n.next}this._readableState.buffer.clear();if(i!=="")this._readableState.buffer.push(i);this._readableState.length=i.length;return this};var T=1073741824;function computeNewHighWaterMark(e){if(e>=T){e=T}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function howMuchToRead(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=computeNewHighWaterMark(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}Readable.prototype.read=function(e){u("read",e);e=parseInt(e,10);var t=this._readableState;var r=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&((t.highWaterMark!==0?t.length>=t.highWaterMark:t.length>0)||t.ended)){u("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)endReadable(this);else emitReadable(this);return null}e=howMuchToRead(e,t);if(e===0&&t.ended){if(t.length===0)endReadable(this);return null}var n=t.needReadable;u("need readable",n);if(t.length===0||t.length-e<t.highWaterMark){n=true;u("length less than watermark",n)}if(t.ended||t.reading){n=false;u("reading or ended",n)}else if(n){u("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=howMuchToRead(r,t)}var i;if(e>0)i=fromList(e,t);else i=null;if(i===null){t.needReadable=t.length<=t.highWaterMark;e=0}else{t.length-=e;t.awaitDrain=0}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)endReadable(this)}if(i!==null)this.emit("data",i);return i};function onEofChunk(e,t){u("onEofChunk");if(t.ended)return;if(t.decoder){var r=t.decoder.end();if(r&&r.length){t.buffer.push(r);t.length+=t.objectMode?1:r.length}}t.ended=true;if(t.sync){emitReadable(e)}else{t.needReadable=false;if(!t.emittedReadable){t.emittedReadable=true;emitReadable_(e)}}}function emitReadable(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable);t.needReadable=false;if(!t.emittedReadable){u("emitReadable",t.flowing);t.emittedReadable=true;process.nextTick(emitReadable_,e)}}function emitReadable_(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended);if(!t.destroyed&&(t.length||t.ended)){e.emit("readable");t.emittedReadable=false}t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark;flow(e)}function maybeReadMore(e,t){if(!t.readingMore){t.readingMore=true;process.nextTick(maybeReadMore_,e,t)}}function maybeReadMore_(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0)){var r=t.length;u("maybeReadMore read 0");e.read(0);if(r===t.length)break}t.readingMore=false}Readable.prototype._read=function(e){C(this,new y("_read()"))};Readable.prototype.pipe=function(e,t){var r=this;var n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e);break}n.pipesCount+=1;u("pipe count=%d opts=%j",n.pipesCount,t);var i=(!t||t.end!==false)&&e!==process.stdout&&e!==process.stderr;var a=i?onend:unpipe;if(n.endEmitted)process.nextTick(a);else r.once("end",a);e.on("unpipe",onunpipe);function onunpipe(e,t){u("onunpipe");if(e===r){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;cleanup()}}}function onend(){u("onend");e.end()}var o=pipeOnDrain(r);e.on("drain",o);var l=false;function cleanup(){u("cleanup");e.removeListener("close",onclose);e.removeListener("finish",onfinish);e.removeListener("drain",o);e.removeListener("error",onerror);e.removeListener("unpipe",onunpipe);r.removeListener("end",onend);r.removeListener("end",unpipe);r.removeListener("data",ondata);l=true;if(n.awaitDrain&&(!e._writableState||e._writableState.needDrain))o()}r.on("data",ondata);function ondata(t){u("ondata");var i=e.write(t);u("dest.write",i);if(i===false){if((n.pipesCount===1&&n.pipes===e||n.pipesCount>1&&indexOf(n.pipes,e)!==-1)&&!l){u("false write response, pause",n.awaitDrain);n.awaitDrain++}r.pause()}}function onerror(t){u("onerror",t);unpipe();e.removeListener("error",onerror);if(s(e,"error")===0)C(e,t)}prependListener(e,"error",onerror);function onclose(){e.removeListener("finish",onfinish);unpipe()}e.once("close",onclose);function onfinish(){u("onfinish");e.removeListener("close",onclose);unpipe()}e.once("finish",onfinish);function unpipe(){u("unpipe");r.unpipe(e)}e.emit("pipe",r);if(!n.flowing){u("pipe resume");r.resume()}return e};function pipeOnDrain(e){return function pipeOnDrainFunctionResult(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain);if(t.awaitDrain)t.awaitDrain--;if(t.awaitDrain===0&&s(e,"data")){t.flowing=true;flow(e)}}}Readable.prototype.unpipe=function(e){var t=this._readableState;var r={hasUnpiped:false};if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this,r);return this}if(!e){var n=t.pipes;var i=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:false});return this}var a=indexOf(t.pipes,e);if(a===-1)return this;t.pipes.splice(a,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this,r);return this};Readable.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);var n=this._readableState;if(e==="data"){n.readableListening=this.listenerCount("readable")>0;if(n.flowing!==false)this.resume()}else if(e==="readable"){if(!n.endEmitted&&!n.readableListening){n.readableListening=n.needReadable=true;n.flowing=false;n.emittedReadable=false;u("on readable",n.length,n.reading);if(n.length){emitReadable(this)}else if(!n.reading){process.nextTick(nReadingNextTick,this)}}}return r};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.removeListener=function(e,t){var r=a.prototype.removeListener.call(this,e,t);if(e==="readable"){process.nextTick(updateReadableListening,this)}return r};Readable.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);if(e==="readable"||e===undefined){process.nextTick(updateReadableListening,this)}return t};function updateReadableListening(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0;if(t.resumeScheduled&&!t.paused){t.flowing=true}else if(e.listenerCount("data")>0){e.resume()}}function nReadingNextTick(e){u("readable nexttick read 0");e.read(0)}Readable.prototype.resume=function(){var e=this._readableState;if(!e.flowing){u("resume");e.flowing=!e.readableListening;resume(this,e)}e.paused=false;return this};function resume(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;process.nextTick(resume_,e,t)}}function resume_(e,t){u("resume",t.reading);if(!t.reading){e.read(0)}t.resumeScheduled=false;e.emit("resume");flow(e);if(t.flowing&&!t.reading)e.read(0)}Readable.prototype.pause=function(){u("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){u("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState.paused=true;return this};function flow(e){var t=e._readableState;u("flow",t.flowing);while(t.flowing&&e.read()!==null);}Readable.prototype.wrap=function(e){var t=this;var r=this._readableState;var n=false;e.on("end",(function(){u("wrapped end");if(r.decoder&&!r.ended){var e=r.decoder.end();if(e&&e.length)t.push(e)}t.push(null)}));e.on("data",(function(i){u("wrapped data");if(r.decoder)i=r.decoder.write(i);if(r.objectMode&&(i===null||i===undefined))return;else if(!r.objectMode&&(!i||!i.length))return;var s=t.push(i);if(!s){n=true;e.pause()}}));for(var i in e){if(this[i]===undefined&&typeof e[i]==="function"){this[i]=function methodWrap(t){return function methodWrapReturnFunction(){return e[t].apply(e,arguments)}}(i)}}for(var s=0;s<E.length;s++){e.on(E[s],this.emit.bind(this,E[s]))}this._read=function(t){u("wrapped _read",t);if(n){n=false;e.resume()}};return this};if(typeof Symbol==="function"){Readable.prototype[Symbol.asyncIterator]=function(){if(_===undefined){_=r(258)}return _(this)}}Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:false,get:function get(){return this._readableState.highWaterMark}});Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:false,get:function get(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:false,get:function get(){return this._readableState.flowing},set:function set(e){if(this._readableState){this._readableState.flowing=e}}});Readable._fromList=fromList;Object.defineProperty(Readable.prototype,"readableLength",{enumerable:false,get:function get(){return this._readableState.length}});function fromList(e,t){if(t.length===0)return null;var r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.first();else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=t.buffer.consume(e,t.decoder)}return r}function endReadable(e){var t=e._readableState;u("endReadable",t.endEmitted);if(!t.endEmitted){t.ended=true;process.nextTick(endReadableNT,t,e)}}function endReadableNT(e,t){u("endReadableNT",e.endEmitted,e.length);if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end");if(e.autoDestroy){var r=t._writableState;if(!r||r.autoDestroy&&r.finished){t.destroy()}}}}if(typeof Symbol==="function"){Readable.from=function(e,t){if(w===undefined){w=r(7217)}return w(Readable,e,t)}}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r]===t)return r}return-1}},6137:(e,t,r)=>{e.exports=Writable;function WriteReq(e,t,r){this.chunk=e;this.encoding=t;this.callback=r;this.next=null}function CorkedRequest(e){var t=this;this.next=null;this.entry=null;this.finish=function(){onCorkedFinish(t,e)}}var n;Writable.WritableState=WritableState;var i={deprecate:r(5278)};var s=r(3917);var a=r(4300).Buffer;var o=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(e){return a.from(e)}function _isUint8Array(e){return a.isBuffer(e)||e instanceof o}var l=r(1061);var c=r(318),u=c.getHighWaterMark;var d=r(5238).q,f=d.ERR_INVALID_ARG_TYPE,h=d.ERR_METHOD_NOT_IMPLEMENTED,p=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,m=d.ERR_STREAM_DESTROYED,v=d.ERR_STREAM_NULL_VALUES,y=d.ERR_STREAM_WRITE_AFTER_END,b=d.ERR_UNKNOWN_ENCODING;var S=l.errorOrDestroy;r(4124)(Writable,s);function nop(){}function WritableState(e,t,i){n=n||r(5135);e=e||{};if(typeof i!=="boolean")i=t instanceof n;this.objectMode=!!e.objectMode;if(i)this.objectMode=this.objectMode||!!e.writableObjectMode;this.highWaterMark=u(this,e,"writableHighWaterMark",i);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var s=e.decodeStrings===false;this.decodeStrings=!s;this.defaultEncoding=e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){onwrite(t,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var e=this.bufferedRequest;var t=[];while(e){t.push(e);e=e.next}return t};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:i.deprecate((function writableStateBufferGetter(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}})();var _;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){_=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function value(e){if(_.call(this,e))return true;if(this!==Writable)return false;return e&&e._writableState instanceof WritableState}})}else{_=function realHasInstance(e){return e instanceof this}}function Writable(e){n=n||r(5135);var t=this instanceof n;if(!t&&!_.call(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t);this.writable=true;if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.final==="function")this._final=e.final}s.call(this)}Writable.prototype.pipe=function(){S(this,new g)};function writeAfterEnd(e,t){var r=new y;S(e,r);process.nextTick(t,r)}function validChunk(e,t,r,n){var i;if(r===null){i=new v}else if(typeof r!=="string"&&!t.objectMode){i=new f("chunk",["string","Buffer"],r)}if(i){S(e,i);process.nextTick(n,i);return false}return true}Writable.prototype.write=function(e,t,r){var n=this._writableState;var i=false;var s=!n.objectMode&&_isUint8Array(e);if(s&&!a.isBuffer(e)){e=_uint8ArrayToBuffer(e)}if(typeof t==="function"){r=t;t=null}if(s)t="buffer";else if(!t)t=n.defaultEncoding;if(typeof r!=="function")r=nop;if(n.ending)writeAfterEnd(this,r);else if(s||validChunk(this,n,e,r)){n.pendingcb++;i=writeOrBuffer(this,n,s,e,t,r)}return i};Writable.prototype.cork=function(){this._writableState.corked++};Writable.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest)clearBuffer(this,e)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(e){if(typeof e==="string")e=e.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new b(e);this._writableState.defaultEncoding=e;return this};Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});function decodeChunk(e,t,r){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=a.from(t,r)}return t}Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});function writeOrBuffer(e,t,r,n,i,s){if(!r){var a=decodeChunk(t,n,i);if(n!==a){r=true;i="buffer";n=a}}var o=t.objectMode?1:n.length;t.length+=o;var l=t.length<t.highWaterMark;if(!l)t.needDrain=true;if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null};if(c){c.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{doWrite(e,t,false,o,n,i,s)}return l}function doWrite(e,t,r,n,i,s,a){t.writelen=n;t.writecb=a;t.writing=true;t.sync=true;if(t.destroyed)t.onwrite(new m("write"));else if(r)e._writev(i,t.onwrite);else e._write(i,s,t.onwrite);t.sync=false}function onwriteError(e,t,r,n,i){--t.pendingcb;if(r){process.nextTick(i,n);process.nextTick(finishMaybe,e,t);e._writableState.errorEmitted=true;S(e,n)}else{i(n);e._writableState.errorEmitted=true;S(e,n);finishMaybe(e,t)}}function onwriteStateUpdate(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function onwrite(e,t){var r=e._writableState;var n=r.sync;var i=r.writecb;if(typeof i!=="function")throw new p;onwriteStateUpdate(r);if(t)onwriteError(e,r,n,t,i);else{var s=needFinish(r)||e.destroyed;if(!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest){clearBuffer(e,r)}if(n){process.nextTick(afterWrite,e,r,s,i)}else{afterWrite(e,r,s,i)}}}function afterWrite(e,t,r,n){if(!r)onwriteDrain(e,t);t.pendingcb--;n();finishMaybe(e,t)}function onwriteDrain(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function clearBuffer(e,t){t.bufferProcessing=true;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount;var i=new Array(n);var s=t.corkedRequestsFree;s.entry=r;var a=0;var o=true;while(r){i[a]=r;if(!r.isBuf)o=false;r=r.next;a+=1}i.allBuffers=o;doWrite(e,t,true,t.length,i,"",s.finish);t.pendingcb++;t.lastBufferedRequest=null;if(s.next){t.corkedRequestsFree=s.next;s.next=null}else{t.corkedRequestsFree=new CorkedRequest(t)}t.bufferedRequestCount=0}else{while(r){var l=r.chunk;var c=r.encoding;var u=r.callback;var d=t.objectMode?1:l.length;doWrite(e,t,false,d,l,c,u);r=r.next;t.bufferedRequestCount--;if(t.writing){break}}if(r===null)t.lastBufferedRequest=null}t.bufferedRequest=r;t.bufferProcessing=false}Writable.prototype._write=function(e,t,r){r(new h("_write()"))};Writable.prototype._writev=null;Writable.prototype.end=function(e,t,r){var n=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(n.corked){n.corked=1;this.uncork()}if(!n.ending)endWritable(this,n,r);return this};Object.defineProperty(Writable.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function needFinish(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function callFinal(e,t){e._final((function(r){t.pendingcb--;if(r){S(e,r)}t.prefinished=true;e.emit("prefinish");finishMaybe(e,t)}))}function prefinish(e,t){if(!t.prefinished&&!t.finalCalled){if(typeof e._final==="function"&&!t.destroyed){t.pendingcb++;t.finalCalled=true;process.nextTick(callFinal,e,t)}else{t.prefinished=true;e.emit("prefinish")}}}function finishMaybe(e,t){var r=needFinish(t);if(r){prefinish(e,t);if(t.pendingcb===0){t.finished=true;e.emit("finish");if(t.autoDestroy){var n=e._readableState;if(!n||n.autoDestroy&&n.endEmitted){e.destroy()}}}}return r}function endWritable(e,t,r){t.ending=true;finishMaybe(e,t);if(r){if(t.finished)process.nextTick(r);else e.once("finish",r)}t.ended=true;e.writable=false}function onCorkedFinish(e,t,r){var n=e.entry;e.entry=null;while(n){var i=n.callback;t.pendingcb--;i(r);n=n.next}t.corkedRequestsFree.next=e}Object.defineProperty(Writable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function set(e){if(!this._writableState){return}this._writableState.destroyed=e}});Writable.prototype.destroy=l.destroy;Writable.prototype._undestroy=l.undestroy;Writable.prototype._destroy=function(e,t){t(e)}},258:(e,t,r)=>{var n;function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i=r(8242);var s=Symbol("lastResolve");var a=Symbol("lastReject");var o=Symbol("error");var l=Symbol("ended");var c=Symbol("lastPromise");var u=Symbol("handlePromise");var d=Symbol("stream");function createIterResult(e,t){return{value:e,done:t}}function readAndResolve(e){var t=e[s];if(t!==null){var r=e[d].read();if(r!==null){e[c]=null;e[s]=null;e[a]=null;t(createIterResult(r,false))}}}function onReadable(e){process.nextTick(readAndResolve,e)}function wrapForNext(e,t){return function(r,n){e.then((function(){if(t[l]){r(createIterResult(undefined,true));return}t[u](r,n)}),n)}}var f=Object.getPrototypeOf((function(){}));var h=Object.setPrototypeOf((n={get stream(){return this[d]},next:function next(){var e=this;var t=this[o];if(t!==null){return Promise.reject(t)}if(this[l]){return Promise.resolve(createIterResult(undefined,true))}if(this[d].destroyed){return new Promise((function(t,r){process.nextTick((function(){if(e[o]){r(e[o])}else{t(createIterResult(undefined,true))}}))}))}var r=this[c];var n;if(r){n=new Promise(wrapForNext(r,this))}else{var i=this[d].read();if(i!==null){return Promise.resolve(createIterResult(i,false))}n=new Promise(this[u])}this[c]=n;return n}},_defineProperty(n,Symbol.asyncIterator,(function(){return this})),_defineProperty(n,"return",(function _return(){var e=this;return new Promise((function(t,r){e[d].destroy(null,(function(e){if(e){r(e);return}t(createIterResult(undefined,true))}))}))})),n),f);var p=function createReadableStreamAsyncIterator(e){var t;var r=Object.create(h,(t={},_defineProperty(t,d,{value:e,writable:true}),_defineProperty(t,s,{value:null,writable:true}),_defineProperty(t,a,{value:null,writable:true}),_defineProperty(t,o,{value:null,writable:true}),_defineProperty(t,l,{value:e._readableState.endEmitted,writable:true}),_defineProperty(t,u,{value:function value(e,t){var n=r[d].read();if(n){r[c]=null;r[s]=null;r[a]=null;e(createIterResult(n,false))}else{r[s]=e;r[a]=t}},writable:true}),t));r[c]=null;i(e,(function(e){if(e&&e.code!=="ERR_STREAM_PREMATURE_CLOSE"){var t=r[a];if(t!==null){r[c]=null;r[s]=null;r[a]=null;t(e)}r[o]=e;return}var n=r[s];if(n!==null){r[c]=null;r[s]=null;r[a]=null;n(createIterResult(undefined,true))}r[l]=true}));e.on("readable",onReadable.bind(null,r));return r};e.exports=p},8233:(e,t,r)=>{function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){if(t)_defineProperties(e.prototype,t);if(r)_defineProperties(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n=r(4300),i=n.Buffer;var s=r(3837),a=s.inspect;var o=a&&a.custom||"inspect";function copyBuffer(e,t,r){i.prototype.copy.call(e,t,r)}e.exports=function(){function BufferList(){_classCallCheck(this,BufferList);this.head=null;this.tail=null;this.length=0}_createClass(BufferList,[{key:"push",value:function push(e){var t={data:e,next:null};if(this.length>0)this.tail.next=t;else this.head=t;this.tail=t;++this.length}},{key:"unshift",value:function unshift(e){var t={data:e,next:this.head};if(this.length===0)this.tail=t;this.head=t;++this.length}},{key:"shift",value:function shift(){if(this.length===0)return;var e=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return e}},{key:"clear",value:function clear(){this.head=this.tail=null;this.length=0}},{key:"join",value:function join(e){if(this.length===0)return"";var t=this.head;var r=""+t.data;while(t=t.next)r+=e+t.data;return r}},{key:"concat",value:function concat(e){if(this.length===0)return i.alloc(0);var t=i.allocUnsafe(e>>>0);var r=this.head;var n=0;while(r){copyBuffer(r.data,t,n);n+=r.data.length;r=r.next}return t}},{key:"consume",value:function consume(e,t){var r;if(e<this.head.data.length){r=this.head.data.slice(0,e);this.head.data=this.head.data.slice(e)}else if(e===this.head.data.length){r=this.shift()}else{r=t?this._getString(e):this._getBuffer(e)}return r}},{key:"first",value:function first(){return this.head.data}},{key:"_getString",value:function _getString(e){var t=this.head;var r=1;var n=t.data;e-=n.length;while(t=t.next){var i=t.data;var s=e>i.length?i.length:e;if(s===i.length)n+=i;else n+=i.slice(0,e);e-=s;if(e===0){if(s===i.length){++r;if(t.next)this.head=t.next;else this.head=this.tail=null}else{this.head=t;t.data=i.slice(s)}break}++r}this.length-=r;return n}},{key:"_getBuffer",value:function _getBuffer(e){var t=i.allocUnsafe(e);var r=this.head;var n=1;r.data.copy(t);e-=r.data.length;while(r=r.next){var s=r.data;var a=e>s.length?s.length:e;s.copy(t,t.length-e,0,a);e-=a;if(e===0){if(a===s.length){++n;if(r.next)this.head=r.next;else this.head=this.tail=null}else{this.head=r;r.data=s.slice(a)}break}++n}this.length-=n;return t}},{key:o,value:function value(e,t){return a(this,_objectSpread(_objectSpread({},t),{},{depth:0,customInspect:false}))}}]);return BufferList}()},1061:e=>{function destroy(e,t){var r=this;var n=this._readableState&&this._readableState.destroyed;var i=this._writableState&&this._writableState.destroyed;if(n||i){if(t){t(e)}else if(e){if(!this._writableState){process.nextTick(emitErrorNT,this,e)}else if(!this._writableState.errorEmitted){this._writableState.errorEmitted=true;process.nextTick(emitErrorNT,this,e)}}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(e||null,(function(e){if(!t&&e){if(!r._writableState){process.nextTick(emitErrorAndCloseNT,r,e)}else if(!r._writableState.errorEmitted){r._writableState.errorEmitted=true;process.nextTick(emitErrorAndCloseNT,r,e)}else{process.nextTick(emitCloseNT,r)}}else if(t){process.nextTick(emitCloseNT,r);t(e)}else{process.nextTick(emitCloseNT,r)}}));return this}function emitErrorAndCloseNT(e,t){emitErrorNT(e,t);emitCloseNT(e)}function emitCloseNT(e){if(e._writableState&&!e._writableState.emitClose)return;if(e._readableState&&!e._readableState.emitClose)return;e.emit("close")}function undestroy(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finalCalled=false;this._writableState.prefinished=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function emitErrorNT(e,t){e.emit("error",t)}function errorOrDestroy(e,t){var r=e._readableState;var n=e._writableState;if(r&&r.autoDestroy||n&&n.autoDestroy)e.destroy(t);else e.emit("error",t)}e.exports={destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy}},8242:(e,t,r)=>{var n=r(5238).q.ERR_STREAM_PREMATURE_CLOSE;function once(e){var t=false;return function(){if(t)return;t=true;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++){n[i]=arguments[i]}e.apply(this,n)}}function noop(){}function isRequest(e){return e.setHeader&&typeof e.abort==="function"}function eos(e,t,r){if(typeof t==="function")return eos(e,null,t);if(!t)t={};r=once(r||noop);var i=t.readable||t.readable!==false&&e.readable;var s=t.writable||t.writable!==false&&e.writable;var a=function onlegacyfinish(){if(!e.writable)l()};var o=e._writableState&&e._writableState.finished;var l=function onfinish(){s=false;o=true;if(!i)r.call(e)};var c=e._readableState&&e._readableState.endEmitted;var u=function onend(){i=false;c=true;if(!s)r.call(e)};var d=function onerror(t){r.call(e,t)};var f=function onclose(){var t;if(i&&!c){if(!e._readableState||!e._readableState.ended)t=new n;return r.call(e,t)}if(s&&!o){if(!e._writableState||!e._writableState.ended)t=new n;return r.call(e,t)}};var h=function onrequest(){e.req.on("finish",l)};if(isRequest(e)){e.on("complete",l);e.on("abort",f);if(e.req)h();else e.on("request",h)}else if(s&&!e._writableState){e.on("end",a);e.on("close",a)}e.on("end",u);e.on("finish",l);if(t.error!==false)e.on("error",d);e.on("close",f);return function(){e.removeListener("complete",l);e.removeListener("abort",f);e.removeListener("request",h);if(e.req)e.req.removeListener("finish",l);e.removeListener("end",a);e.removeListener("close",a);e.removeListener("finish",l);e.removeListener("end",u);e.removeListener("error",d);e.removeListener("close",f)}}e.exports=eos},7217:(e,t,r)=>{function asyncGeneratorStep(e,t,r,n,i,s,a){try{var o=e[s](a);var l=o.value}catch(e){r(e);return}if(o.done){t(l)}else{Promise.resolve(l).then(n,i)}}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function _next(e){asyncGeneratorStep(s,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(s,n,i,_next,_throw,"throw",e)}_next(undefined)}))}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n=r(5238).q.ERR_INVALID_ARG_TYPE;function from(e,t,r){var i;if(t&&typeof t.next==="function"){i=t}else if(t&&t[Symbol.asyncIterator])i=t[Symbol.asyncIterator]();else if(t&&t[Symbol.iterator])i=t[Symbol.iterator]();else throw new n("iterable",["Iterable"],t);var s=new e(_objectSpread({objectMode:true},r));var a=false;s._read=function(){if(!a){a=true;next()}};function next(){return _next2.apply(this,arguments)}function _next2(){_next2=_asyncToGenerator((function*(){try{var e=yield i.next(),t=e.value,r=e.done;if(r){s.push(null)}else if(s.push(yield t)){next()}else{a=false}}catch(e){s.destroy(e)}}));return _next2.apply(this,arguments)}return s}e.exports=from},318:(e,t,r)=>{var n=r(5238).q.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function getHighWaterMark(e,t,r,i){var s=highWaterMarkFrom(t,i,r);if(s!=null){if(!(isFinite(s)&&Math.floor(s)===s)||s<0){var a=i?r:"highWaterMark";throw new n(a,s)}return Math.floor(s)}return e.objectMode?16:16*1024}e.exports={getHighWaterMark:getHighWaterMark}},3917:(e,t,r)=>{e.exports=r(2781)},4158:(e,t,r)=>{const n=r(2955);const{warn:i}=r(8043);t.version=r(2561).version;t.transports=r(7804);t.config=r(4325);t.addColors=n.levels;t.format=n.format;t.createLogger=r(2878);t.Logger=r(5153);t.ExceptionHandler=r(7891);t.RejectionHandler=r(1080);t.Container=r(7184);t.Transport=r(7281);t.loggers=new t.Container;const s=t.createLogger();Object.keys(t.config.npm.levels).concat(["log","query","stream","add","remove","clear","profile","startTimer","handleExceptions","unhandleExceptions","handleRejections","unhandleRejections","configure","child"]).forEach((e=>t[e]=(...t)=>s[e](...t)));Object.defineProperty(t,"level",{get(){return s.level},set(e){s.level=e}});Object.defineProperty(t,"exceptions",{get(){return s.exceptions}});Object.defineProperty(t,"rejections",{get(){return s.rejections}});["exitOnError"].forEach((e=>{Object.defineProperty(t,e,{get(){return s[e]},set(t){s[e]=t}})}));Object.defineProperty(t,"default",{get(){return{exceptionHandlers:s.exceptionHandlers,rejectionHandlers:s.rejectionHandlers,transports:s.transports}}});i.deprecated(t,"setLevels");i.forFunctions(t,"useFormat",["cli"]);i.forProperties(t,"useFormat",["padLevels","stripColors"]);i.forFunctions(t,"deprecated",["addRewriter","addFilter","clone","extend"]);i.forProperties(t,"deprecated",["emitErrs","levelLength"])},8043:(e,t,r)=>{const{format:n}=r(3837);t.warn={deprecated(e){return()=>{throw new Error(n("{ %s } was removed in winston@3.0.0.",e))}},useFormat(e){return()=>{throw new Error([n("{ %s } was removed in winston@3.0.0.",e),"Use a custom winston.format = winston.format(function) instead."].join("\n"))}},forFunctions(e,r,n){n.forEach((n=>{e[n]=t.warn[r](n)}))},forProperties(e,r,n){n.forEach((n=>{const i=t.warn[r](n);Object.defineProperty(e,n,{get:i,set:i})}))}}},4325:(e,t,r)=>{const n=r(2955);const{configs:i}=r(3937);t.cli=n.levels(i.cli);t.npm=n.levels(i.npm);t.syslog=n.levels(i.syslog);t.addColors=n.levels},7184:(e,t,r)=>{const n=r(2878);e.exports=class Container{constructor(e={}){this.loggers=new Map;this.options=e}add(e,t){if(!this.loggers.has(e)){t=Object.assign({},t||this.options);const r=t.transports||this.options.transports;if(r){t.transports=Array.isArray(r)?r.slice():[r]}else{t.transports=[]}const i=n(t);i.on("close",(()=>this._delete(e)));this.loggers.set(e,i)}return this.loggers.get(e)}get(e,t){return this.add(e,t)}has(e){return!!this.loggers.has(e)}close(e){if(e){return this._removeLogger(e)}this.loggers.forEach(((e,t)=>this._removeLogger(t)))}_removeLogger(e){if(!this.loggers.has(e)){return}const t=this.loggers.get(e);t.close();this._delete(e)}_delete(e){this.loggers.delete(e)}}},2878:(e,t,r)=>{const{LEVEL:n}=r(3937);const i=r(4325);const s=r(5153);const a=r(3170)("winston:create-logger");function isLevelEnabledFunctionName(e){return"is"+e.charAt(0).toUpperCase()+e.slice(1)+"Enabled"}e.exports=function(e={}){e.levels=e.levels||i.npm.levels;class DerivedLogger extends s{constructor(e){super(e)}}const t=new DerivedLogger(e);Object.keys(e.levels).forEach((function(e){a('Define prototype method for "%s"',e);if(e==="log"){console.warn('Level "log" not defined: conflicts with the method "log". Use a different level name.');return}DerivedLogger.prototype[e]=function(...r){const i=this||t;if(r.length===1){const[s]=r;const a=s&&s.message&&s||{message:s};a.level=a[n]=e;i._addDefaultMeta(a);i.write(a);return this||t}if(r.length===0){i.log(e,"");return i}return i.log(e,...r)};DerivedLogger.prototype[isLevelEnabledFunctionName(e)]=function(){return(this||t).isLevelEnabled(e)}}));return t}},7891:(e,t,r)=>{const n=r(2037);const i=r(1216);const s=r(3170)("winston:exception");const a=r(4118);const o=r(5315);const l=r(6268);e.exports=class ExceptionHandler{constructor(e){if(!e){throw new Error("Logger is required to handle exceptions")}this.logger=e;this.handlers=new Map}handle(...e){e.forEach((e=>{if(Array.isArray(e)){return e.forEach((e=>this._addHandler(e)))}this._addHandler(e)}));if(!this.catcher){this.catcher=this._uncaughtException.bind(this);process.on("uncaughtException",this.catcher)}}unhandle(){if(this.catcher){process.removeListener("uncaughtException",this.catcher);this.catcher=false;Array.from(this.handlers.values()).forEach((e=>this.logger.unpipe(e)))}}getAllInfo(e){let t=null;if(e){t=typeof e==="string"?e:e.message}return{error:e,level:"error",message:[`uncaughtException: ${t||"(no error message)"}`,e&&e.stack||"  No stack trace"].join("\n"),stack:e&&e.stack,exception:true,date:(new Date).toString(),process:this.getProcessInfo(),os:this.getOsInfo(),trace:this.getTrace(e)}}getProcessInfo(){return{pid:process.pid,uid:process.getuid?process.getuid():null,gid:process.getgid?process.getgid():null,cwd:process.cwd(),execPath:process.execPath,version:process.version,argv:process.argv,memoryUsage:process.memoryUsage()}}getOsInfo(){return{loadavg:n.loadavg(),uptime:n.uptime()}}getTrace(e){const t=e?o.parse(e):o.get();return t.map((e=>({column:e.getColumnNumber(),file:e.getFileName(),function:e.getFunctionName(),line:e.getLineNumber(),method:e.getMethodName(),native:e.isNative()})))}_addHandler(e){if(!this.handlers.has(e)){e.handleExceptions=true;const t=new l(e);this.handlers.set(e,t);this.logger.pipe(t)}}_uncaughtException(e){const t=this.getAllInfo(e);const r=this._getExceptionHandlers();let n=typeof this.logger.exitOnError==="function"?this.logger.exitOnError(e):this.logger.exitOnError;let o;if(!r.length&&n){console.warn("winston: exitOnError cannot be true with no exception handlers.");console.warn("winston: not exiting process.");n=false}function gracefulExit(){s("doExit",n);s("process._exiting",process._exiting);if(n&&!process._exiting){if(o){clearTimeout(o)}process.exit(1)}}if(!r||r.length===0){return process.nextTick(gracefulExit)}i(r,((e,t)=>{const r=a(t);const n=e.transport||e;function onDone(e){return()=>{s(e);r()}}n._ending=true;n.once("finish",onDone("finished"));n.once("error",onDone("error"))}),(()=>n&&gracefulExit()));this.logger.log(t);if(n){o=setTimeout(gracefulExit,3e3)}}_getExceptionHandlers(){return this.logger.transports.filter((e=>{const t=e.transport||e;return t.handleExceptions}))}}},6268:(e,t,r)=>{const{Writable:n}=r(7201);e.exports=class ExceptionStream extends n{constructor(e){super({objectMode:true});if(!e){throw new Error("ExceptionStream requires a TransportStream instance.")}this.handleExceptions=true;this.transport=e}_write(e,t,r){if(e.exception){return this.transport.log(e,r)}r();return true}}},5153:(e,t,r)=>{const{Stream:n,Transform:i}=r(7201);const s=r(1216);const{LEVEL:a,SPLAT:o}=r(3937);const l=r(1554);const c=r(7891);const u=r(1080);const d=r(6201);const f=r(6959);const{warn:h}=r(8043);const p=r(4325);const g=/%[scdjifoO%]/g;class Logger extends i{constructor(e){super({objectMode:true});this.configure(e)}child(e){const t=this;return Object.create(t,{write:{value:function(r){const n=Object.assign({},e,r);if(r instanceof Error){n.stack=r.stack;n.message=r.message}t.write(n)}}})}configure({silent:e,format:t,defaultMeta:n,levels:i,level:s="info",exitOnError:a=true,transports:o,colors:l,emitErrs:d,formatters:f,padLevels:h,rewriters:g,stripColors:m,exceptionHandlers:v,rejectionHandlers:y}={}){if(this.transports.length){this.clear()}this.silent=e;this.format=t||this.format||r(5669)();this.defaultMeta=n||null;this.levels=i||this.levels||p.npm.levels;this.level=s;if(this.exceptions){this.exceptions.unhandle()}if(this.rejections){this.rejections.unhandle()}this.exceptions=new c(this);this.rejections=new u(this);this.profilers={};this.exitOnError=a;if(o){o=Array.isArray(o)?o:[o];o.forEach((e=>this.add(e)))}if(l||d||f||h||g||m){throw new Error(["{ colors, emitErrs, formatters, padLevels, rewriters, stripColors } were removed in winston@3.0.0.","Use a custom winston.format(function) instead.","See: https://github.com/winstonjs/winston/tree/master/UPGRADE-3.0.md"].join("\n"))}if(v){this.exceptions.handle(v)}if(y){this.rejections.handle(y)}}isLevelEnabled(e){const t=getLevelValue(this.levels,e);if(t===null){return false}const r=getLevelValue(this.levels,this.level);if(r===null){return false}if(!this.transports||this.transports.length===0){return r>=t}const n=this.transports.findIndex((e=>{let n=getLevelValue(this.levels,e.level);if(n===null){n=r}return n>=t}));return n!==-1}log(e,t,...r){if(arguments.length===1){e[a]=e.level;this._addDefaultMeta(e);this.write(e);return this}if(arguments.length===2){if(t&&typeof t==="object"){t[a]=t.level=e;this._addDefaultMeta(t);this.write(t);return this}t={[a]:e,level:e,message:t};this._addDefaultMeta(t);this.write(t);return this}const[n]=r;if(typeof n==="object"&&n!==null){const i=t&&t.match&&t.match(g);if(!i){const i=Object.assign({},this.defaultMeta,n,{[a]:e,[o]:r,level:e,message:t});if(n.message)i.message=`${i.message} ${n.message}`;if(n.stack)i.stack=n.stack;this.write(i);return this}}this.write(Object.assign({},this.defaultMeta,{[a]:e,[o]:r,level:e,message:t}));return this}_transform(e,t,r){if(this.silent){return r()}if(!e[a]){e[a]=e.level}if(!this.levels[e[a]]&&this.levels[e[a]]!==0){console.error("[winston] Unknown logger level: %s",e[a])}if(!this._readableState.pipes){console.error("[winston] Attempt to write logs with no transports, which can increase memory usage: %j",e)}try{this.push(this.format.transform(e,this.format.options))}finally{this._writableState.sync=false;r()}}_final(e){const t=this.transports.slice();s(t,((e,t)=>{if(!e||e.finished)return setImmediate(t);e.once("finish",t);e.end()}),e)}add(e){const t=!l(e)||e.log.length>2?new d({transport:e}):e;if(!t._writableState||!t._writableState.objectMode){throw new Error("Transports must WritableStreams in objectMode. Set { objectMode: true }.")}this._onEvent("error",t);this._onEvent("warn",t);this.pipe(t);if(e.handleExceptions){this.exceptions.handle()}if(e.handleRejections){this.rejections.handle()}return this}remove(e){if(!e)return this;let t=e;if(!l(e)||e.log.length>2){t=this.transports.filter((t=>t.transport===e))[0]}if(t){this.unpipe(t)}return this}clear(){this.unpipe();return this}close(){this.exceptions.unhandle();this.rejections.unhandle();this.clear();this.emit("close");return this}setLevels(){h.deprecated("setLevels")}query(e,t){if(typeof e==="function"){t=e;e={}}e=e||{};const r={};const n=Object.assign({},e.query||{});function queryTransport(t,r){if(e.query&&typeof t.formatQuery==="function"){e.query=t.formatQuery(n)}t.query(e,((n,i)=>{if(n){return r(n)}if(typeof t.formatResults==="function"){i=t.formatResults(i,e.format)}r(null,i)}))}function addResults(e,t){queryTransport(e,((n,i)=>{if(t){i=n||i;if(i){r[e.name]=i}t()}t=null}))}s(this.transports.filter((e=>!!e.query)),addResults,(()=>t(null,r)))}stream(e={}){const t=new n;const r=[];t._streams=r;t.destroy=()=>{let e=r.length;while(e--){r[e].destroy()}};this.transports.filter((e=>!!e.stream)).forEach((n=>{const i=n.stream(e);if(!i){return}r.push(i);i.on("log",(e=>{e.transport=e.transport||[];e.transport.push(n.name);t.emit("log",e)}));i.on("error",(e=>{e.transport=e.transport||[];e.transport.push(n.name);t.emit("error",e)}))}));return t}startTimer(){return new f(this)}profile(e,...t){const r=Date.now();if(this.profilers[e]){const n=this.profilers[e];delete this.profilers[e];if(typeof t[t.length-2]==="function"){console.warn("Callback function no longer supported as of winston@3.0.0");t.pop()}const i=typeof t[t.length-1]==="object"?t.pop():{};i.level=i.level||"info";i.durationMs=r-n;i.message=i.message||e;return this.write(i)}this.profilers[e]=r;return this}handleExceptions(...e){console.warn("Deprecated: .handleExceptions() will be removed in winston@4. Use .exceptions.handle()");this.exceptions.handle(...e)}unhandleExceptions(...e){console.warn("Deprecated: .unhandleExceptions() will be removed in winston@4. Use .exceptions.unhandle()");this.exceptions.unhandle(...e)}cli(){throw new Error(["Logger.cli() was removed in winston@3.0.0","Use a custom winston.formats.cli() instead.","See: https://github.com/winstonjs/winston/tree/master/UPGRADE-3.0.md"].join("\n"))}_onEvent(e,t){function transportEvent(r){if(e==="error"&&!this.transports.includes(t)){this.add(t)}this.emit(e,r,t)}if(!t["__winston"+e]){t["__winston"+e]=transportEvent.bind(this);t.on(e,t["__winston"+e])}}_addDefaultMeta(e){if(this.defaultMeta){Object.assign(e,this.defaultMeta)}}}function getLevelValue(e,t){const r=e[t];if(!r&&r!==0){return null}return r}Object.defineProperty(Logger.prototype,"transports",{configurable:false,enumerable:true,get(){const{pipes:e}=this._readableState;return!Array.isArray(e)?[e].filter(Boolean):e}});e.exports=Logger},6959:(e,t,r)=>{class Profiler{constructor(e){const t=r(5153);if(typeof e!=="object"||Array.isArray(e)||!(e instanceof t)){throw new Error("Logger is required for profiling")}else{this.logger=e;this.start=Date.now()}}done(...e){if(typeof e[e.length-1]==="function"){console.warn("Callback function no longer supported as of winston@3.0.0");e.pop()}const t=typeof e[e.length-1]==="object"?e.pop():{};t.level=t.level||"info";t.durationMs=Date.now()-this.start;return this.logger.write(t)}}e.exports=Profiler},1080:(e,t,r)=>{const n=r(2037);const i=r(1216);const s=r(3170)("winston:rejection");const a=r(4118);const o=r(5315);const l=r(8185);e.exports=class RejectionHandler{constructor(e){if(!e){throw new Error("Logger is required to handle rejections")}this.logger=e;this.handlers=new Map}handle(...e){e.forEach((e=>{if(Array.isArray(e)){return e.forEach((e=>this._addHandler(e)))}this._addHandler(e)}));if(!this.catcher){this.catcher=this._unhandledRejection.bind(this);process.on("unhandledRejection",this.catcher)}}unhandle(){if(this.catcher){process.removeListener("unhandledRejection",this.catcher);this.catcher=false;Array.from(this.handlers.values()).forEach((e=>this.logger.unpipe(e)))}}getAllInfo(e){let t=null;if(e){t=typeof e==="string"?e:e.message}return{error:e,level:"error",message:[`unhandledRejection: ${t||"(no error message)"}`,e&&e.stack||"  No stack trace"].join("\n"),stack:e&&e.stack,rejection:true,date:(new Date).toString(),process:this.getProcessInfo(),os:this.getOsInfo(),trace:this.getTrace(e)}}getProcessInfo(){return{pid:process.pid,uid:process.getuid?process.getuid():null,gid:process.getgid?process.getgid():null,cwd:process.cwd(),execPath:process.execPath,version:process.version,argv:process.argv,memoryUsage:process.memoryUsage()}}getOsInfo(){return{loadavg:n.loadavg(),uptime:n.uptime()}}getTrace(e){const t=e?o.parse(e):o.get();return t.map((e=>({column:e.getColumnNumber(),file:e.getFileName(),function:e.getFunctionName(),line:e.getLineNumber(),method:e.getMethodName(),native:e.isNative()})))}_addHandler(e){if(!this.handlers.has(e)){e.handleRejections=true;const t=new l(e);this.handlers.set(e,t);this.logger.pipe(t)}}_unhandledRejection(e){const t=this.getAllInfo(e);const r=this._getRejectionHandlers();let n=typeof this.logger.exitOnError==="function"?this.logger.exitOnError(e):this.logger.exitOnError;let o;if(!r.length&&n){console.warn("winston: exitOnError cannot be true with no rejection handlers.");console.warn("winston: not exiting process.");n=false}function gracefulExit(){s("doExit",n);s("process._exiting",process._exiting);if(n&&!process._exiting){if(o){clearTimeout(o)}process.exit(1)}}if(!r||r.length===0){return process.nextTick(gracefulExit)}i(r,((e,t)=>{const r=a(t);const n=e.transport||e;function onDone(e){return()=>{s(e);r()}}n._ending=true;n.once("finish",onDone("finished"));n.once("error",onDone("error"))}),(()=>n&&gracefulExit()));this.logger.log(t);if(n){o=setTimeout(gracefulExit,3e3)}}_getRejectionHandlers(){return this.logger.transports.filter((e=>{const t=e.transport||e;return t.handleRejections}))}}},8185:(e,t,r)=>{const{Writable:n}=r(7201);e.exports=class RejectionStream extends n{constructor(e){super({objectMode:true});if(!e){throw new Error("RejectionStream requires a TransportStream instance.")}this.handleRejections=true;this.transport=e}_write(e,t,r){if(e.rejection){return this.transport.log(e,r)}r();return true}}},1965:(e,t,r)=>{const n=r(7147);const{StringDecoder:i}=r(1576);const{Stream:s}=r(7201);function noop(){}e.exports=(e,t)=>{const r=Buffer.alloc(64*1024);const a=new i("utf8");const o=new s;let l="";let c=0;let u=0;if(e.start===-1){delete e.start}o.readable=true;o.destroy=()=>{o.destroyed=true;o.emit("end");o.emit("close")};n.open(e.file,"a+","0644",((i,s)=>{if(i){if(!t){o.emit("error",i)}else{t(i)}o.destroy();return}(function read(){if(o.destroyed){n.close(s,noop);return}return n.read(s,r,0,r.length,c,((n,i)=>{if(n){if(!t){o.emit("error",n)}else{t(n)}o.destroy();return}if(!i){if(l){if(e.start==null||u>e.start){if(!t){o.emit("line",l)}else{t(null,l)}}u++;l=""}return setTimeout(read,1e3)}let s=a.write(r.slice(0,i));if(!t){o.emit("data",s)}s=(l+s).split(/\n+/);const d=s.length-1;let f=0;for(;f<d;f++){if(e.start==null||u>e.start){if(!t){o.emit("line",s[f])}else{t(null,s[f])}}u++}l=s[d];c+=i;return read()}))})()}));if(!t){return o}return o.destroy}},7501:(e,t,r)=>{const n=r(2037);const{LEVEL:i,MESSAGE:s}=r(3937);const a=r(7281);e.exports=class Console extends a{constructor(e={}){super(e);this.name=e.name||"console";this.stderrLevels=this._stringArrayToSet(e.stderrLevels);this.consoleWarnLevels=this._stringArrayToSet(e.consoleWarnLevels);this.eol=typeof e.eol==="string"?e.eol:n.EOL;this.setMaxListeners(30)}log(e,t){setImmediate((()=>this.emit("logged",e)));if(this.stderrLevels[e[i]]){if(console._stderr){console._stderr.write(`${e[s]}${this.eol}`)}else{console.error(e[s])}if(t){t()}return}else if(this.consoleWarnLevels[e[i]]){if(console._stderr){console._stderr.write(`${e[s]}${this.eol}`)}else{console.warn(e[s])}if(t){t()}return}if(console._stdout){console._stdout.write(`${e[s]}${this.eol}`)}else{console.log(e[s])}if(t){t()}}_stringArrayToSet(e,t){if(!e)return{};t=t||"Cannot make set from type other than Array of string elements";if(!Array.isArray(e)){throw new Error(t)}return e.reduce(((e,r)=>{if(typeof r!=="string"){throw new Error(t)}e[r]=true;return e}),{})}}},2478:(e,t,r)=>{const n=r(7147);const i=r(1017);const s=r(9619);const a=r(9796);const{MESSAGE:o}=r(3937);const{Stream:l,PassThrough:c}=r(7201);const u=r(7281);const d=r(3170)("winston:file");const f=r(2037);const h=r(1965);e.exports=class File extends u{constructor(e={}){super(e);this.name=e.name||"file";function throwIf(t,...r){r.slice(1).forEach((r=>{if(e[r]){throw new Error(`Cannot set ${r} and ${t} together`)}}))}this._stream=new c;this._stream.setMaxListeners(30);this._onError=this._onError.bind(this);if(e.filename||e.dirname){throwIf("filename or dirname","stream");this._basename=this.filename=e.filename?i.basename(e.filename):"winston.log";this.dirname=e.dirname||i.dirname(e.filename);this.options=e.options||{flags:"a"}}else if(e.stream){console.warn("options.stream will be removed in winston@4. Use winston.transports.Stream");throwIf("stream","filename","maxsize");this._dest=this._stream.pipe(this._setupStream(e.stream));this.dirname=i.dirname(this._dest.path)}else{throw new Error("Cannot log to file without filename or stream.")}this.maxsize=e.maxsize||null;this.rotationFormat=e.rotationFormat||false;this.zippedArchive=e.zippedArchive||false;this.maxFiles=e.maxFiles||null;this.eol=typeof e.eol==="string"?e.eol:f.EOL;this.tailable=e.tailable||false;this.lazy=e.lazy||false;this._size=0;this._pendingSize=0;this._created=0;this._drain=false;this._opening=false;this._ending=false;this._fileExist=false;if(this.dirname)this._createLogDirIfNotExist(this.dirname);if(!this.lazy)this.open()}finishIfEnding(){if(this._ending){if(this._opening){this.once("open",(()=>{this._stream.once("finish",(()=>this.emit("finish")));setImmediate((()=>this._stream.end()))}))}else{this._stream.once("finish",(()=>this.emit("finish")));setImmediate((()=>this._stream.end()))}}}log(e,t=(()=>{})){if(this.silent){t();return true}if(this._drain){this._stream.once("drain",(()=>{this._drain=false;this.log(e,t)}));return}if(this._rotate){this._stream.once("rotate",(()=>{this._rotate=false;this.log(e,t)}));return}if(this.lazy){if(!this._fileExist){if(!this._opening){this.open()}this.once("open",(()=>{this._fileExist=true;this.log(e,t);return}));return}if(this._needsNewFile(this._pendingSize)){this._dest.once("close",(()=>{if(!this._opening){this.open()}this.once("open",(()=>{this.log(e,t);return}));return}));return}}const r=`${e[o]}${this.eol}`;const n=Buffer.byteLength(r);function logged(){this._size+=n;this._pendingSize-=n;d("logged %s %s",this._size,r);this.emit("logged",e);if(this._rotate){return}if(this._opening){return}if(!this._needsNewFile()){return}if(this.lazy){this._endStream((()=>{this.emit("fileclosed")}));return}this._rotate=true;this._endStream((()=>this._rotateFile()))}this._pendingSize+=n;if(this._opening&&!this.rotatedWhileOpening&&this._needsNewFile(this._size+this._pendingSize)){this.rotatedWhileOpening=true}const i=this._stream.write(r,logged.bind(this));if(!i){this._drain=true;this._stream.once("drain",(()=>{this._drain=false;t()}))}else{t()}d("written",i,this._drain);this.finishIfEnding();return i}query(e,t){if(typeof e==="function"){t=e;e={}}e=normalizeQuery(e);const r=i.join(this.dirname,this.filename);let s="";let a=[];let o=0;const l=n.createReadStream(r,{encoding:"utf8"});l.on("error",(e=>{if(l.readable){l.destroy()}if(!t){return}return e.code!=="ENOENT"?t(e):t(null,a)}));l.on("data",(t=>{t=(s+t).split(/\n+/);const r=t.length-1;let n=0;for(;n<r;n++){if(!e.start||o>=e.start){add(t[n])}o++}s=t[r]}));l.on("close",(()=>{if(s){add(s,true)}if(e.order==="desc"){a=a.reverse()}if(t)t(null,a)}));function add(e,t){try{const t=JSON.parse(e);if(check(t)){push(t)}}catch(e){if(!t){l.emit("error",e)}}}function push(t){if(e.rows&&a.length>=e.rows&&e.order!=="desc"){if(l.readable){l.destroy()}return}if(e.fields){t=e.fields.reduce(((e,r)=>{e[r]=t[r];return e}),{})}if(e.order==="desc"){if(a.length>=e.rows){a.shift()}}a.push(t)}function check(t){if(!t){return}if(typeof t!=="object"){return}const r=new Date(t.timestamp);if(e.from&&r<e.from||e.until&&r>e.until||e.level&&e.level!==t.level){return}return true}function normalizeQuery(e){e=e||{};e.rows=e.rows||e.limit||10;e.start=e.start||0;e.until=e.until||new Date;if(typeof e.until!=="object"){e.until=new Date(e.until)}e.from=e.from||e.until-24*60*60*1e3;if(typeof e.from!=="object"){e.from=new Date(e.from)}e.order=e.order||"desc";return e}}stream(e={}){const t=i.join(this.dirname,this.filename);const r=new l;const n={file:t,start:e.start};r.destroy=h(n,((e,t)=>{if(e){return r.emit("error",e)}try{r.emit("data",t);t=JSON.parse(t);r.emit("log",t)}catch(e){r.emit("error",e)}}));return r}open(){if(!this.filename)return;if(this._opening)return;this._opening=true;this.stat(((e,t)=>{if(e){return this.emit("error",e)}d("stat done: %s { size: %s }",this.filename,t);this._size=t;this._dest=this._createStream(this._stream);this._opening=false;this.once("open",(()=>{if(this._stream.eventNames().includes("rotate")){this._stream.emit("rotate")}else{this._rotate=false}}))}))}stat(e){const t=this._getFile();const r=i.join(this.dirname,t);n.stat(r,((n,i)=>{if(n&&n.code==="ENOENT"){d("ENOENTok",r);this.filename=t;return e(null,0)}if(n){d(`err ${n.code} ${r}`);return e(n)}if(!i||this._needsNewFile(i.size)){return this._incFile((()=>this.stat(e)))}this.filename=t;e(null,i.size)}))}close(e){if(!this._stream){return}this._stream.end((()=>{if(e){e()}this.emit("flush");this.emit("closed")}))}_needsNewFile(e){e=e||this._size;return this.maxsize&&e>=this.maxsize}_onError(e){this.emit("error",e)}_setupStream(e){e.on("error",this._onError);return e}_cleanupStream(e){e.removeListener("error",this._onError);e.destroy();return e}_rotateFile(){this._incFile((()=>this.open()))}_endStream(e=(()=>{})){if(this._dest){this._stream.unpipe(this._dest);this._dest.end((()=>{this._cleanupStream(this._dest);e()}))}else{e()}}_createStream(e){const t=i.join(this.dirname,this.filename);d("create stream start",t,this.options);const r=n.createWriteStream(t,this.options).on("error",(e=>d(e))).on("close",(()=>d("close",r.path,r.bytesWritten))).on("open",(()=>{d("file open ok",t);this.emit("open",t);e.pipe(r);if(this.rotatedWhileOpening){this._stream=new c;this._stream.setMaxListeners(30);this._rotateFile();this.rotatedWhileOpening=false;this._cleanupStream(r);e.end()}}));d("create stream ok",t);return r}_incFile(e){d("_incFile",this.filename);const t=i.extname(this._basename);const r=i.basename(this._basename,t);const n=[];if(this.zippedArchive){n.push(function(e){const n=this._created>0&&!this.tailable?this._created:"";this._compressFile(i.join(this.dirname,`${r}${n}${t}`),i.join(this.dirname,`${r}${n}${t}.gz`),e)}.bind(this))}n.push(function(e){if(!this.tailable){this._created+=1;this._checkMaxFilesIncrementing(t,r,e)}else{this._checkMaxFilesTailable(t,r,e)}}.bind(this));s(n,e)}_getFile(){const e=i.extname(this._basename);const t=i.basename(this._basename,e);const r=this.rotationFormat?this.rotationFormat():this._created;return!this.tailable&&this._created?`${t}${r}${e}`:`${t}${e}`}_checkMaxFilesIncrementing(e,t,r){if(!this.maxFiles||this._created<this.maxFiles){return setImmediate(r)}const s=this._created-this.maxFiles;const a=s!==0?s:"";const o=this.zippedArchive?".gz":"";const l=`${t}${a}${e}${o}`;const c=i.join(this.dirname,l);n.unlink(c,r)}_checkMaxFilesTailable(e,t,r){const a=[];if(!this.maxFiles){return}const o=this.zippedArchive?".gz":"";for(let r=this.maxFiles-1;r>1;r--){a.push(function(r,s){let a=`${t}${r-1}${e}${o}`;const l=i.join(this.dirname,a);n.exists(l,(c=>{if(!c){return s(null)}a=`${t}${r}${e}${o}`;n.rename(l,i.join(this.dirname,a),s)}))}.bind(this,r))}s(a,(()=>{n.rename(i.join(this.dirname,`${t}${e}${o}`),i.join(this.dirname,`${t}1${e}${o}`),r)}))}_compressFile(e,t,r){n.access(e,n.F_OK,(i=>{if(i){return r()}var s=a.createGzip();var o=n.createReadStream(e);var l=n.createWriteStream(t);l.on("finish",(()=>{n.unlink(e,r)}));o.pipe(s).pipe(l)}))}_createLogDirIfNotExist(e){if(!n.existsSync(e)){n.mkdirSync(e,{recursive:true})}}}},8028:(e,t,r)=>{const n=r(3685);const i=r(5687);const{Stream:s}=r(7201);const a=r(7281);const o=r(7560);e.exports=class Http extends a{constructor(e={}){super(e);this.options=e;this.name=e.name||"http";this.ssl=!!e.ssl;this.host=e.host||"localhost";this.port=e.port;this.auth=e.auth;this.path=e.path||"";this.agent=e.agent;this.headers=e.headers||{};this.headers["content-type"]="application/json";this.batch=e.batch||false;this.batchInterval=e.batchInterval||5e3;this.batchCount=e.batchCount||10;this.batchOptions=[];this.batchTimeoutID=-1;this.batchCallback={};if(!this.port){this.port=this.ssl?443:80}}log(e,t){this._request(e,null,null,((t,r)=>{if(r&&r.statusCode!==200){t=new Error(`Invalid HTTP Status Code: ${r.statusCode}`)}if(t){this.emit("warn",t)}else{this.emit("logged",e)}}));if(t){setImmediate(t)}}query(e,t){if(typeof e==="function"){t=e;e={}}e={method:"query",params:this.normalizeQuery(e)};const r=e.params.auth||null;delete e.params.auth;const n=e.params.path||null;delete e.params.path;this._request(e,r,n,((e,r,n)=>{if(r&&r.statusCode!==200){e=new Error(`Invalid HTTP Status Code: ${r.statusCode}`)}if(e){return t(e)}if(typeof n==="string"){try{n=JSON.parse(n)}catch(e){return t(e)}}t(null,n)}))}stream(e={}){const t=new s;e={method:"stream",params:e};const r=e.params.path||null;delete e.params.path;const n=e.params.auth||null;delete e.params.auth;let i="";const a=this._request(e,n,r);t.destroy=()=>a.destroy();a.on("data",(e=>{e=(i+e).split(/\n+/);const r=e.length-1;let n=0;for(;n<r;n++){try{t.emit("log",JSON.parse(e[n]))}catch(e){t.emit("error",e)}}i=e[r]}));a.on("error",(e=>t.emit("error",e)));return t}_request(e,t,r,n){e=e||{};t=t||this.auth;r=r||this.path||"";if(this.batch){this._doBatch(e,n,t,r)}else{this._doRequest(e,n,t,r)}}_doBatch(e,t,r,n){this.batchOptions.push(e);if(this.batchOptions.length===1){const e=this;this.batchCallback=t;this.batchTimeoutID=setTimeout((function(){e.batchTimeoutID=-1;e._doBatchRequest(e.batchCallback,r,n)}),this.batchInterval)}if(this.batchOptions.length===this.batchCount){this._doBatchRequest(this.batchCallback,r,n)}}_doBatchRequest(e,t,r){if(this.batchTimeoutID>0){clearTimeout(this.batchTimeoutID);this.batchTimeoutID=-1}const n=this.batchOptions.slice();this.batchOptions=[];this._doRequest(n,e,t,r)}_doRequest(e,t,r,s){const a=Object.assign({},this.headers);if(r&&r.bearer){a.Authorization=`Bearer ${r.bearer}`}const l=(this.ssl?i:n).request({...this.options,method:"POST",host:this.host,port:this.port,path:`/${s.replace(/^\//,"")}`,headers:a,auth:r&&r.username&&r.password?`${r.username}:${r.password}`:"",agent:this.agent});l.on("error",t);l.on("response",(e=>e.on("end",(()=>t(null,e))).resume()));l.end(Buffer.from(o(e,this.options.replacer),"utf8"))}}},7804:(e,t,r)=>{Object.defineProperty(t,"Console",{configurable:true,enumerable:true,get(){return r(7501)}});Object.defineProperty(t,"File",{configurable:true,enumerable:true,get(){return r(2478)}});Object.defineProperty(t,"Http",{configurable:true,enumerable:true,get(){return r(8028)}});Object.defineProperty(t,"Stream",{configurable:true,enumerable:true,get(){return r(4747)}})},4747:(e,t,r)=>{const n=r(1554);const{MESSAGE:i}=r(3937);const s=r(2037);const a=r(7281);e.exports=class Stream extends a{constructor(e={}){super(e);if(!e.stream||!n(e.stream)){throw new Error("options.stream is required.")}this._stream=e.stream;this._stream.setMaxListeners(Infinity);this.isObjectMode=e.stream._writableState.objectMode;this.eol=typeof e.eol==="string"?e.eol:s.EOL}log(e,t){setImmediate((()=>this.emit("logged",e)));if(this.isObjectMode){this._stream.write(e);if(t){t()}return}this._stream.write(`${e[i]}${this.eol}`);if(t){t()}return}}},7200:e=>{const t={};function createErrorType(e,r,n){if(!n){n=Error}function getMessage(e,t,n){if(typeof r==="string"){return r}else{return r(e,t,n)}}class NodeError extends n{constructor(e,t,r){super(getMessage(e,t,r))}}NodeError.prototype.name=n.name;NodeError.prototype.code=e;t[e]=NodeError}function oneOf(e,t){if(Array.isArray(e)){const r=e.length;e=e.map((e=>String(e)));if(r>2){return`one of ${t} ${e.slice(0,r-1).join(", ")}, or `+e[r-1]}else if(r===2){return`one of ${t} ${e[0]} or ${e[1]}`}else{return`of ${t} ${e[0]}`}}else{return`of ${t} ${String(e)}`}}function startsWith(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function endsWith(e,t,r){if(r===undefined||r>e.length){r=e.length}return e.substring(r-t.length,r)===t}function includes(e,t,r){if(typeof r!=="number"){r=0}if(r+t.length>e.length){return false}else{return e.indexOf(t,r)!==-1}}createErrorType("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError);createErrorType("ERR_INVALID_ARG_TYPE",(function(e,t,r){let n;if(typeof t==="string"&&startsWith(t,"not ")){n="must not be";t=t.replace(/^not /,"")}else{n="must be"}let i;if(endsWith(e," argument")){i=`The ${e} ${n} ${oneOf(t,"type")}`}else{const r=includes(e,".")?"property":"argument";i=`The "${e}" ${r} ${n} ${oneOf(t,"type")}`}i+=`. Received type ${typeof r}`;return i}),TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"}));createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"}));createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");e.exports.q=t},2307:(e,t,r)=>{var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=Duplex;var i=r(3261);var s=r(8571);r(4124)(Duplex,i);{var a=n(s.prototype);for(var o=0;o<a.length;o++){var l=a[o];if(!Duplex.prototype[l])Duplex.prototype[l]=s.prototype[l]}}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);i.call(this,e);s.call(this,e);this.allowHalfOpen=true;if(e){if(e.readable===false)this.readable=false;if(e.writable===false)this.writable=false;if(e.allowHalfOpen===false){this.allowHalfOpen=false;this.once("end",onend)}}}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function onend(){if(this._writableState.ended)return;process.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function set(e){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=e;this._writableState.destroyed=e}})},7586:(e,t,r)=>{e.exports=PassThrough;var n=r(1026);r(4124)(PassThrough,n);function PassThrough(e){if(!(this instanceof PassThrough))return new PassThrough(e);n.call(this,e)}PassThrough.prototype._transform=function(e,t,r){r(null,e)}},3261:(e,t,r)=>{e.exports=Readable;var n;Readable.ReadableState=ReadableState;var i=r(2361).EventEmitter;var s=function EElistenerCount(e,t){return e.listeners(t).length};var a=r(8928);var o=r(4300).Buffer;var l=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(e){return o.from(e)}function _isUint8Array(e){return o.isBuffer(e)||e instanceof l}var c=r(3837);var u;if(c&&c.debuglog){u=c.debuglog("stream")}else{u=function debug(){}}var d=r(7191);var f=r(8980);var h=r(7249),p=h.getHighWaterMark;var g=r(7200).q,m=g.ERR_INVALID_ARG_TYPE,v=g.ERR_STREAM_PUSH_AFTER_EOF,y=g.ERR_METHOD_NOT_IMPLEMENTED,b=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;var S;var _;var w;r(4124)(Readable,a);var C=f.errorOrDestroy;var E=["error","close","destroy","pause","resume"];function prependListener(e,t,r){if(typeof e.prependListener==="function")return e.prependListener(t,r);if(!e._events||!e._events[t])e.on(t,r);else if(Array.isArray(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}function ReadableState(e,t,i){n=n||r(2307);e=e||{};if(typeof i!=="boolean")i=t instanceof n;this.objectMode=!!e.objectMode;if(i)this.objectMode=this.objectMode||!!e.readableObjectMode;this.highWaterMark=p(this,e,"readableHighWaterMark",i);this.buffer=new d;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.paused=true;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.destroyed=false;this.defaultEncoding=e.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(e.encoding){if(!S)S=r(4841).s;this.decoder=new S(e.encoding);this.encoding=e.encoding}}function Readable(e){n=n||r(2307);if(!(this instanceof Readable))return new Readable(e);var t=this instanceof n;this._readableState=new ReadableState(e,this,t);this.readable=true;if(e){if(typeof e.read==="function")this._read=e.read;if(typeof e.destroy==="function")this._destroy=e.destroy}a.call(this)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function set(e){if(!this._readableState){return}this._readableState.destroyed=e}});Readable.prototype.destroy=f.destroy;Readable.prototype._undestroy=f.undestroy;Readable.prototype._destroy=function(e,t){t(e)};Readable.prototype.push=function(e,t){var r=this._readableState;var n;if(!r.objectMode){if(typeof e==="string"){t=t||r.defaultEncoding;if(t!==r.encoding){e=o.from(e,t);t=""}n=true}}else{n=true}return readableAddChunk(this,e,t,false,n)};Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,true,false)};function readableAddChunk(e,t,r,n,i){u("readableAddChunk",t);var s=e._readableState;if(t===null){s.reading=false;onEofChunk(e,s)}else{var a;if(!i)a=chunkInvalid(s,t);if(a){C(e,a)}else if(s.objectMode||t&&t.length>0){if(typeof t!=="string"&&!s.objectMode&&Object.getPrototypeOf(t)!==o.prototype){t=_uint8ArrayToBuffer(t)}if(n){if(s.endEmitted)C(e,new b);else addChunk(e,s,t,true)}else if(s.ended){C(e,new v)}else if(s.destroyed){return false}else{s.reading=false;if(s.decoder&&!r){t=s.decoder.write(t);if(s.objectMode||t.length!==0)addChunk(e,s,t,false);else maybeReadMore(e,s)}else{addChunk(e,s,t,false)}}}else if(!n){s.reading=false;maybeReadMore(e,s)}}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function addChunk(e,t,r,n){if(t.flowing&&t.length===0&&!t.sync){t.awaitDrain=0;e.emit("data",r)}else{t.length+=t.objectMode?1:r.length;if(n)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)emitReadable(e)}maybeReadMore(e,t)}function chunkInvalid(e,t){var r;if(!_isUint8Array(t)&&typeof t!=="string"&&t!==undefined&&!e.objectMode){r=new m("chunk",["string","Buffer","Uint8Array"],t)}return r}Readable.prototype.isPaused=function(){return this._readableState.flowing===false};Readable.prototype.setEncoding=function(e){if(!S)S=r(4841).s;var t=new S(e);this._readableState.decoder=t;this._readableState.encoding=this._readableState.decoder.encoding;var n=this._readableState.buffer.head;var i="";while(n!==null){i+=t.write(n.data);n=n.next}this._readableState.buffer.clear();if(i!=="")this._readableState.buffer.push(i);this._readableState.length=i.length;return this};var T=1073741824;function computeNewHighWaterMark(e){if(e>=T){e=T}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function howMuchToRead(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=computeNewHighWaterMark(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}Readable.prototype.read=function(e){u("read",e);e=parseInt(e,10);var t=this._readableState;var r=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&((t.highWaterMark!==0?t.length>=t.highWaterMark:t.length>0)||t.ended)){u("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)endReadable(this);else emitReadable(this);return null}e=howMuchToRead(e,t);if(e===0&&t.ended){if(t.length===0)endReadable(this);return null}var n=t.needReadable;u("need readable",n);if(t.length===0||t.length-e<t.highWaterMark){n=true;u("length less than watermark",n)}if(t.ended||t.reading){n=false;u("reading or ended",n)}else if(n){u("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=howMuchToRead(r,t)}var i;if(e>0)i=fromList(e,t);else i=null;if(i===null){t.needReadable=t.length<=t.highWaterMark;e=0}else{t.length-=e;t.awaitDrain=0}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)endReadable(this)}if(i!==null)this.emit("data",i);return i};function onEofChunk(e,t){u("onEofChunk");if(t.ended)return;if(t.decoder){var r=t.decoder.end();if(r&&r.length){t.buffer.push(r);t.length+=t.objectMode?1:r.length}}t.ended=true;if(t.sync){emitReadable(e)}else{t.needReadable=false;if(!t.emittedReadable){t.emittedReadable=true;emitReadable_(e)}}}function emitReadable(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable);t.needReadable=false;if(!t.emittedReadable){u("emitReadable",t.flowing);t.emittedReadable=true;process.nextTick(emitReadable_,e)}}function emitReadable_(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended);if(!t.destroyed&&(t.length||t.ended)){e.emit("readable");t.emittedReadable=false}t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark;flow(e)}function maybeReadMore(e,t){if(!t.readingMore){t.readingMore=true;process.nextTick(maybeReadMore_,e,t)}}function maybeReadMore_(e,t){while(!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&t.length===0)){var r=t.length;u("maybeReadMore read 0");e.read(0);if(r===t.length)break}t.readingMore=false}Readable.prototype._read=function(e){C(this,new y("_read()"))};Readable.prototype.pipe=function(e,t){var r=this;var n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e);break}n.pipesCount+=1;u("pipe count=%d opts=%j",n.pipesCount,t);var i=(!t||t.end!==false)&&e!==process.stdout&&e!==process.stderr;var a=i?onend:unpipe;if(n.endEmitted)process.nextTick(a);else r.once("end",a);e.on("unpipe",onunpipe);function onunpipe(e,t){u("onunpipe");if(e===r){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;cleanup()}}}function onend(){u("onend");e.end()}var o=pipeOnDrain(r);e.on("drain",o);var l=false;function cleanup(){u("cleanup");e.removeListener("close",onclose);e.removeListener("finish",onfinish);e.removeListener("drain",o);e.removeListener("error",onerror);e.removeListener("unpipe",onunpipe);r.removeListener("end",onend);r.removeListener("end",unpipe);r.removeListener("data",ondata);l=true;if(n.awaitDrain&&(!e._writableState||e._writableState.needDrain))o()}r.on("data",ondata);function ondata(t){u("ondata");var i=e.write(t);u("dest.write",i);if(i===false){if((n.pipesCount===1&&n.pipes===e||n.pipesCount>1&&indexOf(n.pipes,e)!==-1)&&!l){u("false write response, pause",n.awaitDrain);n.awaitDrain++}r.pause()}}function onerror(t){u("onerror",t);unpipe();e.removeListener("error",onerror);if(s(e,"error")===0)C(e,t)}prependListener(e,"error",onerror);function onclose(){e.removeListener("finish",onfinish);unpipe()}e.once("close",onclose);function onfinish(){u("onfinish");e.removeListener("close",onclose);unpipe()}e.once("finish",onfinish);function unpipe(){u("unpipe");r.unpipe(e)}e.emit("pipe",r);if(!n.flowing){u("pipe resume");r.resume()}return e};function pipeOnDrain(e){return function pipeOnDrainFunctionResult(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain);if(t.awaitDrain)t.awaitDrain--;if(t.awaitDrain===0&&s(e,"data")){t.flowing=true;flow(e)}}}Readable.prototype.unpipe=function(e){var t=this._readableState;var r={hasUnpiped:false};if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this,r);return this}if(!e){var n=t.pipes;var i=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:false});return this}var a=indexOf(t.pipes,e);if(a===-1)return this;t.pipes.splice(a,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this,r);return this};Readable.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);var n=this._readableState;if(e==="data"){n.readableListening=this.listenerCount("readable")>0;if(n.flowing!==false)this.resume()}else if(e==="readable"){if(!n.endEmitted&&!n.readableListening){n.readableListening=n.needReadable=true;n.flowing=false;n.emittedReadable=false;u("on readable",n.length,n.reading);if(n.length){emitReadable(this)}else if(!n.reading){process.nextTick(nReadingNextTick,this)}}}return r};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.removeListener=function(e,t){var r=a.prototype.removeListener.call(this,e,t);if(e==="readable"){process.nextTick(updateReadableListening,this)}return r};Readable.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);if(e==="readable"||e===undefined){process.nextTick(updateReadableListening,this)}return t};function updateReadableListening(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0;if(t.resumeScheduled&&!t.paused){t.flowing=true}else if(e.listenerCount("data")>0){e.resume()}}function nReadingNextTick(e){u("readable nexttick read 0");e.read(0)}Readable.prototype.resume=function(){var e=this._readableState;if(!e.flowing){u("resume");e.flowing=!e.readableListening;resume(this,e)}e.paused=false;return this};function resume(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;process.nextTick(resume_,e,t)}}function resume_(e,t){u("resume",t.reading);if(!t.reading){e.read(0)}t.resumeScheduled=false;e.emit("resume");flow(e);if(t.flowing&&!t.reading)e.read(0)}Readable.prototype.pause=function(){u("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){u("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState.paused=true;return this};function flow(e){var t=e._readableState;u("flow",t.flowing);while(t.flowing&&e.read()!==null);}Readable.prototype.wrap=function(e){var t=this;var r=this._readableState;var n=false;e.on("end",(function(){u("wrapped end");if(r.decoder&&!r.ended){var e=r.decoder.end();if(e&&e.length)t.push(e)}t.push(null)}));e.on("data",(function(i){u("wrapped data");if(r.decoder)i=r.decoder.write(i);if(r.objectMode&&(i===null||i===undefined))return;else if(!r.objectMode&&(!i||!i.length))return;var s=t.push(i);if(!s){n=true;e.pause()}}));for(var i in e){if(this[i]===undefined&&typeof e[i]==="function"){this[i]=function methodWrap(t){return function methodWrapReturnFunction(){return e[t].apply(e,arguments)}}(i)}}for(var s=0;s<E.length;s++){e.on(E[s],this.emit.bind(this,E[s]))}this._read=function(t){u("wrapped _read",t);if(n){n=false;e.resume()}};return this};if(typeof Symbol==="function"){Readable.prototype[Symbol.asyncIterator]=function(){if(_===undefined){_=r(1031)}return _(this)}}Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:false,get:function get(){return this._readableState.highWaterMark}});Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:false,get:function get(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:false,get:function get(){return this._readableState.flowing},set:function set(e){if(this._readableState){this._readableState.flowing=e}}});Readable._fromList=fromList;Object.defineProperty(Readable.prototype,"readableLength",{enumerable:false,get:function get(){return this._readableState.length}});function fromList(e,t){if(t.length===0)return null;var r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.first();else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=t.buffer.consume(e,t.decoder)}return r}function endReadable(e){var t=e._readableState;u("endReadable",t.endEmitted);if(!t.endEmitted){t.ended=true;process.nextTick(endReadableNT,t,e)}}function endReadableNT(e,t){u("endReadableNT",e.endEmitted,e.length);if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end");if(e.autoDestroy){var r=t._writableState;if(!r||r.autoDestroy&&r.finished){t.destroy()}}}}if(typeof Symbol==="function"){Readable.from=function(e,t){if(w===undefined){w=r(6636)}return w(Readable,e,t)}}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r]===t)return r}return-1}},1026:(e,t,r)=>{e.exports=Transform;var n=r(7200).q,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,a=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=n.ERR_TRANSFORM_WITH_LENGTH_0;var l=r(2307);r(4124)(Transform,l);function afterTransform(e,t){var r=this._transformState;r.transforming=false;var n=r.writecb;if(n===null){return this.emit("error",new s)}r.writechunk=null;r.writecb=null;if(t!=null)this.push(t);n(e);var i=this._readableState;i.reading=false;if(i.needReadable||i.length<i.highWaterMark){this._read(i.highWaterMark)}}function Transform(e){if(!(this instanceof Transform))return new Transform(e);l.call(this,e);this._transformState={afterTransform:afterTransform.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.on("prefinish",prefinish)}function prefinish(){var e=this;if(typeof this._flush==="function"&&!this._readableState.destroyed){this._flush((function(t,r){done(e,t,r)}))}else{done(this,null,null)}}Transform.prototype.push=function(e,t){this._transformState.needTransform=false;return l.prototype.push.call(this,e,t)};Transform.prototype._transform=function(e,t,r){r(new i("_transform()"))};Transform.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r;n.writechunk=e;n.writeencoding=t;if(!n.transforming){var i=this._readableState;if(n.needTransform||i.needReadable||i.length<i.highWaterMark)this._read(i.highWaterMark)}};Transform.prototype._read=function(e){var t=this._transformState;if(t.writechunk!==null&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};Transform.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))};function done(e,t,r){if(t)return e.emit("error",t);if(r!=null)e.push(r);if(e._writableState.length)throw new o;if(e._transformState.transforming)throw new a;return e.push(null)}},8571:(e,t,r)=>{e.exports=Writable;function WriteReq(e,t,r){this.chunk=e;this.encoding=t;this.callback=r;this.next=null}function CorkedRequest(e){var t=this;this.next=null;this.entry=null;this.finish=function(){onCorkedFinish(t,e)}}var n;Writable.WritableState=WritableState;var i={deprecate:r(5278)};var s=r(8928);var a=r(4300).Buffer;var o=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(e){return a.from(e)}function _isUint8Array(e){return a.isBuffer(e)||e instanceof o}var l=r(8980);var c=r(7249),u=c.getHighWaterMark;var d=r(7200).q,f=d.ERR_INVALID_ARG_TYPE,h=d.ERR_METHOD_NOT_IMPLEMENTED,p=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,m=d.ERR_STREAM_DESTROYED,v=d.ERR_STREAM_NULL_VALUES,y=d.ERR_STREAM_WRITE_AFTER_END,b=d.ERR_UNKNOWN_ENCODING;var S=l.errorOrDestroy;r(4124)(Writable,s);function nop(){}function WritableState(e,t,i){n=n||r(2307);e=e||{};if(typeof i!=="boolean")i=t instanceof n;this.objectMode=!!e.objectMode;if(i)this.objectMode=this.objectMode||!!e.writableObjectMode;this.highWaterMark=u(this,e,"writableHighWaterMark",i);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var s=e.decodeStrings===false;this.decodeStrings=!s;this.defaultEncoding=e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){onwrite(t,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.emitClose=e.emitClose!==false;this.autoDestroy=!!e.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var e=this.bufferedRequest;var t=[];while(e){t.push(e);e=e.next}return t};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:i.deprecate((function writableStateBufferGetter(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}})();var _;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){_=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function value(e){if(_.call(this,e))return true;if(this!==Writable)return false;return e&&e._writableState instanceof WritableState}})}else{_=function realHasInstance(e){return e instanceof this}}function Writable(e){n=n||r(2307);var t=this instanceof n;if(!t&&!_.call(Writable,this))return new Writable(e);this._writableState=new WritableState(e,this,t);this.writable=true;if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.final==="function")this._final=e.final}s.call(this)}Writable.prototype.pipe=function(){S(this,new g)};function writeAfterEnd(e,t){var r=new y;S(e,r);process.nextTick(t,r)}function validChunk(e,t,r,n){var i;if(r===null){i=new v}else if(typeof r!=="string"&&!t.objectMode){i=new f("chunk",["string","Buffer"],r)}if(i){S(e,i);process.nextTick(n,i);return false}return true}Writable.prototype.write=function(e,t,r){var n=this._writableState;var i=false;var s=!n.objectMode&&_isUint8Array(e);if(s&&!a.isBuffer(e)){e=_uint8ArrayToBuffer(e)}if(typeof t==="function"){r=t;t=null}if(s)t="buffer";else if(!t)t=n.defaultEncoding;if(typeof r!=="function")r=nop;if(n.ending)writeAfterEnd(this,r);else if(s||validChunk(this,n,e,r)){n.pendingcb++;i=writeOrBuffer(this,n,s,e,t,r)}return i};Writable.prototype.cork=function(){this._writableState.corked++};Writable.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest)clearBuffer(this,e)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(e){if(typeof e==="string")e=e.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new b(e);this._writableState.defaultEncoding=e;return this};Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});function decodeChunk(e,t,r){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=a.from(t,r)}return t}Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});function writeOrBuffer(e,t,r,n,i,s){if(!r){var a=decodeChunk(t,n,i);if(n!==a){r=true;i="buffer";n=a}}var o=t.objectMode?1:n.length;t.length+=o;var l=t.length<t.highWaterMark;if(!l)t.needDrain=true;if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null};if(c){c.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{doWrite(e,t,false,o,n,i,s)}return l}function doWrite(e,t,r,n,i,s,a){t.writelen=n;t.writecb=a;t.writing=true;t.sync=true;if(t.destroyed)t.onwrite(new m("write"));else if(r)e._writev(i,t.onwrite);else e._write(i,s,t.onwrite);t.sync=false}function onwriteError(e,t,r,n,i){--t.pendingcb;if(r){process.nextTick(i,n);process.nextTick(finishMaybe,e,t);e._writableState.errorEmitted=true;S(e,n)}else{i(n);e._writableState.errorEmitted=true;S(e,n);finishMaybe(e,t)}}function onwriteStateUpdate(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function onwrite(e,t){var r=e._writableState;var n=r.sync;var i=r.writecb;if(typeof i!=="function")throw new p;onwriteStateUpdate(r);if(t)onwriteError(e,r,n,t,i);else{var s=needFinish(r)||e.destroyed;if(!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest){clearBuffer(e,r)}if(n){process.nextTick(afterWrite,e,r,s,i)}else{afterWrite(e,r,s,i)}}}function afterWrite(e,t,r,n){if(!r)onwriteDrain(e,t);t.pendingcb--;n();finishMaybe(e,t)}function onwriteDrain(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function clearBuffer(e,t){t.bufferProcessing=true;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount;var i=new Array(n);var s=t.corkedRequestsFree;s.entry=r;var a=0;var o=true;while(r){i[a]=r;if(!r.isBuf)o=false;r=r.next;a+=1}i.allBuffers=o;doWrite(e,t,true,t.length,i,"",s.finish);t.pendingcb++;t.lastBufferedRequest=null;if(s.next){t.corkedRequestsFree=s.next;s.next=null}else{t.corkedRequestsFree=new CorkedRequest(t)}t.bufferedRequestCount=0}else{while(r){var l=r.chunk;var c=r.encoding;var u=r.callback;var d=t.objectMode?1:l.length;doWrite(e,t,false,d,l,c,u);r=r.next;t.bufferedRequestCount--;if(t.writing){break}}if(r===null)t.lastBufferedRequest=null}t.bufferedRequest=r;t.bufferProcessing=false}Writable.prototype._write=function(e,t,r){r(new h("_write()"))};Writable.prototype._writev=null;Writable.prototype.end=function(e,t,r){var n=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(n.corked){n.corked=1;this.uncork()}if(!n.ending)endWritable(this,n,r);return this};Object.defineProperty(Writable.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function needFinish(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function callFinal(e,t){e._final((function(r){t.pendingcb--;if(r){S(e,r)}t.prefinished=true;e.emit("prefinish");finishMaybe(e,t)}))}function prefinish(e,t){if(!t.prefinished&&!t.finalCalled){if(typeof e._final==="function"&&!t.destroyed){t.pendingcb++;t.finalCalled=true;process.nextTick(callFinal,e,t)}else{t.prefinished=true;e.emit("prefinish")}}}function finishMaybe(e,t){var r=needFinish(t);if(r){prefinish(e,t);if(t.pendingcb===0){t.finished=true;e.emit("finish");if(t.autoDestroy){var n=e._readableState;if(!n||n.autoDestroy&&n.endEmitted){e.destroy()}}}}return r}function endWritable(e,t,r){t.ending=true;finishMaybe(e,t);if(r){if(t.finished)process.nextTick(r);else e.once("finish",r)}t.ended=true;e.writable=false}function onCorkedFinish(e,t,r){var n=e.entry;e.entry=null;while(n){var i=n.callback;t.pendingcb--;i(r);n=n.next}t.corkedRequestsFree.next=e}Object.defineProperty(Writable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function set(e){if(!this._writableState){return}this._writableState.destroyed=e}});Writable.prototype.destroy=l.destroy;Writable.prototype._undestroy=l.undestroy;Writable.prototype._destroy=function(e,t){t(e)}},1031:(e,t,r)=>{var n;function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i=r(1077);var s=Symbol("lastResolve");var a=Symbol("lastReject");var o=Symbol("error");var l=Symbol("ended");var c=Symbol("lastPromise");var u=Symbol("handlePromise");var d=Symbol("stream");function createIterResult(e,t){return{value:e,done:t}}function readAndResolve(e){var t=e[s];if(t!==null){var r=e[d].read();if(r!==null){e[c]=null;e[s]=null;e[a]=null;t(createIterResult(r,false))}}}function onReadable(e){process.nextTick(readAndResolve,e)}function wrapForNext(e,t){return function(r,n){e.then((function(){if(t[l]){r(createIterResult(undefined,true));return}t[u](r,n)}),n)}}var f=Object.getPrototypeOf((function(){}));var h=Object.setPrototypeOf((n={get stream(){return this[d]},next:function next(){var e=this;var t=this[o];if(t!==null){return Promise.reject(t)}if(this[l]){return Promise.resolve(createIterResult(undefined,true))}if(this[d].destroyed){return new Promise((function(t,r){process.nextTick((function(){if(e[o]){r(e[o])}else{t(createIterResult(undefined,true))}}))}))}var r=this[c];var n;if(r){n=new Promise(wrapForNext(r,this))}else{var i=this[d].read();if(i!==null){return Promise.resolve(createIterResult(i,false))}n=new Promise(this[u])}this[c]=n;return n}},_defineProperty(n,Symbol.asyncIterator,(function(){return this})),_defineProperty(n,"return",(function _return(){var e=this;return new Promise((function(t,r){e[d].destroy(null,(function(e){if(e){r(e);return}t(createIterResult(undefined,true))}))}))})),n),f);var p=function createReadableStreamAsyncIterator(e){var t;var r=Object.create(h,(t={},_defineProperty(t,d,{value:e,writable:true}),_defineProperty(t,s,{value:null,writable:true}),_defineProperty(t,a,{value:null,writable:true}),_defineProperty(t,o,{value:null,writable:true}),_defineProperty(t,l,{value:e._readableState.endEmitted,writable:true}),_defineProperty(t,u,{value:function value(e,t){var n=r[d].read();if(n){r[c]=null;r[s]=null;r[a]=null;e(createIterResult(n,false))}else{r[s]=e;r[a]=t}},writable:true}),t));r[c]=null;i(e,(function(e){if(e&&e.code!=="ERR_STREAM_PREMATURE_CLOSE"){var t=r[a];if(t!==null){r[c]=null;r[s]=null;r[a]=null;t(e)}r[o]=e;return}var n=r[s];if(n!==null){r[c]=null;r[s]=null;r[a]=null;n(createIterResult(undefined,true))}r[l]=true}));e.on("readable",onReadable.bind(null,r));return r};e.exports=p},7191:(e,t,r)=>{function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){if(t)_defineProperties(e.prototype,t);if(r)_defineProperties(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n=r(4300),i=n.Buffer;var s=r(3837),a=s.inspect;var o=a&&a.custom||"inspect";function copyBuffer(e,t,r){i.prototype.copy.call(e,t,r)}e.exports=function(){function BufferList(){_classCallCheck(this,BufferList);this.head=null;this.tail=null;this.length=0}_createClass(BufferList,[{key:"push",value:function push(e){var t={data:e,next:null};if(this.length>0)this.tail.next=t;else this.head=t;this.tail=t;++this.length}},{key:"unshift",value:function unshift(e){var t={data:e,next:this.head};if(this.length===0)this.tail=t;this.head=t;++this.length}},{key:"shift",value:function shift(){if(this.length===0)return;var e=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return e}},{key:"clear",value:function clear(){this.head=this.tail=null;this.length=0}},{key:"join",value:function join(e){if(this.length===0)return"";var t=this.head;var r=""+t.data;while(t=t.next)r+=e+t.data;return r}},{key:"concat",value:function concat(e){if(this.length===0)return i.alloc(0);var t=i.allocUnsafe(e>>>0);var r=this.head;var n=0;while(r){copyBuffer(r.data,t,n);n+=r.data.length;r=r.next}return t}},{key:"consume",value:function consume(e,t){var r;if(e<this.head.data.length){r=this.head.data.slice(0,e);this.head.data=this.head.data.slice(e)}else if(e===this.head.data.length){r=this.shift()}else{r=t?this._getString(e):this._getBuffer(e)}return r}},{key:"first",value:function first(){return this.head.data}},{key:"_getString",value:function _getString(e){var t=this.head;var r=1;var n=t.data;e-=n.length;while(t=t.next){var i=t.data;var s=e>i.length?i.length:e;if(s===i.length)n+=i;else n+=i.slice(0,e);e-=s;if(e===0){if(s===i.length){++r;if(t.next)this.head=t.next;else this.head=this.tail=null}else{this.head=t;t.data=i.slice(s)}break}++r}this.length-=r;return n}},{key:"_getBuffer",value:function _getBuffer(e){var t=i.allocUnsafe(e);var r=this.head;var n=1;r.data.copy(t);e-=r.data.length;while(r=r.next){var s=r.data;var a=e>s.length?s.length:e;s.copy(t,t.length-e,0,a);e-=a;if(e===0){if(a===s.length){++n;if(r.next)this.head=r.next;else this.head=this.tail=null}else{this.head=r;r.data=s.slice(a)}break}++n}this.length-=n;return t}},{key:o,value:function value(e,t){return a(this,_objectSpread(_objectSpread({},t),{},{depth:0,customInspect:false}))}}]);return BufferList}()},8980:e=>{function destroy(e,t){var r=this;var n=this._readableState&&this._readableState.destroyed;var i=this._writableState&&this._writableState.destroyed;if(n||i){if(t){t(e)}else if(e){if(!this._writableState){process.nextTick(emitErrorNT,this,e)}else if(!this._writableState.errorEmitted){this._writableState.errorEmitted=true;process.nextTick(emitErrorNT,this,e)}}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(e||null,(function(e){if(!t&&e){if(!r._writableState){process.nextTick(emitErrorAndCloseNT,r,e)}else if(!r._writableState.errorEmitted){r._writableState.errorEmitted=true;process.nextTick(emitErrorAndCloseNT,r,e)}else{process.nextTick(emitCloseNT,r)}}else if(t){process.nextTick(emitCloseNT,r);t(e)}else{process.nextTick(emitCloseNT,r)}}));return this}function emitErrorAndCloseNT(e,t){emitErrorNT(e,t);emitCloseNT(e)}function emitCloseNT(e){if(e._writableState&&!e._writableState.emitClose)return;if(e._readableState&&!e._readableState.emitClose)return;e.emit("close")}function undestroy(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finalCalled=false;this._writableState.prefinished=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function emitErrorNT(e,t){e.emit("error",t)}function errorOrDestroy(e,t){var r=e._readableState;var n=e._writableState;if(r&&r.autoDestroy||n&&n.autoDestroy)e.destroy(t);else e.emit("error",t)}e.exports={destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy}},1077:(e,t,r)=>{var n=r(7200).q.ERR_STREAM_PREMATURE_CLOSE;function once(e){var t=false;return function(){if(t)return;t=true;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++){n[i]=arguments[i]}e.apply(this,n)}}function noop(){}function isRequest(e){return e.setHeader&&typeof e.abort==="function"}function eos(e,t,r){if(typeof t==="function")return eos(e,null,t);if(!t)t={};r=once(r||noop);var i=t.readable||t.readable!==false&&e.readable;var s=t.writable||t.writable!==false&&e.writable;var a=function onlegacyfinish(){if(!e.writable)l()};var o=e._writableState&&e._writableState.finished;var l=function onfinish(){s=false;o=true;if(!i)r.call(e)};var c=e._readableState&&e._readableState.endEmitted;var u=function onend(){i=false;c=true;if(!s)r.call(e)};var d=function onerror(t){r.call(e,t)};var f=function onclose(){var t;if(i&&!c){if(!e._readableState||!e._readableState.ended)t=new n;return r.call(e,t)}if(s&&!o){if(!e._writableState||!e._writableState.ended)t=new n;return r.call(e,t)}};var h=function onrequest(){e.req.on("finish",l)};if(isRequest(e)){e.on("complete",l);e.on("abort",f);if(e.req)h();else e.on("request",h)}else if(s&&!e._writableState){e.on("end",a);e.on("close",a)}e.on("end",u);e.on("finish",l);if(t.error!==false)e.on("error",d);e.on("close",f);return function(){e.removeListener("complete",l);e.removeListener("abort",f);e.removeListener("request",h);if(e.req)e.req.removeListener("finish",l);e.removeListener("end",a);e.removeListener("close",a);e.removeListener("finish",l);e.removeListener("end",u);e.removeListener("error",d);e.removeListener("close",f)}}e.exports=eos},6636:(e,t,r)=>{function asyncGeneratorStep(e,t,r,n,i,s,a){try{var o=e[s](a);var l=o.value}catch(e){r(e);return}if(o.done){t(l)}else{Promise.resolve(l).then(n,i)}}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function _next(e){asyncGeneratorStep(s,n,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(s,n,i,_next,_throw,"throw",e)}_next(undefined)}))}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){t=_toPropertyKey(t);if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t==="symbol"?t:String(t)}function _toPrimitive(e,t){if(typeof e!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n=r(7200).q.ERR_INVALID_ARG_TYPE;function from(e,t,r){var i;if(t&&typeof t.next==="function"){i=t}else if(t&&t[Symbol.asyncIterator])i=t[Symbol.asyncIterator]();else if(t&&t[Symbol.iterator])i=t[Symbol.iterator]();else throw new n("iterable",["Iterable"],t);var s=new e(_objectSpread({objectMode:true},r));var a=false;s._read=function(){if(!a){a=true;next()}};function next(){return _next2.apply(this,arguments)}function _next2(){_next2=_asyncToGenerator((function*(){try{var e=yield i.next(),t=e.value,r=e.done;if(r){s.push(null)}else if(s.push(yield t)){next()}else{a=false}}catch(e){s.destroy(e)}}));return _next2.apply(this,arguments)}return s}e.exports=from},4760:(e,t,r)=>{var n;function once(e){var t=false;return function(){if(t)return;t=true;e.apply(void 0,arguments)}}var i=r(7200).q,s=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function noop(e){if(e)throw e}function isRequest(e){return e.setHeader&&typeof e.abort==="function"}function destroyer(e,t,i,s){s=once(s);var o=false;e.on("close",(function(){o=true}));if(n===undefined)n=r(1077);n(e,{readable:t,writable:i},(function(e){if(e)return s(e);o=true;s()}));var l=false;return function(t){if(o)return;if(l)return;l=true;if(isRequest(e))return e.abort();if(typeof e.destroy==="function")return e.destroy();s(t||new a("pipe"))}}function call(e){e()}function pipe(e,t){return e.pipe(t)}function popCallback(e){if(!e.length)return noop;if(typeof e[e.length-1]!=="function")return noop;return e.pop()}function pipeline(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}var n=popCallback(t);if(Array.isArray(t[0]))t=t[0];if(t.length<2){throw new s("streams")}var i;var a=t.map((function(e,r){var s=r<t.length-1;var o=r>0;return destroyer(e,s,o,(function(e){if(!i)i=e;if(e)a.forEach(call);if(s)return;a.forEach(call);n(i)}))}));return t.reduce(pipe)}e.exports=pipeline},7249:(e,t,r)=>{var n=r(7200).q.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(e,t,r){return e.highWaterMark!=null?e.highWaterMark:t?e[r]:null}function getHighWaterMark(e,t,r,i){var s=highWaterMarkFrom(t,i,r);if(s!=null){if(!(isFinite(s)&&Math.floor(s)===s)||s<0){var a=i?r:"highWaterMark";throw new n(a,s)}return Math.floor(s)}return e.objectMode?16:16*1024}e.exports={getHighWaterMark:getHighWaterMark}},8928:(e,t,r)=>{e.exports=r(2781)},7201:(e,t,r)=>{var n=r(2781);if(process.env.READABLE_STREAM==="disable"&&n){e.exports=n.Readable;Object.assign(e.exports,n);e.exports.Stream=n}else{t=e.exports=r(3261);t.Stream=n||t;t.Readable=t;t.Writable=r(8571);t.Duplex=r(2307);t.Transform=r(1026);t.PassThrough=r(7586);t.finished=r(1077);t.pipeline=r(4760)}},4300:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("buffer")},9523:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("dns")},2361:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("events")},7147:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("fs")},3685:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("http")},5158:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("http2")},5687:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("https")},1808:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("net")},2037:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("os")},1017:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("path")},7282:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("process")},2781:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("stream")},1576:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("string_decoder")},4404:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("tls")},6224:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("tty")},7310:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("url")},3837:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("util")},9796:e=>{e.exports=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("zlib")},2694:e=>{var t=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;
/**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,r){this.low=e|0;this.high=t|0;this.unsigned=!!r}Long.prototype.__isLong__;Object.defineProperty(Long.prototype,"__isLong__",{value:true});function isLong(e){return(e&&e["__isLong__"])===true}function ctz32(e){var t=Math.clz32(e&-e);return e?31-t:t}Long.isLong=isLong;var r={};var n={};function fromInt(e,t){var i,s,a;if(t){e>>>=0;if(a=0<=e&&e<256){s=n[e];if(s)return s}i=fromBits(e,0,true);if(a)n[e]=i;return i}else{e|=0;if(a=-128<=e&&e<128){s=r[e];if(s)return s}i=fromBits(e,e<0?-1:0,false);if(a)r[e]=i;return i}}Long.fromInt=fromInt;function fromNumber(e,t){if(isNaN(e))return t?f:d;if(t){if(e<0)return f;if(e>=l)return v}else{if(e<=-c)return y;if(e+1>=c)return m}if(e<0)return fromNumber(-e,t).neg();return fromBits(e%o|0,e/o|0,t)}Long.fromNumber=fromNumber;function fromBits(e,t,r){return new Long(e,t,r)}Long.fromBits=fromBits;var i=Math.pow;function fromString(e,t,r){if(e.length===0)throw Error("empty string");if(typeof t==="number"){r=t;t=false}else{t=!!t}if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return t?f:d;r=r||10;if(r<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");else if(n===0){return fromString(e.substring(1),t,r).neg()}var s=fromNumber(i(r,8));var a=d;for(var o=0;o<e.length;o+=8){var l=Math.min(8,e.length-o),c=parseInt(e.substring(o,o+l),r);if(l<8){var u=fromNumber(i(r,l));a=a.mul(u).add(fromNumber(c))}else{a=a.mul(s);a=a.add(fromNumber(c))}}a.unsigned=t;return a}Long.fromString=fromString;function fromValue(e,t){if(typeof e==="number")return fromNumber(e,t);if(typeof e==="string")return fromString(e,t);return fromBits(e.low,e.high,typeof t==="boolean"?t:e.unsigned)}Long.fromValue=fromValue;var s=1<<16;var a=1<<24;var o=s*s;var l=o*o;var c=l/2;var u=fromInt(a);var d=fromInt(0);Long.ZERO=d;var f=fromInt(0,true);Long.UZERO=f;var h=fromInt(1);Long.ONE=h;var p=fromInt(1,true);Long.UONE=p;var g=fromInt(-1);Long.NEG_ONE=g;var m=fromBits(4294967295|0,2147483647|0,false);Long.MAX_VALUE=m;var v=fromBits(4294967295|0,4294967295|0,true);Long.MAX_UNSIGNED_VALUE=v;var y=fromBits(0,2147483648|0,false);Long.MIN_VALUE=y;var b=Long.prototype;b.toInt=function toInt(){return this.unsigned?this.low>>>0:this.low};b.toNumber=function toNumber(){if(this.unsigned)return(this.high>>>0)*o+(this.low>>>0);return this.high*o+(this.low>>>0)};b.toString=function toString(e){e=e||10;if(e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(y)){var t=fromNumber(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e)}var s=fromNumber(i(e,6),this.unsigned),a=this;var o="";while(true){var l=a.div(s),c=a.sub(l.mul(s)).toInt()>>>0,u=c.toString(e);a=l;if(a.isZero())return u+o;else{while(u.length<6)u="0"+u;o=""+u+o}}};b.getHighBits=function getHighBits(){return this.high};b.getHighBitsUnsigned=function getHighBitsUnsigned(){return this.high>>>0};b.getLowBits=function getLowBits(){return this.low};b.getLowBitsUnsigned=function getLowBitsUnsigned(){return this.low>>>0};b.getNumBitsAbs=function getNumBitsAbs(){if(this.isNegative())return this.eq(y)?64:this.neg().getNumBitsAbs();var e=this.high!=0?this.high:this.low;for(var t=31;t>0;t--)if((e&1<<t)!=0)break;return this.high!=0?t+33:t+1};b.isZero=function isZero(){return this.high===0&&this.low===0};b.eqz=b.isZero;b.isNegative=function isNegative(){return!this.unsigned&&this.high<0};b.isPositive=function isPositive(){return this.unsigned||this.high>=0};b.isOdd=function isOdd(){return(this.low&1)===1};b.isEven=function isEven(){return(this.low&1)===0};b.equals=function equals(e){if(!isLong(e))e=fromValue(e);if(this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1)return false;return this.high===e.high&&this.low===e.low};b.eq=b.equals;b.notEquals=function notEquals(e){return!this.eq(e)};b.neq=b.notEquals;b.ne=b.notEquals;b.lessThan=function lessThan(e){return this.comp(e)<0};b.lt=b.lessThan;b.lessThanOrEqual=function lessThanOrEqual(e){return this.comp(e)<=0};b.lte=b.lessThanOrEqual;b.le=b.lessThanOrEqual;b.greaterThan=function greaterThan(e){return this.comp(e)>0};b.gt=b.greaterThan;b.greaterThanOrEqual=function greaterThanOrEqual(e){return this.comp(e)>=0};b.gte=b.greaterThanOrEqual;b.ge=b.greaterThanOrEqual;b.compare=function compare(e){if(!isLong(e))e=fromValue(e);if(this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();if(t&&!r)return-1;if(!t&&r)return 1;if(!this.unsigned)return this.sub(e).isNegative()?-1:1;return e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1};b.comp=b.compare;b.negate=function negate(){if(!this.unsigned&&this.eq(y))return y;return this.not().add(h)};b.neg=b.negate;b.add=function add(e){if(!isLong(e))e=fromValue(e);var t=this.high>>>16;var r=this.high&65535;var n=this.low>>>16;var i=this.low&65535;var s=e.high>>>16;var a=e.high&65535;var o=e.low>>>16;var l=e.low&65535;var c=0,u=0,d=0,f=0;f+=i+l;d+=f>>>16;f&=65535;d+=n+o;u+=d>>>16;d&=65535;u+=r+a;c+=u>>>16;u&=65535;c+=t+s;c&=65535;return fromBits(d<<16|f,c<<16|u,this.unsigned)};b.subtract=function subtract(e){if(!isLong(e))e=fromValue(e);return this.add(e.neg())};b.sub=b.subtract;b.multiply=function multiply(e){if(this.isZero())return this;if(!isLong(e))e=fromValue(e);if(t){var r=t["mul"](this.low,this.high,e.low,e.high);return fromBits(r,t["get_high"](),this.unsigned)}if(e.isZero())return this.unsigned?f:d;if(this.eq(y))return e.isOdd()?y:d;if(e.eq(y))return this.isOdd()?y:d;if(this.isNegative()){if(e.isNegative())return this.neg().mul(e.neg());else return this.neg().mul(e).neg()}else if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(u)&&e.lt(u))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16;var i=this.high&65535;var s=this.low>>>16;var a=this.low&65535;var o=e.high>>>16;var l=e.high&65535;var c=e.low>>>16;var h=e.low&65535;var p=0,g=0,m=0,v=0;v+=a*h;m+=v>>>16;v&=65535;m+=s*h;g+=m>>>16;m&=65535;m+=a*c;g+=m>>>16;m&=65535;g+=i*h;p+=g>>>16;g&=65535;g+=s*c;p+=g>>>16;g&=65535;g+=a*l;p+=g>>>16;g&=65535;p+=n*h+i*c+s*l+a*o;p&=65535;return fromBits(m<<16|v,p<<16|g,this.unsigned)};b.mul=b.multiply;b.divide=function divide(e){if(!isLong(e))e=fromValue(e);if(e.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1){return this}var r=(this.unsigned?t["div_u"]:t["div_s"])(this.low,this.high,e.low,e.high);return fromBits(r,t["get_high"](),this.unsigned)}if(this.isZero())return this.unsigned?f:d;var n,s,a;if(!this.unsigned){if(this.eq(y)){if(e.eq(h)||e.eq(g))return y;else if(e.eq(y))return h;else{var o=this.shr(1);n=o.div(e).shl(1);if(n.eq(d)){return e.isNegative()?h:g}else{s=this.sub(e.mul(n));a=n.add(s.div(e));return a}}}else if(e.eq(y))return this.unsigned?f:d;if(this.isNegative()){if(e.isNegative())return this.neg().div(e.neg());return this.neg().div(e).neg()}else if(e.isNegative())return this.div(e.neg()).neg();a=d}else{if(!e.unsigned)e=e.toUnsigned();if(e.gt(this))return f;if(e.gt(this.shru(1)))return p;a=f}s=this;while(s.gte(e)){n=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));var l=Math.ceil(Math.log(n)/Math.LN2),c=l<=48?1:i(2,l-48),u=fromNumber(n),m=u.mul(e);while(m.isNegative()||m.gt(s)){n-=c;u=fromNumber(n,this.unsigned);m=u.mul(e)}if(u.isZero())u=h;a=a.add(u);s=s.sub(m)}return a};b.div=b.divide;b.modulo=function modulo(e){if(!isLong(e))e=fromValue(e);if(t){var r=(this.unsigned?t["rem_u"]:t["rem_s"])(this.low,this.high,e.low,e.high);return fromBits(r,t["get_high"](),this.unsigned)}return this.sub(this.div(e).mul(e))};b.mod=b.modulo;b.rem=b.modulo;b.not=function not(){return fromBits(~this.low,~this.high,this.unsigned)};b.countLeadingZeros=function countLeadingZeros(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};b.clz=b.countLeadingZeros;b.countTrailingZeros=function countTrailingZeros(){return this.low?ctz32(this.low):ctz32(this.high)+32};b.ctz=b.countTrailingZeros;b.and=function and(e){if(!isLong(e))e=fromValue(e);return fromBits(this.low&e.low,this.high&e.high,this.unsigned)};b.or=function or(e){if(!isLong(e))e=fromValue(e);return fromBits(this.low|e.low,this.high|e.high,this.unsigned)};b.xor=function xor(e){if(!isLong(e))e=fromValue(e);return fromBits(this.low^e.low,this.high^e.high,this.unsigned)};b.shiftLeft=function shiftLeft(e){if(isLong(e))e=e.toInt();if((e&=63)===0)return this;else if(e<32)return fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned);else return fromBits(0,this.low<<e-32,this.unsigned)};b.shl=b.shiftLeft;b.shiftRight=function shiftRight(e){if(isLong(e))e=e.toInt();if((e&=63)===0)return this;else if(e<32)return fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned);else return fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};b.shr=b.shiftRight;b.shiftRightUnsigned=function shiftRightUnsigned(e){if(isLong(e))e=e.toInt();if((e&=63)===0)return this;if(e<32)return fromBits(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned);if(e===32)return fromBits(this.high,0,this.unsigned);return fromBits(this.high>>>e-32,0,this.unsigned)};b.shru=b.shiftRightUnsigned;b.shr_u=b.shiftRightUnsigned;b.rotateLeft=function rotateLeft(e){var t;if(isLong(e))e=e.toInt();if((e&=63)===0)return this;if(e===32)return fromBits(this.high,this.low,this.unsigned);if(e<32){t=32-e;return fromBits(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)}e-=32;t=32-e;return fromBits(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned)};b.rotl=b.rotateLeft;b.rotateRight=function rotateRight(e){var t;if(isLong(e))e=e.toInt();if((e&=63)===0)return this;if(e===32)return fromBits(this.high,this.low,this.unsigned);if(e<32){t=32-e;return fromBits(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)}e-=32;t=32-e;return fromBits(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned)};b.rotr=b.rotateRight;b.toSigned=function toSigned(){if(!this.unsigned)return this;return fromBits(this.low,this.high,false)};b.toUnsigned=function toUnsigned(){if(this.unsigned)return this;return fromBits(this.low,this.high,true)};b.toBytes=function toBytes(e){return e?this.toBytesLE():this.toBytesBE()};b.toBytesLE=function toBytesLE(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};b.toBytesBE=function toBytesBE(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Long.fromBytes=function fromBytes(e,t,r){return r?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)};Long.fromBytesLE=function fromBytesLE(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Long.fromBytesBE=function fromBytesBE(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var S=Long;e.default=S;return"default"in e?e.default:e}({});if(typeof define==="function"&&define.amd)define([],(function(){return t}));else if(true)e.exports=t},6569:e=>{e.exports={i8:"1.10.1"}},4784:e=>{e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},3571:e=>{e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"FileDescriptorSet":{"fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}}},"FileDescriptorProto":{"fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10,"options":{"packed":false}},"weakDependency":{"rule":"repeated","type":"int32","id":11,"options":{"packed":false}},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12}}},"DescriptorProto":{"fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"FieldDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REQUIRED":2,"LABEL_REPEATED":3}}}},"OneofDescriptorProto":{"fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3}}},"EnumValueDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[38,38]],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[8,8]]},"FieldOptions":{"fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}}}},"OneofOptions":{"fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumValueOptions":{"fields":{"deprecated":{"type":"bool","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"UninterpretedOption":{"fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"SourceCodeInfo":{"fields":{"location":{"rule":"repeated","type":"Location","id":1}},"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"span":{"rule":"repeated","type":"int32","id":2},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4}}}}}}}}}}}')},3342:e=>{e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},8783:e=>{e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},2561:e=>{e.exports={version:"3.12.0"}}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var r=__webpack_module_cache__[e]={exports:{}};var n=true;try{__webpack_modules__[e].call(r.exports,r,r.exports,__nccwpck_require__);n=false}finally{if(n)delete __webpack_module_cache__[e]}return r.exports}(()=>{__nccwpck_require__.d=(e,t)=>{for(var r in t){if(__nccwpck_require__.o(t,r)&&!__nccwpck_require__.o(e,r)){Object.defineProperty(e,r,{enumerable:true,get:t[r]})}}}})();(()=>{__nccwpck_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=new URL(".",import.meta.url).pathname.slice(import.meta.url.match(/^file:\/\/\/\w:/)?1:0,-1)+"/";var __webpack_exports__={};(()=>{__nccwpck_require__.d(__webpack_exports__,{zU:()=>HMAC,hi:()=>NewClientInterceptor,To:()=>NewServerInterceptor,CY:()=>initLogger});var e=__nccwpck_require__(4158);const t=10;const wrapAnsi16=(e=0)=>t=>`[${t+e}m`;const wrapAnsi256=(e=0)=>t=>`[${38+e};5;${t}m`;const wrapAnsi16m=(e=0)=>(t,r,n)=>`[${38+e};2;${t};${r};${n}m`;const r={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};const n=Object.keys(r.modifier);const i=Object.keys(r.color);const s=Object.keys(r.bgColor);const a=[...i,...s];function assembleStyles(){const e=new Map;for(const[t,n]of Object.entries(r)){for(const[t,i]of Object.entries(n)){r[t]={open:`[${i[0]}m`,close:`[${i[1]}m`};n[t]=r[t];e.set(i[0],i[1])}Object.defineProperty(r,t,{value:n,enumerable:false})}Object.defineProperty(r,"codes",{value:e,enumerable:false});r.color.close="[39m";r.bgColor.close="[49m";r.color.ansi=wrapAnsi16();r.color.ansi256=wrapAnsi256();r.color.ansi16m=wrapAnsi16m();r.bgColor.ansi=wrapAnsi16(t);r.bgColor.ansi256=wrapAnsi256(t);r.bgColor.ansi16m=wrapAnsi16m(t);Object.defineProperties(r,{rgbToAnsi256:{value(e,t,r){if(e===t&&t===r){if(e<8){return 16}if(e>248){return 231}return Math.round((e-8)/247*24)+232}return 16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5)},enumerable:false},hexToRgb:{value(e){const t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!t){return[0,0,0]}let[r]=t;if(r.length===3){r=[...r].map((e=>e+e)).join("")}const n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,n&255]},enumerable:false},hexToAnsi256:{value:e=>r.rgbToAnsi256(...r.hexToRgb(e)),enumerable:false},ansi256ToAnsi:{value(e){if(e<8){return 30+e}if(e<16){return 90+(e-8)}let t;let r;let n;if(e>=232){t=((e-232)*10+8)/255;r=t;n=t}else{e-=16;const i=e%36;t=Math.floor(e/36)/5;r=Math.floor(i/6)/5;n=i%6/5}const i=Math.max(t,r,n)*2;if(i===0){return 30}let s=30+(Math.round(n)<<2|Math.round(r)<<1|Math.round(t));if(i===2){s+=60}return s},enumerable:false},rgbToAnsi:{value:(e,t,n)=>r.ansi256ToAnsi(r.rgbToAnsi256(e,t,n)),enumerable:false},hexToAnsi:{value:e=>r.ansi256ToAnsi(r.hexToAnsi256(e)),enumerable:false}});return r}const o=assembleStyles();const l=o;const c=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:process");const u=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:os");const d=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:tty");function hasFlag(e,t=(globalThis.Deno?globalThis.Deno.args:c.argv)){const r=e.startsWith("-")?"":e.length===1?"-":"--";const n=t.indexOf(r+e);const i=t.indexOf("--");return n!==-1&&(i===-1||n<i)}const{env:f}=c;let h;if(hasFlag("no-color")||hasFlag("no-colors")||hasFlag("color=false")||hasFlag("color=never")){h=0}else if(hasFlag("color")||hasFlag("colors")||hasFlag("color=true")||hasFlag("color=always")){h=1}function envForceColor(){if("FORCE_COLOR"in f){if(f.FORCE_COLOR==="true"){return 1}if(f.FORCE_COLOR==="false"){return 0}return f.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(f.FORCE_COLOR,10),3)}}function translateLevel(e){if(e===0){return false}return{level:e,hasBasic:true,has256:e>=2,has16m:e>=3}}function _supportsColor(e,{streamIsTTY:t,sniffFlags:r=true}={}){const n=envForceColor();if(n!==undefined){h=n}const i=r?h:n;if(i===0){return 0}if(r){if(hasFlag("color=16m")||hasFlag("color=full")||hasFlag("color=truecolor")){return 3}if(hasFlag("color=256")){return 2}}if("TF_BUILD"in f&&"AGENT_NAME"in f){return 1}if(e&&!t&&i===undefined){return 0}const s=i||0;if(f.TERM==="dumb"){return s}if(c.platform==="win32"){const e=u.release().split(".");if(Number(e[0])>=10&&Number(e[2])>=10586){return Number(e[2])>=14931?3:2}return 1}if("CI"in f){if("GITHUB_ACTIONS"in f||"GITEA_ACTIONS"in f){return 3}if(["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some((e=>e in f))||f.CI_NAME==="codeship"){return 1}return s}if("TEAMCITY_VERSION"in f){return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(f.TEAMCITY_VERSION)?1:0}if(f.COLORTERM==="truecolor"){return 3}if(f.TERM==="xterm-kitty"){return 3}if("TERM_PROGRAM"in f){const e=Number.parseInt((f.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(f.TERM_PROGRAM){case"iTerm.app":{return e>=3?3:2}case"Apple_Terminal":{return 2}}}if(/-256(color)?$/i.test(f.TERM)){return 2}if(/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(f.TERM)){return 1}if("COLORTERM"in f){return 1}return s}function createSupportsColor(e,t={}){const r=_supportsColor(e,{streamIsTTY:e&&e.isTTY,...t});return translateLevel(r)}const p={stdout:createSupportsColor({isTTY:d.isatty(1)}),stderr:createSupportsColor({isTTY:d.isatty(2)})};const g=p;function stringReplaceAll(e,t,r){let n=e.indexOf(t);if(n===-1){return e}const i=t.length;let s=0;let a="";do{a+=e.slice(s,n)+t+r;s=n+i;n=e.indexOf(t,s)}while(n!==-1);a+=e.slice(s);return a}function stringEncaseCRLFWithFirstIndex(e,t,r,n){let i=0;let s="";do{const a=e[n-1]==="\r";s+=e.slice(i,a?n-1:n)+t+(a?"\r\n":"\n")+r;i=n+1;n=e.indexOf("\n",i)}while(n!==-1);s+=e.slice(i);return s}const{stdout:m,stderr:v}=g;const y=Symbol("GENERATOR");const b=Symbol("STYLER");const S=Symbol("IS_EMPTY");const _=["ansi","ansi","ansi256","ansi16m"];const w=Object.create(null);const applyOptions=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3)){throw new Error("The `level` option should be an integer from 0 to 3")}const r=m?m.level:0;e.level=t.level===undefined?r:t.level};class Chalk{constructor(e){return chalkFactory(e)}}const chalkFactory=e=>{const chalk=(...e)=>e.join(" ");applyOptions(chalk,e);Object.setPrototypeOf(chalk,createChalk.prototype);return chalk};function createChalk(e){return chalkFactory(e)}Object.setPrototypeOf(createChalk.prototype,Function.prototype);for(const[e,t]of Object.entries(l)){w[e]={get(){const r=createBuilder(this,createStyler(t.open,t.close,this[b]),this[S]);Object.defineProperty(this,e,{value:r});return r}}}w.visible={get(){const e=createBuilder(this,this[b],true);Object.defineProperty(this,"visible",{value:e});return e}};const getModelAnsi=(e,t,r,...n)=>{if(e==="rgb"){if(t==="ansi16m"){return l[r].ansi16m(...n)}if(t==="ansi256"){return l[r].ansi256(l.rgbToAnsi256(...n))}return l[r].ansi(l.rgbToAnsi(...n))}if(e==="hex"){return getModelAnsi("rgb",t,r,...l.hexToRgb(...n))}return l[r][e](...n)};const C=["rgb","hex","ansi256"];for(const e of C){w[e]={get(){const{level:t}=this;return function(...r){const n=createStyler(getModelAnsi(e,_[t],"color",...r),l.color.close,this[b]);return createBuilder(this,n,this[S])}}};const t="bg"+e[0].toUpperCase()+e.slice(1);w[t]={get(){const{level:t}=this;return function(...r){const n=createStyler(getModelAnsi(e,_[t],"bgColor",...r),l.bgColor.close,this[b]);return createBuilder(this,n,this[S])}}}}const E=Object.defineProperties((()=>{}),{...w,level:{enumerable:true,get(){return this[y].level},set(e){this[y].level=e}}});const createStyler=(e,t,r)=>{let n;let i;if(r===undefined){n=e;i=t}else{n=r.openAll+e;i=t+r.closeAll}return{open:e,close:t,openAll:n,closeAll:i,parent:r}};const createBuilder=(e,t,r)=>{const builder=(...e)=>applyStyle(builder,e.length===1?""+e[0]:e.join(" "));Object.setPrototypeOf(builder,E);builder[y]=e;builder[b]=t;builder[S]=r;return builder};const applyStyle=(e,t)=>{if(e.level<=0||!t){return e[S]?"":t}let r=e[b];if(r===undefined){return t}const{openAll:n,closeAll:i}=r;if(t.includes("")){while(r!==undefined){t=stringReplaceAll(t,r.close,r.open);r=r.parent}}const s=t.indexOf("\n");if(s!==-1){t=stringEncaseCRLFWithFirstIndex(t,i,n,s)}return n+t+i};Object.defineProperties(createChalk.prototype,w);const T=createChalk();const R=createChalk({level:v?v.level:0});const k=T;const customSimpleFormat=t=>e.format.printf((({level:e,label:r,timestamp:n,message:i})=>{const s=formatLevel(e);return`${t(`[${r}]`,k.green)} ${n} ${t(s,getLevelColor(e))} ${i}`}));const formatLevel=e=>{switch(e){case"info":return"INF";case"warn":return"WRN";case"error":return"ERR";case"debug":return"DEBUG";default:return e.toUpperCase()}};const getLevelColor=e=>{switch(e){case"info":return k.green;case"warn":return k.yellow;case"error":return k.red;case"debug":return k.blue;default:return k.white}};const O=process.env.LOG_LEVEL||"info";const initLogger=()=>{const colorizeText=(e,t)=>t(e);return(0,e.createLogger)({format:e.format.combine(e.format.timestamp({format:"YYYY-MM-DD HH:mm:ss"}),e.format.label({label:"ts-grpc-hmac"}),customSimpleFormat(colorizeText)),transports:[new e.transports.Console({level:O})]})};var M=__nccwpck_require__(7025);var x=__nccwpck_require__(4300);const A=__WEBPACK_EXTERNAL_createRequire(import.meta.url)("crypto");const P=(new M.yi).withCode(M.i7.UNAUTHENTICATED).withDetails("Invalid x-hmac-key-id").build();const N=(new M.yi).withCode(M.i7.UNAUTHENTICATED).withDetails("Mismatched x-hmac-signature").build();const I=(new M.yi).withCode(M.i7.UNAUTHENTICATED).withDetails("Missing x-hmac-signature").build();const D=(new M.yi).withCode(M.i7.UNAUTHENTICATED).withDetails("Missing metadata").build();const L=(new M.yi).withCode(M.i7.INTERNAL).withDetails("Internal error").build();const j=(new M.yi).withCode(M.i7.UNAUTHENTICATED).withDetails("Invalid metadata").build();const B=(new M.yi).withCode(M.i7.UNAUTHENTICATED).withDetails("Unauthenticated").build();const isEmptyObject=e=>Object.keys(e).length===0&&e.constructor===Object;const F=initLogger();class HMAC{constructor(){}buildMessage=(e,t)=>{const r="method=";const n="request=";if(!e){console.warn("No request provided, using only method name as message");return[r+t,undefined]}let i;if(typeof e==="string"){i=e}else if(typeof e==="object"){const replacer=(e,t)=>{if(typeof t==="string"&&t==="")return undefined;return t};i=isEmptyObject(e)?"":JSON.stringify(e,replacer,0)}else{return["",new Error("Invalid request type")]}if(i.length===0){console.warn("Empty request, using only method name as message");return[r+t,undefined]}const s=`${n}${i};${r}${t}`;return[s,undefined]};generateSignature=(e,t)=>{F.debug(`generating signature for message: ${t}`);const r=(0,A.createHmac)("sha512-256",e);r.update(t);const n=r.digest("base64");F.debug(`signature generated: ${n}`);return[n,undefined]};verifySignature=e=>(t,r,n)=>{try{F.debug(`verifying signature for message: ${t}`);const i=e(r);F.debug("secret: ",i);if(i===undefined){F.error("error: invalid key id");return new Error(`${P.code}:  ${P.details}`)}const[s,a]=this.generateSignature(i,t);if(a){F.error(`error: failed to generate signature: ${a}`);return new Error(`${L.code}: ${a.message}`)}if(!(0,A.timingSafeEqual)(x.Buffer.from(n),x.Buffer.from(s))){F.error("error: signature verification failed");return new Error(`${N.code}: ${N.details}`)}return undefined}catch(e){F.error("error: unexpected error occurred during signature verification: ",e);return new Error(`${L.code} :  ${e}`)}}}const U=initLogger();class ClientInterceptorImpl{hmacKeyId;hmacSecret;protoStaticGeneration;hmac;constructor(e,t,r){this.hmacKeyId=e;this.hmacSecret=t;this.protoStaticGeneration=r;this.hmac=new HMAC}Interceptor(e,t){let r;let n;let i;const s=(new M.u8).withStart(((e,t,s)=>{r=e;n=t;i=s})).withSendMessage(((t,s)=>{let a=t;if(this.protoStaticGeneration){a=t.toObject()}const[o,l]=this.hmac.buildMessage(a,e.method_definition.path);if(l){U.error(`Failed to encode request: ${l}`);return}const[c,u]=this.hmac.generateSignature(this.hmacSecret,o);if(u){U.error(`Failed to generate signature: ${u}`);return}r=r??new M.SF;r.set("x-hmac-key-id",this.hmacKeyId);r.set("x-hmac-signature",c);i(r,n);s(t)})).withHalfClose((e=>{e()})).withCancel((e=>{U.error(`Cancelled message: ${e}`)})).build();return new M.fl(t(e),s)}WithInterceptor(){return(e,t)=>this.Interceptor(e,t)}}const NewClientInterceptor=(e,t,r)=>new ClientInterceptorImpl(e,t,r);const z=initLogger();class ServerInterceptorImpl{auth;hmac;constructor(e){this.hmac=new HMAC;this.auth=this.hmac.verifySignature(e)}ServerInterceptor(e,t){let r;return new M.wg(t,{start:n=>{const i=(new M.e1).withOnReceiveMetadata(((e,n)=>{if(!e.get("x-hmac-key-id")){z.error("No HMAC key ID provided");t.sendStatus({code:M.i7.UNAUTHENTICATED,details:"No HMAC key ID provided"})}else if(!e.get("x-hmac-signature")){z.error("No HMAC signature provided");t.sendStatus({code:M.i7.UNAUTHENTICATED,details:"No HMAC signature provided"})}else{r=e;n(e)}})).withOnReceiveMessage(((n,i)=>{typeof n==="string"?z.debug(`Received message: ${n}`):n instanceof Buffer?z.debug(`Received message: ${n.toString()}`):typeof n==="object"?z.debug(`Received message: ${JSON.stringify(n)}`):typeof n==="number"?z.debug(`Received message: ${n}`):null;const[s,a]=this.hmac.buildMessage(n,e.path);if(a){z.error(`Failed to encode request:  ${a}`);t.sendStatus({code:M.i7.UNAUTHENTICATED,details:a.message})}const o=this.auth(s,r.get("x-hmac-key-id").toString(),r.get("x-hmac-signature").toString());if(o){z.error(`Authentication failed on unary method: ${e.path} with error ${o.name}`);t.sendStatus({code:M.i7.UNAUTHENTICATED,details:o.message})}i(n)})).withOnReceiveHalfClose((e=>{e()})).withOnCancel((()=>{})).build();n(i)},sendMessage:(e,t)=>{typeof e==="string"?z.debug(`Server Sending message: ${e}`):e instanceof Buffer?z.debug(`Server Sending message: ${e.toString()}`):typeof e==="object"?z.debug(`Server Sending message: ${JSON.stringify(e)}`):typeof e==="number"?z.debug(`Server Sending message: ${e}`):null;t(e)}})}WithInterceptor(){return(e,t)=>this.ServerInterceptor(e,t)}}const NewServerInterceptor=e=>new ServerInterceptorImpl(e)})();var __webpack_exports__HMAC=__webpack_exports__.zU;var __webpack_exports__NewClientInterceptor=__webpack_exports__.hi;var __webpack_exports__NewServerInterceptor=__webpack_exports__.To;var __webpack_exports__initLogger=__webpack_exports__.CY;export{__webpack_exports__HMAC as HMAC,__webpack_exports__NewClientInterceptor as NewClientInterceptor,__webpack_exports__NewServerInterceptor as NewServerInterceptor,__webpack_exports__initLogger as initLogger};
//# sourceMappingURL=index.js.map